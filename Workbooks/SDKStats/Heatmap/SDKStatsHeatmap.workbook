{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "ParameterCollectionItem/1.0",
        "parameters": [
          {
            "id": "4f40cabd-848b-41c7-b4a7-2ac7e64764be",
            "version": "ParameterItem/1.0",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ]
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters - 1"
    },
    {
      "type": 1,
      "content": {
        "json": "## SDK Stats - Heatmap Analysis\n---\nThis workbook provides heatmap visualizations to analyze success and failure patterns across different instrumentation keys (iKey) and SDK versions. The heatmaps help identify correlations between specific applications/services and SDK versions, making it easier to spot problematic configurations or version-specific issues.\n\n### Key Visualizations:\n- **Success/Failure by iKey and SDK Version**: Shows patterns across different applications and SDK versions\n- **Success Rate Heatmaps**: Visualizes success rates to quickly identify problem areas\n- **Volume Analysis**: Compares telemetry volumes across different dimensions\n"
      },
      "name": "text - 2"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let success_data = customMetrics\n| where name == \"preview.item.success.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_success = sum(todouble(value)) by ikey, sdk_version;\nlet dropped_data = customMetrics\n| where name == \"preview.item.dropped.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_dropped = sum(todouble(value)) by ikey, sdk_version;\nsuccess_data\n| join kind=fullouter dropped_data on ikey, sdk_version\n| extend \n    ikey = coalesce(ikey, ikey1),\n    sdk_version = coalesce(sdk_version, sdk_version1),\n    total_success = coalesce(total_success, 0.0),\n    total_dropped = coalesce(total_dropped, 0.0)\n| extend \n    total_items = total_success + total_dropped,\n    success_rate = round(total_success * 100.0 / (total_success + total_dropped), 2)\n| project ikey, sdk_version, success_rate",
        "size": 0,
        "title": "Success Rate Data by iKey and SDK Version",
        "noDataMessage": "No data available for the selected time range",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "success_rate",
              "formatter": 8,
              "formatOptions": {
                "palette": "greenRed"
              }
            }
          ]
        },
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "Success Rate Heatmap"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customMetrics\n| where name == \"preview.item.success.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_success = sum(value) by ikey, sdk_version\n| project ikey, sdk_version, total_success",
        "size": 0,
        "title": "Success Count by iKey and SDK Version",
        "noDataMessage": "No data available for the selected time range",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "total_success",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            }
          ]
        },
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "Success Count Heatmap"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customMetrics\n| where name == \"preview.item.dropped.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_dropped = sum(value) by ikey, sdk_version\n| project ikey, sdk_version, total_dropped",
        "size": 0,
        "title": "Dropped Count by iKey and SDK Version",
        "noDataMessage": "No data available for the selected time range",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "total_dropped",
              "formatter": 8,
              "formatOptions": {
                "palette": "redBright"
              }
            }
          ]
        },
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "Dropped Count Heatmap"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let success_data = customMetrics\n| where name == \"preview.item.success.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_success = sum(todouble(value)) by ikey, sdk_version;\nlet dropped_data = customMetrics\n| where name == \"preview.item.dropped.count\"\n| extend \n    ikey = tostring(customDimensions[\"iKey\"]),\n    sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(ikey) and isnotempty(sdk_version)\n| summarize total_dropped = sum(todouble(value)) by ikey, sdk_version;\nsuccess_data\n| join kind=fullouter dropped_data on ikey, sdk_version\n| extend \n    ikey = coalesce(ikey, ikey1),\n    sdk_version = coalesce(sdk_version, sdk_version1),\n    total_success = coalesce(total_success, 0.0),\n    total_dropped = coalesce(total_dropped, 0.0)\n| extend \n    total_items = total_success + total_dropped,\n    success_rate = round(total_success * 100.0 / (total_success + total_dropped), 2)\n| project \n    [\"iKey\"] = ikey,\n    [\"SDK Version\"] = sdk_version,\n    [\"Total Success\"] = tolong(total_success),\n    [\"Total Dropped\"] = tolong(total_dropped),\n    [\"Total Items\"] = tolong(total_items),\n    [\"Success Rate %\"] = success_rate\n| order by [\"Total Items\"] desc",
        "size": 1,
        "title": "Detailed Statistics by iKey and SDK Version",
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "Detailed Statistics Table"
    },
    {
      "type": 1,
      "content": {
        "json": "## SDK Version Analysis\n---\nThe following charts focus specifically on SDK version performance to help identify version-specific issues.\n"
      },
      "name": "text - 3"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let success_data = customMetrics\n| where name == \"preview.item.success.count\"\n| extend sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(sdk_version)\n| summarize total_success = sum(todouble(value)) by sdk_version;\nlet dropped_data = customMetrics\n| where name == \"preview.item.dropped.count\"\n| extend sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(sdk_version)\n| summarize total_dropped = sum(todouble(value)) by sdk_version;\nsuccess_data\n| join kind=fullouter dropped_data on sdk_version\n| extend \n    sdk_version = coalesce(sdk_version, sdk_version1),\n    total_success = coalesce(total_success, 0.0),\n    total_dropped = coalesce(total_dropped, 0.0)\n| extend \n    total_items = total_success + total_dropped,\n    success_rate = round(total_success * 100.0 / (total_success + total_dropped), 2)\n| project \n    [\"SDK Version\"] = sdk_version,\n    [\"Total Success\"] = tolong(total_success),\n    [\"Total Dropped\"] = tolong(total_dropped),\n    [\"Total Items\"] = tolong(total_items),\n    [\"Success Rate %\"] = success_rate\n| order by [\"Total Items\"] desc",
        "size": 1,
        "title": "SDK Version Performance Summary",
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "SDK Version Summary"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let success_data = customMetrics\n| where name == \"preview.item.success.count\"\n| extend sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(sdk_version)\n| summarize total_success = sum(todouble(value)) by sdk_version;\nlet dropped_data = customMetrics\n| where name == \"preview.item.dropped.count\"\n| extend sdk_version = tostring(customDimensions[\"sdkVersion\"])\n| where isnotempty(sdk_version)\n| summarize total_dropped = sum(todouble(value)) by sdk_version;\nsuccess_data\n| join kind=fullouter dropped_data on sdk_version\n| extend \n    sdk_version = coalesce(sdk_version, sdk_version1),\n    total_success = coalesce(total_success, 0.0),\n    total_dropped = coalesce(total_dropped, 0.0)\n| extend success_rate = round(total_success * 100.0 / (total_success + total_dropped), 2)\n| project sdk_version, success_rate\n| render barchart",
        "size": 1,
        "title": "Success Rate by SDK Version",
        "timeContext": {
          "durationMs": 0,
          "createdTime": "2025-07-30T00:00:00.000Z"
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "SDK Version Success Rate Chart"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}

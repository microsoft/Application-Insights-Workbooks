{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "9ed19a65-bb31-40ce-a574-8473d4e9d915",
            "version": "KqlParameterItem/1.0",
            "name": "Amw",
            "label": "Azure Monitor workspace",
            "type": 5,
            "isRequired": true,
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false,
              "componentIdOnly": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "6e226d7e-f69e-406b-b8e8-6a3220e4d543",
            "version": "KqlParameterItem/1.0",
            "name": "Location",
            "type": 1,
            "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{Amw}?api-version=2023-04-03\",\"urlParams\":[],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.location\",\"columns\":[]}}]}",
            "isHiddenWhenLocked": true,
            "queryType": 12
          }
        ],
        "style": "pills",
        "queryType": 12
      },
      "name": "paramsGlobal"
    },
    {
      "type": 10,
      "content": {
        "chartId": "cc49faa9-12d3-4410-8a28-aa4a6d01bfe2",
        "version": "MetricsItem/2.0",
        "size": 4,
        "chartType": -1,
        "resourceType": "microsoft.monitor/accounts",
        "metricScope": 0,
        "resourceParameter": "Amw",
        "resourceIds": [
          "{Amw}"
        ],
        "timeContext": {
          "durationMs": 3600000
        },
        "metrics": [
          {
            "namespace": "microsoft.monitor/accounts",
            "metric": "microsoft.monitor/accounts--ActiveTimeSeriesLimit",
            "aggregation": 3
          }
        ],
        "gridFormatType": 1,
        "tileSettings": {
          "titleContent": {
            "formatter": 5,
            "formatOptions": {
              "linkTarget": "Resource"
            }
          },
          "leftContent": {
            "columnMatch": "Metric",
            "formatter": 1
          },
          "rightContent": {
            "columnMatch": "Value",
            "formatter": 3,
            "formatOptions": {
              "palette": "blueDark"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "style": "decimal",
                "minimumSignificantDigits": 3
              }
            }
          },
          "showBorder": false,
          "size": "full"
        },
        "gridSettings": {
          "rowLimit": 10000
        }
      },
      "customWidth": "50",
      "name": "limitsAndUsageTimeSeriesLimit",
      "styleSettings": {
        "margin": "0 0 -90px 0"
      }
    },
    {
      "type": 10,
      "content": {
        "chartId": "cc49faa9-12d3-4410-8a28-aa4a6d01bfe2",
        "version": "MetricsItem/2.0",
        "size": 4,
        "chartType": -1,
        "resourceType": "microsoft.monitor/accounts",
        "metricScope": 0,
        "resourceParameter": "Amw",
        "resourceIds": [
          "{Amw}"
        ],
        "timeContext": {
          "durationMs": 3600000
        },
        "metrics": [
          {
            "namespace": "microsoft.monitor/accounts",
            "metric": "microsoft.monitor/accounts--ActiveTimeSeriesPercentUtilization",
            "aggregation": 4
          }
        ],
        "title": "Timeseries Utilization",
        "gridFormatType": 1,
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Name",
            "formatter": 13,
            "formatOptions": {
              "linkTarget": "Resource",
              "showIcon": true
            }
          },
          "leftContent": {
            "columnMatch": "Value",
            "formatter": 12,
            "formatOptions": {
              "min": 0,
              "max": 100,
              "palette": "greenRed"
            },
            "numberFormat": {
              "unit": 1,
              "options": {
                "style": "decimal",
                "maximumFractionDigits": 2,
                "maximumSignificantDigits": 3
              }
            }
          },
          "secondaryContent": {
            "columnMatch": "Metric"
          },
          "showBorder": false,
          "size": "full"
        },
        "gridSettings": {
          "rowLimit": 10000
        }
      },
      "customWidth": "50",
      "name": "limitsAndUsageTimeSeriesPercent"
    },
    {
      "type": 10,
      "content": {
        "chartId": "cc49faa9-12d3-4410-8a28-aa4a6d01bfe2",
        "version": "MetricsItem/2.0",
        "size": 4,
        "chartType": -1,
        "resourceType": "microsoft.monitor/accounts",
        "metricScope": 0,
        "resourceParameter": "Amw",
        "resourceIds": [
          "{Amw}"
        ],
        "timeContext": {
          "durationMs": 3600000
        },
        "metrics": [
          {
            "namespace": "microsoft.monitor/accounts",
            "metric": "microsoft.monitor/accounts--EventsPerMinuteIngestedLimit",
            "aggregation": 3
          }
        ],
        "gridFormatType": 1,
        "tileSettings": {
          "titleContent": {
            "formatter": 5,
            "formatOptions": {
              "linkTarget": "Resource"
            }
          },
          "leftContent": {
            "columnMatch": "Metric",
            "formatter": 1
          },
          "rightContent": {
            "columnMatch": "Value",
            "formatter": 3,
            "formatOptions": {
              "palette": "blueDark"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "style": "decimal",
                "minimumSignificantDigits": 3
              }
            }
          },
          "showBorder": false,
          "size": "full"
        },
        "gridSettings": {
          "rowLimit": 10000
        }
      },
      "customWidth": "50",
      "name": "limitsAndUsageEventssLimit",
      "styleSettings": {
        "margin": "0 0 -90px 0"
      }
    },
    {
      "type": 10,
      "content": {
        "chartId": "cc49faa9-12d3-4410-8a28-aa4a6d01bfe2",
        "version": "MetricsItem/2.0",
        "size": 4,
        "chartType": -1,
        "resourceType": "microsoft.monitor/accounts",
        "metricScope": 0,
        "resourceParameter": "Amw",
        "resourceIds": [
          "{Amw}"
        ],
        "timeContext": {
          "durationMs": 3600000
        },
        "metrics": [
          {
            "namespace": "microsoft.monitor/accounts",
            "metric": "microsoft.monitor/accounts--EventsPerMinuteIngestedPercentUtilization",
            "aggregation": 4
          }
        ],
        "title": "Event Utilization",
        "gridFormatType": 1,
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Name",
            "formatter": 13,
            "formatOptions": {
              "linkTarget": "Resource",
              "showIcon": true
            }
          },
          "leftContent": {
            "columnMatch": "Value",
            "formatter": 12,
            "formatOptions": {
              "min": 0,
              "max": 100,
              "palette": "greenRed"
            },
            "numberFormat": {
              "unit": 1,
              "options": {
                "style": "decimal",
                "maximumFractionDigits": 2,
                "maximumSignificantDigits": 3
              }
            }
          },
          "secondaryContent": {
            "columnMatch": "Metric"
          },
          "showBorder": false,
          "size": "full"
        },
        "gridSettings": {
          "rowLimit": 10000
        }
      },
      "customWidth": "50",
      "name": "limitsAndUsageEventPercent"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "0afd17b9-2e2c-405f-90cd-bea85310ad96",
            "version": "KqlParameterItem/1.0",
            "name": "Desired_Active_Time_Series_Limit",
            "label": " Desired Active Time Series Limit",
            "type": 1,
            "typeSettings": {
              "paramValidationRules": [
                {
                  "regExp": "^\\d*$",
                  "match": true,
                  "message": "Must be a number"
                }
              ]
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": "40"
          },
          {
            "id": "33e9efbf-c919-4d4b-9d36-2bf877932fc7",
            "version": "KqlParameterItem/1.0",
            "name": "Desired_Events_Per_Minute_Limit",
            "label": "Desired Events Per Minute Limit",
            "type": 1,
            "typeSettings": {
              "paramValidationRules": [
                {
                  "regExp": "^\\d*$",
                  "match": true,
                  "message": "Must be a number"
                }
              ]
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": "4"
          },
          {
            "id": "e7869f04-a7b9-4d98-8337-871f75035761",
            "version": "KqlParameterItem/1.0",
            "name": "Desired_Active_Time_Series_Limit_test",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Desired_Active_Time_Series_Limit",
                  "operator": "regex",
                  "rightValType": "static",
                  "rightVal": "^\\d*$",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "12854ccc-f8ef-42e2-beaf-fd8e4c91b7b4",
            "version": "KqlParameterItem/1.0",
            "name": "Desired_Events_Per_Minute_Limit_test",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Desired_Events_Per_Minute_Limit",
                  "operator": "regex",
                  "rightValType": "static",
                  "rightVal": "^\\d*$",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "704c98a3-214d-4782-8524-0b0b82052a95",
            "version": "KqlParameterItem/1.0",
            "name": "Configure_Button_test",
            "type": 1,
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "paramValidationRules": [
                {
                  "regExp": "^0$",
                  "match": true,
                  "message": ""
                }
              ]
            },
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Desired_Active_Time_Series_Limit",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "expression",
                  "resultVal": "{Desired_Active_Time_Series_Limit_test} + {Desired_Events_Per_Minute_Limit_test}"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "expression",
                  "resultVal": "{Desired_Active_Time_Series_Limit_test} + {Desired_Events_Per_Minute_Limit_test}"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "formVertical",
        "queryType": 0,
        "resourceType": "microsoft.monitor/accounts"
      },
      "customWidth": "50",
      "name": "parameters - 8"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "list",
        "links": [
          {
            "id": "3e85bc17-eb19-4454-b0aa-a3f8f21de995",
            "cellValue": "{Configure_Button_test}",
            "linkTarget": "ArmAction",
            "linkLabel": "Configure",
            "style": "primary",
            "linkIsContextBlade": true,
            "armActionContext": {
              "path": "{Amw}/metricsContainers/default?api-version=2025-05-03-preview",
              "headers": [],
              "params": [
                {
                  "key": "",
                  "value": ""
                },
                {
                  "key": "",
                  "value": ""
                }
              ],
              "body": "{\r\n  \"location\": \"{Location}\",\r\n  \"properties\": {\r\n    \"limits\": {\r\n      \"maxActiveTimeSeries\": \"{Desired_Active_Time_Series_Limit}\",\r\n      \"maxEventsPerMinute\": \"{Desired_Events_Per_Minute_Limit}\"\r\n    }\r\n  }\r\n}",
              "httpMethod": "PUT",
              "title": "Update Ingestion Limit",
              "description": "### Are you sure you want to update your ingestion limit(s) for this resource?\r\n\r\n#### If you proceed your new limits will be:\r\n#### Desired Active Time Series Limit: {Desired_Active_Time_Series_Limit}\r\n\r\n#### Desired Events Per Minute Limit:    {Desired_Events_Per_Minute_Limit}\r\n\r\n\r\n\r\n",
              "actionName": "Update Ingestion Limit",
              "runLabel": "Update"
            }
          }
        ]
      },
      "name": "links - 4"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "list",
        "links": [
          {
            "id": "427f49af-cb80-424e-8f6a-aa229b4a30e4",
            "cellValue": "https://learn.microsoft.com/en-us/azure/azure-monitor/fundamentals/service-limits#ingestion",
            "linkTarget": "Url",
            "linkLabel": "Learn More",
            "style": "link"
          }
        ]
      },
      "name": "links - 7"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "nav",
        "links": []
      },
      "name": "links - 11"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "",
        "size": 0,
        "queryType": 12
      },
      "name": "query - 10"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}

{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# Service Retirement Workbook V2"
      },
      "name": "Summary Header1",
      "styleSettings": {
        "margin": "0",
        "padding": "0"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "This workbook displays Azure services that are being phased out, allowing you to mitigate affected resources. Currently, the ‚ÄúImpacted Services‚Äù view in this workbook contains information for a subset of services and features that are in the retirement lifecycle. If this page is helpful to you or if you have feedback on how we can improve it, [**please submit feedback here**](https://aka.ms/srwb-survey). \r\n\r\nAs we consistently update the 'Impacted Services' view with additional services and their impact analysis, you can access a comprehensive list of all retiring Azure services and features by navigating to the 'All Services' view. Furthermore, for a detailed overview of the lifecycle status of all Azure products and services, please visit [Azure updates](https://azure.microsoft.com/updates). \r\n\r\n<span style=\"color:maroon\"> **Required Action:** </span> To avoid service disruptions, please review and migrate the affected resources before the retirement date, following the recommendations outlined in the respective documents. \r\n\r\nThe <span style=\"color:maroon\"> red color </span> line next to the retirement date in the table below indicates that these services retired earlier or will retire in 2026."
      },
      "customWidth": "68",
      "name": "Summary Header2",
      "styleSettings": {
        "margin": "0",
        "padding": "0"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "#### Update on retirement of TLS 1.0 and TLS 1.1 versions for Azure Services \r\nFollowing the announcement on November 10, 2023, we are continuing our transition to requiring TLS 1.2 or later for all connections to Azure services. To minimize disruption to customer workloads, several services will continue supporting TLS 1.0 and TLS 1.1 versions and complete their transitions by August 31, 2025 when TLS 1.2 or later will be required for all connections to Azure services (unless explicitly indicated in service documentation). [The list of remaining services](https://go.microsoft.com/fwlink/?linkid=2294901) will be updated as transitions to TLS 1.2 or later complete.\r\n",
        "style": "warning"
      },
      "customWidth": "32",
      "name": "Summary Header3",
      "styleSettings": {
        "margin": "0",
        "padding": "0"
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "a552f987-89d3-472d-b67b-47625c6ca9ba",
            "version": "KqlParameterItem/1.0",
            "name": "FullList",
            "label": "Choose view",
            "type": 10,
            "description": "\"All services\" selection will show the list of all Azure Services which are in retirement lifecycle even if none of your resources are affected",
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[{\"value\": \"Yes\", \"label\": \"Impacted Services\" , \"selected\":true},{\"value\":\"Yes-AllServices\",\"label\":\"All Services\"}, {\"value\":\"Yes-RetiredServices\",\"label\":\"Retired Services\"}]",
            "timeContext": {
              "durationMs": 86400000
            },
            "value": "Yes-RetiredServices"
          }
        ],
        "style": "formHorizontal",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "ParameterSelection"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "16030a75-1de4-4dad-bfad-0cb49f81690c",
            "version": "KqlParameterItem/1.0",
            "name": "SubscriptionId",
            "label": "Subscription",
            "type": 6,
            "isRequired": true,
            "isGlobal": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": false,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "d3cb53ad-aabe-43cc-9019-f317ece41ea5",
            "version": "KqlParameterItem/1.0",
            "name": "ResourceGroup",
            "label": "Resource group",
            "type": 2,
            "description": "A resource group is a collection of resources that share the same lifecycle, permissions, and policies",
            "isGlobal": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| distinct resourceGroup",
            "crossComponentResources": [
              "{SubscriptionId}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "fd8fc823-879f-4647-b9ea-23e37fe830c7",
            "version": "KqlParameterItem/1.0",
            "name": "Region",
            "label": "Location",
            "type": 8,
            "description": "A geographic location where resources are located",
            "isGlobal": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": true,
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "defaultValue": "value::all",
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "ParameterDeclaration"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "value::all"
        ],
        "parameters": [
          {
            "id": "2b11a607-8152-4aac-b8dd-188484ae4a21",
            "version": "KqlParameterItem/1.0",
            "name": "BaseQuery",
            "label": "Base KQL Query",
            "type": 1,
            "typeSettings": {
              "multiLineText": true,
              "editorLanguage": "text"
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": "advisorresources | where properties.extendedProperties.recommendationSubCategory == \"ServiceUpgradeAndRetirement\" | where tostring(properties.category) has \"HighAvailability\" | extend resourceId = tostring(properties.resourceMetadata.resourceId) | project id, subscriptionId, resourceGroup, location, resourceId, ServiceID = tostring(properties.recommendationTypeId)"
          },
          {
            "id": "c89660f8-8df2-40b3-a5f9-bee018650ffd",
            "version": "KqlParameterItem/1.0",
            "name": "CurrentDate",
            "type": 1,
            "query": "resources\r\n| extend formattedDate = format_datetime(now(), \"yyyy-MM-dd\")\r\n| take 1\r\n| project formattedDate",
            "crossComponentResources": [
              "value::all"
            ],
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          }
        ],
        "style": "above",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "conditionalVisibility": {
        "parameterName": "1",
        "comparison": "isEqualTo",
        "value": "0"
      },
      "name": "ParameterDeclaration - BaseQuery"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"ARMEndpoint/1.0\",\"headers\":[],\"method\":\"GET\",\"path\":\"providers/Microsoft.Advisor/metadata?api-version=2025-01-01&%24filter=recommendationCategory%20eq%20'HighAvailability'%20and%20recommendationSubCategory%20eq%20'ServiceUpgradeAndRetirement'%20and%20retirementDate%20ge%20'2024-01-01'&%24expand=ibiza\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[0].properties.supportedValues[*]\",\"columns\":[{\"path\":\"id\",\"columnid\":\"Id\"},{\"path\":\"resourceMetadata.singular\",\"columnid\":\"ServiceName\"},{\"path\":\"sourceProperties.serviceRetirement.retirementFeatureName\",\"columnid\":\"RetiringFeature\"},{\"path\":\"sourceProperties.serviceRetirement.retirementDate\",\"columnid\":\"RetirementDate\"},{\"path\":\"learnMoreLink\",\"columnid\":\"Link\"}]}}]}",
        "size": 1,
        "queryType": 12,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "RetirementDate",
              "formatter": 6,
              "formatOptions": {
                "customColumnWidthSetting": "20ch"
              },
              "dateFormat": {
                "showUtcTime": true,
                "formatName": "shortDatePattern"
              }
            }
          ],
          "sortBy": [
            {
              "itemKey": "ServiceName",
              "sortOrder": 2
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "ServiceName",
            "sortOrder": 2
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "showtable",
        "comparison": "isEqualTo",
        "value": "show"
      },
      "name": "MasterData"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{BaseQuery}\r\n| where ('*' in (dynamic([{ResourceGroup}])) or resourceGroup in (dynamic([{ResourceGroup}]))) \r\n| where ('*' in (dynamic([{Region}])) or location in (dynamic([{Region}])))\r\n| summarize ResourceCount=count() by ServiceID \r\n",
        "size": 4,
        "exportFieldName": "Name",
        "exportParameterName": "ResourceInSelectedService",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources",
        "crossComponentResources": [
          "{SubscriptionId}"
        ],
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "RetirementAnnouncementDetails",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Click here"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Click here"
              }
            }
          ]
        },
        "sortBy": []
      },
      "conditionalVisibility": {
        "parameterName": "ShowData",
        "comparison": "isEqualTo",
        "value": "Show"
      },
      "customWidth": "100",
      "name": "ResourceCount"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\",\"mergeType\":\"innerunique\",\"leftTable\":\"MasterData\",\"rightTable\":\"ResourceCount\",\"leftColumn\":\"Id\",\"rightColumn\":\"ServiceID\"}],\"projectRename\":[{\"originalName\":\"[MasterData].HasSourceQuery\",\"mergedName\":\"HasSourceQuery\",\"fromId\":\"unknown\"},{\"originalName\":\"[MasterData].IngestionType\",\"mergedName\":\"IngestionType\",\"fromId\":\"unknown\"},{\"originalName\":\"[MasterData].Id\",\"mergedName\":\"Id\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[MasterData].ServiceName\",\"mergedName\":\"ServiceName\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[MasterData].RetiringFeature\",\"mergedName\":\"RetiringFeature\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[MasterData].RetirementDate\",\"mergedName\":\"RetirementDate\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[MasterData].Link\",\"mergedName\":\"Link\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[ResourceCount].ServiceID\",\"mergedName\":\"ServiceID\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[ResourceCount].ResourceCount\",\"mergedName\":\"ResourceCount\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb070\"},{\"originalName\":\"[MasterData].Id\"},{\"originalName\":\"[MasterData].NoSourceQuery\"}]}",
        "size": 0,
        "title": "Retiring Azure services (üí°Please note: This view only provides impact analysis for a subset of services at the moment where atleast one resource is getting impacted)",
        "noDataMessage": "This workbook has not identified any resources affected by an upcoming service retirement",
        "showRefreshButton": true,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "ServiceID",
            "parameterName": "SelectedServiceId",
            "parameterType": 1,
            "quote": ""
          }
        ],
        "showExportToExcel": true,
        "queryType": 7,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Id",
              "formatter": 5
            },
            {
              "columnMatch": "ServiceName",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "25%"
              }
            },
            {
              "columnMatch": "RetiringFeature",
              "formatter": 1,
              "formatOptions": {
                "linkColumn": "Link",
                "linkTarget": "Url",
                "customColumnWidthSetting": "25.9375%"
              }
            },
            {
              "columnMatch": "RetirementDate",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "contains",
                    "thresholdValue": "2024",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2026",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2025",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "Blank",
                    "text": "{0}{1}"
                  }
                ],
                "customColumnWidthSetting": "19ch"
              },
              "dateFormat": {
                "showUtcTime": true,
                "formatName": "shortDatePattern"
              }
            },
            {
              "columnMatch": "ResourceCount",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "0",
                    "representation": "success",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "<",
                    "thresholdValue": "100",
                    "representation": "Sev2",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": ">=",
                    "thresholdValue": "100",
                    "representation": "Sev1",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "Blank",
                    "text": "{0}{1}"
                  }
                ],
                "customColumnWidthSetting": "17ch"
              },
              "numberFormat": {
                "unit": 0,
                "options": {
                  "style": "decimal"
                },
                "emptyValCustomText": "None"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Learn more",
                "customColumnWidthSetting": "11.3857ch"
              }
            },
            {
              "columnMatch": "recommendationTypeId",
              "formatter": 5
            },
            {
              "columnMatch": "ServiceID",
              "formatter": 5
            },
            {
              "columnMatch": "Category",
              "formatter": 5
            }
          ],
          "filter": true,
          "sortBy": [
            {
              "itemKey": "$gen_thresholds_ResourceCount_6",
              "sortOrder": 1
            }
          ],
          "labelSettings": [
            {
              "columnId": "ServiceName",
              "label": "Service Name"
            },
            {
              "columnId": "RetiringFeature",
              "label": "Retiring Feature"
            },
            {
              "columnId": "RetirementDate",
              "label": "Retirement Date"
            },
            {
              "columnId": "Link",
              "label": "Actions"
            },
            {
              "columnId": "ResourceCount",
              "label": "# Resources"
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "$gen_thresholds_ResourceCount_6",
            "sortOrder": 1
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "Summary view with left join"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{BaseQuery} | join kind=inner ( resources | project resourceId=id, rgLocation=location, type, tags ) on resourceId | join kind=leftouter ( resourcecontainers | where type=~\"microsoft.resources/subscriptions\" | extend subscriptionName=name, subscriptionIdOnly=subscriptionId | project subscriptionName, subscriptionIdOnly ) on $left.subscriptionId == $right.subscriptionIdOnly | extend location = coalesce(rgLocation, location) | where ('*' in (dynamic([{ResourceGroup}])) or resourceGroup in (dynamic([{ResourceGroup}]))) | where ('*' in (dynamic([{Region}])) or location in (dynamic([{Region}]))) | where isempty('{SelectedServiceId}') or ServiceID in (split(trim(' ', '{SelectedServiceId}'), ',')) | project-away resourceId1, id",
        "size": 4,
        "title": "This is just a data Set used for detailed section below. ",
        "noDataMessage": "This workbook has not identified any resources affected by an upcoming service retirement",
        "showExportToExcel": true,
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources",
        "crossComponentResources": [
          "{SubscriptionId}"
        ],
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "subscriptionName",
              "formatter": 5
            },
            {
              "columnMatch": "subscriptionId1",
              "formatter": 1
            }
          ]
        },
        "sortBy": []
      },
      "conditionalVisibility": {
        "parameterName": "showtable",
        "comparison": "isEqualTo",
        "value": "show"
      },
      "name": "DetailedData"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\",\"mergeType\":\"innerunique\",\"leftTable\":\"MasterData\",\"rightTable\":\"DetailedData\",\"leftColumn\":\"Id\",\"rightColumn\":\"ServiceID\"}],\"projectRename\":[{\"originalName\":\"[DetailedData].subscriptionId\",\"mergedName\":\"subscriptionId\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].type\",\"mergedName\":\"type\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[MasterData].RetiringFeature\",\"mergedName\":\"RetiringFeature\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[MasterData].RetirementDate\",\"mergedName\":\"RetirementDate\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].resourceGroup\",\"mergedName\":\"resourceGroup\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].location\",\"mergedName\":\"location\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].resourceId\",\"mergedName\":\"resourceId\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].tags\",\"mergedName\":\"tags\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[MasterData].Link\",\"mergedName\":\"Link\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].subscriptionIdOnly\",\"mergedName\":\"subscriptionIdOnly\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[MasterData].Action\",\"mergedName\":\"Action\",\"fromId\":\"unknown\"},{\"originalName\":\"[MasterData].ServiceName\",\"mergedName\":\"ServiceName\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[DetailedData].subscriptionName\",\"mergedName\":\"subscriptionName\",\"fromId\":\"bf7c6a6c-53d3-4e81-b9bd-1416839eb07d\"},{\"originalName\":\"[MasterData].NoSourceQuery\",\"mergedName\":\"NoSourceQuery\",\"fromId\":\"unknown\"},{\"originalName\":\"[MasterData].HasSourceQuery\",\"mergedName\":\"HasSourceQuery\",\"fromId\":\"unknown\"},{\"originalName\":\"[MasterData].Id\"},{\"originalName\":\"[DetailedData].id\"},{\"originalName\":\"[DetailedData].ServiceID\"},{\"originalName\":\"[DetailedData].rgLocation\"}]}",
        "size": 0,
        "title": "Based on the above table, this list shows your resources affected by the selected service retirement(s).",
        "noDataMessage": "This workbook has not identified any resources affected by an upcoming service retirement",
        "showRefreshButton": true,
        "showExportToExcel": true,
        "exportToExcelOptions": "all",
        "queryType": 7,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "subscriptionId",
              "formatter": 15,
              "formatOptions": {
                "linkTarget": null,
                "showIcon": true,
                "customColumnWidthSetting": "40ch"
              }
            },
            {
              "columnMatch": "type",
              "formatter": 16,
              "formatOptions": {
                "showIcon": true,
                "customColumnWidthSetting": "37ch"
              }
            },
            {
              "columnMatch": "RetiringFeature",
              "formatter": 1,
              "formatOptions": {
                "linkColumn": "Link",
                "linkTarget": "Url",
                "customColumnWidthSetting": "35ch"
              }
            },
            {
              "columnMatch": "RetirementDate",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "20ch"
              }
            },
            {
              "columnMatch": "resourceGroup",
              "formatter": 14,
              "formatOptions": {
                "linkTarget": null,
                "showIcon": true,
                "customColumnWidthSetting": "32ch"
              }
            },
            {
              "columnMatch": "location",
              "formatter": 17,
              "formatOptions": {
                "customColumnWidthSetting": "16ch"
              }
            },
            {
              "columnMatch": "resourceId",
              "formatter": 13,
              "formatOptions": {
                "linkColumn": "resourceId",
                "linkTarget": "Resource",
                "linkIsContextBlade": true,
                "showIcon": true,
                "customColumnWidthSetting": "30ch"
              }
            },
            {
              "columnMatch": "tags",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "10%"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Learn more",
                "customColumnWidthSetting": "1%"
              }
            },
            {
              "columnMatch": "subscriptionIdOnly",
              "formatter": 1,
              "formatOptions": {
                "customColumnWidthSetting": "20%"
              }
            },
            {
              "columnMatch": "ServiceName",
              "formatter": 5,
              "formatOptions": {
                "customColumnWidthSetting": "1%"
              }
            },
            {
              "columnMatch": "recommendationTypeId",
              "formatter": 5
            },
            {
              "columnMatch": "subscriptionName",
              "formatter": 5
            }
          ],
          "filter": true,
          "labelSettings": [
            {
              "columnId": "subscriptionId",
              "label": "Subscription"
            },
            {
              "columnId": "type",
              "label": "Type"
            },
            {
              "columnId": "RetiringFeature",
              "label": "Retiring Feature"
            },
            {
              "columnId": "RetirementDate",
              "label": "Retirement Date"
            },
            {
              "columnId": "resourceGroup",
              "label": "Resource Group"
            },
            {
              "columnId": "location",
              "label": "Location"
            },
            {
              "columnId": "resourceId",
              "label": "Resource Name"
            },
            {
              "columnId": "tags",
              "label": "Tags"
            },
            {
              "columnId": "Link",
              "label": "Action"
            },
            {
              "columnId": "subscriptionIdOnly",
              "label": "Subscription Id"
            },
            {
              "columnId": "subscriptionName",
              "label": "Subscription Name"
            }
          ]
        },
        "sortBy": []
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "FinalDetailedData"
    },
    {
      "type": 1,
      "content": {
        "json": "#### This view presents a comprehensive list of all Azure services and features that are retiring\r\n"
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes-AllServices"
      },
      "name": "text - 12"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"ARMEndpoint/1.0\",\"headers\":[],\"method\":\"GET\",\"path\":\"providers/Microsoft.Advisor/metadata?api-version=2025-01-01\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"recommendationCategory eq 'HighAvailability' and recommendationSubCategory eq 'ServiceUpgradeAndRetirement' and retirementDate ge '{CurrentDate}'\"},{\"key\":\"$expand\",\"value\":\"ibiza\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[0].properties.supportedValues[*]\",\"columns\":[{\"path\":\"id\",\"columnid\":\"Id\"},{\"path\":\"resourceMetadata.singular\",\"columnid\":\"ServiceName\"},{\"path\":\"sourceProperties.serviceRetirement.retirementFeatureName\",\"columnid\":\"RetiringFeature\"},{\"path\":\"sourceProperties.serviceRetirement.retirementDate\",\"columnid\":\"RetirementDate\"},{\"path\":\"learnMoreLink\",\"columnid\":\"Link\"},{\"path\":\"properties[?(@.name == 'recommendationIngestionType')].value\",\"columnid\":\"IngestionType\",\"columnType\":\"string\"}]}}]}",
        "size": 2,
        "showRefreshButton": true,
        "showExportToExcel": true,
        "queryType": 12,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Id",
              "formatter": 5
            },
            {
              "columnMatch": "ServiceName",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "25%"
              }
            },
            {
              "columnMatch": "RetiringFeature",
              "formatter": 1,
              "formatOptions": {
                "linkColumn": "Link",
                "linkTarget": "Url",
                "customColumnWidthSetting": "23%"
              }
            },
            {
              "columnMatch": "RetirementDate",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "contains",
                    "thresholdValue": "2023",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2024",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2025",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "Blank",
                    "text": "{0}{1}"
                  }
                ],
                "customColumnWidthSetting": "19ch"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Learn more",
                "customColumnWidthSetting": "12ch"
              }
            },
            {
              "columnMatch": "ResourceImpact",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "colors",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "Automated",
                    "representation": null
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "Manual",
                    "representation": null
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": null,
                    "text": "{0}"
                  }
                ],
                "customColumnWidthSetting": "20%"
              }
            }
          ],
          "rowLimit": 500,
          "sortBy": [
            {
              "itemKey": "ServiceName",
              "sortOrder": 1
            }
          ],
          "labelSettings": [
            {
              "columnId": "ServiceName",
              "label": "Service Name"
            },
            {
              "columnId": "RetiringFeature",
              "label": "Retiring Feature"
            },
            {
              "columnId": "RetirementDate",
              "label": "Retirement Date"
            },
            {
              "columnId": "Link",
              "label": "Actions"
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "ServiceName",
            "sortOrder": 1
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "1",
        "comparison": "isEqualTo",
        "value": "0"
      },
      "showPin": true,
      "name": "Unfiltered Data"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[{\\\"ingestiontype\\\":\\\"Automated\\\",\\\"mapping\\\":\\\"Yes\\\"},\\r\\n{\\\"ingestiontype\\\":\\\"Manual\\\",\\\"mapping\\\":\\\"No\\\"}]\",\"transformers\":null}",
        "size": 0,
        "queryType": 8
      },
      "conditionalVisibility": {
        "parameterName": "1",
        "comparison": "isEqualTo",
        "value": "0"
      },
      "name": "Mapped Ingestion Type"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\",\"mergeType\":\"leftouter\",\"leftTable\":\"Unfiltered Data\",\"rightTable\":\"Mapped Ingestion Type\",\"leftColumn\":\"IngestionType\",\"rightColumn\":\"ingestiontype\"}],\"projectRename\":[{\"originalName\":\"[Unfiltered Data].Id\",\"mergedName\":\"Id\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[Unfiltered Data].ServiceName\",\"mergedName\":\"ServiceName\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[Unfiltered Data].RetiringFeature\",\"mergedName\":\"RetiringFeature\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[Unfiltered Data].RetirementDate\",\"mergedName\":\"RetirementDate\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[Unfiltered Data].Link\",\"mergedName\":\"Link\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[Mapped Ingestion Type].mapping\",\"mergedName\":\"Availability under Impacted Services\",\"fromId\":\"0f11e9dc-c721-4ed4-977c-fd285d6a0067\"},{\"originalName\":\"[query - 14].value\"},{\"originalName\":\"[Mapped Ingestion Type].ingestiontype\"},{\"originalName\":\"[Unfiltered Data].IngestionType\"}]}",
        "size": 2,
        "title": "Retiring Azure services (üí°Please note: This view does not include resource-level impact analysis)",
        "showRefreshButton": true,
        "showExportToExcel": true,
        "queryType": 7,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Id",
              "formatter": 5
            },
            {
              "columnMatch": "ServiceName",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "25%"
              }
            },
            {
              "columnMatch": "RetiringFeature",
              "formatter": 1,
              "formatOptions": {
                "linkColumn": "Link",
                "linkTarget": "Url",
                "customColumnWidthSetting": "23%"
              }
            },
            {
              "columnMatch": "RetirementDate",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "contains",
                    "thresholdValue": "2024",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2025",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "2026",
                    "representation": "Sev0",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "Blank",
                    "text": "{0}{1}"
                  }
                ],
                "customColumnWidthSetting": "19ch"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Learn more",
                "customColumnWidthSetting": "12ch"
              }
            },
            {
              "columnMatch": "Availability under Impacted Services",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "20%"
              }
            }
          ],
          "rowLimit": 500,
          "filter": true,
          "sortBy": [
            {
              "itemKey": "Availability under Impacted Services",
              "sortOrder": 2
            }
          ],
          "labelSettings": [
            {
              "columnId": "ServiceName",
              "label": "Service Name"
            },
            {
              "columnId": "RetiringFeature",
              "label": "Retiring Feature"
            },
            {
              "columnId": "RetirementDate",
              "label": "Retirement Date"
            },
            {
              "columnId": "Link",
              "label": "Actions"
            },
            {
              "columnId": "Availability under Impacted Services",
              "label": "Is Available under the Impacted Services?"
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "Availability under Impacted Services",
            "sortOrder": 2
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes-AllServices"
      },
      "showPin": true,
      "name": "All Services Data"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"ARMEndpoint/1.0\",\"headers\":[],\"method\":\"GET\",\"path\":\"providers/Microsoft.Advisor/metadata?api-version=2025-01-01\",\"urlParams\":[{\"key\":\"$filter\",\"value\":\"recommendationCategory eq 'HighAvailability' and recommendationSubCategory eq 'ServiceUpgradeAndRetirement' and retirementDate le '{CurrentDate}'\"},{\"key\":\"$expand\",\"value\":\"ibiza\"}],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value[0].properties.supportedValues[*]\",\"columns\":[{\"path\":\"resourceMetadata.singular\",\"columnid\":\"ServiceName\"},{\"path\":\"sourceProperties.serviceRetirement.retirementFeatureName\",\"columnid\":\"RetiringFeature\"},{\"path\":\"sourceProperties.serviceRetirement.retirementDate\",\"columnid\":\"RetirementDate\"},{\"path\":\"learnMoreLink\",\"columnid\":\"Link\"}]}}]}",
        "size": 2,
        "title": "This view presents a comprehensive list of all Azure services and features that are already retired",
        "showRefreshButton": true,
        "showExportToExcel": true,
        "queryType": 12,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ServiceName",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "25%"
              }
            },
            {
              "columnMatch": "RetiringFeature",
              "formatter": 1,
              "formatOptions": {
                "linkColumn": "Link",
                "linkTarget": "Url",
                "customColumnWidthSetting": "35%"
              }
            },
            {
              "columnMatch": "RetirementDate",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "Blank",
                    "text": "{0}{1}"
                  }
                ],
                "customColumnWidthSetting": "10%"
              }
            },
            {
              "columnMatch": "Link",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url",
                "linkLabel": "Learn more",
                "customColumnWidthSetting": "10%"
              }
            },
            {
              "columnMatch": "ResourceImpact",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "colors",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "Automated",
                    "representation": null
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "Manual",
                    "representation": null
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": null,
                    "text": "{0}"
                  }
                ],
                "customColumnWidthSetting": "20%"
              }
            },
            {
              "columnMatch": "id",
              "formatter": 5
            }
          ],
          "filter": true,
          "sortBy": [
            {
              "itemKey": "$gen_link_RetiringFeature_1",
              "sortOrder": 1
            }
          ],
          "labelSettings": [
            {
              "columnId": "ServiceName",
              "label": "Service Name"
            },
            {
              "columnId": "RetiringFeature",
              "label": "Retiring Feature"
            },
            {
              "columnId": "RetirementDate",
              "label": "Retirement Date"
            },
            {
              "columnId": "Link",
              "label": "Actions"
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "$gen_link_RetiringFeature_1",
            "sortOrder": 1
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "FullList",
        "comparison": "isEqualTo",
        "value": "Yes-RetiredServices"
      },
      "showPin": true,
      "name": "Retired Unfiltered Data"
    }
  ],
  "fallbackResourceIds": [
    "Azure Advisor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
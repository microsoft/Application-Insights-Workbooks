{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Create a new task"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "Schedule automated emails of Backup Reports data by filling out the below details. [Learn more](https://aka.ms/BackupReportsEmailLink1)"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-InstructionText1"
          },
          {
            "type": 1,
            "content": {
              "json": "_____________"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-DividingLine1"
          },
          {
            "type": 1,
            "content": {
              "json": "### Task details "
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "When you create a new task, a Logic App is created in the subscription, resource group and location selected below.\r\n\r\nThe Logic App generates periodic emails based on the Log Analytics workspace(s) and report filters selected in the Backup Reports Overview tab. [Learn more](https://aka.ms/BackupReportsEmailLink2)"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-InstructionText2"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "c79f7e10-fd45-434c-a5be-f098cfc26c75",
                  "version": "KqlParameterItem/1.0",
                  "name": "TaskName",
                  "label": "Task Name",
                  "type": 1,
                  "description": "Name of the task/logic app to be created",
                  "isRequired": true,
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": ""
                },
                {
                  "id": "ed65c790-f606-470d-9d88-89416821d3c8",
                  "version": "KqlParameterItem/1.0",
                  "name": "LogicAppSubscription",
                  "label": "Subscription",
                  "type": 6,
                  "description": "Subscription in which the logic app should be created",
                  "isRequired": true,
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "includeAll": false,
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "customWidth": "40",
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-ParameterBlock1"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "d7a0b942-cbe9-471e-ad84-928a23d11125",
                  "version": "KqlParameterItem/1.0",
                  "name": "LogicAppResourceGroup",
                  "label": "Resource Group",
                  "type": 2,
                  "description": "Resource Group in which the logic app should be created",
                  "isRequired": true,
                  "query": "resourcecontainers \r\n| where type =~ \"microsoft.resources/subscriptions/resourcegroups\" \r\n| where tolower(subscriptionId)==tolower(\"{LogicAppSubscription:subscriptionId}\")\r\n| project name",
                  "crossComponentResources": [
                    "{LogicAppSubscription}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                },
                {
                  "id": "acd9205d-549d-4771-adbf-1ebe085c9021",
                  "version": "KqlParameterItem/1.0",
                  "name": "LogicAppLocation",
                  "label": "Location",
                  "type": 8,
                  "description": "Location in which the logic app should be created",
                  "isRequired": true,
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "includeAll": true,
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "18ad4cd2-2452-4453-b09f-7d032e8ca3af",
                  "version": "KqlParameterItem/1.0",
                  "name": "LogicAppResourceGroupId",
                  "type": 1,
                  "query": "print LogicAppResourceGroupId=strcat(\"{LogicAppSubscription}\",\"/resourceGroups/\",\"{LogicAppResourceGroup}\")\r\n\r\n",
                  "crossComponentResources": [
                    "{Workspaces}"
                  ],
                  "isHiddenWhenLocked": true,
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "1d8fd4a2-e7aa-47c8-9130-679e90c8f9ad",
                  "version": "KqlParameterItem/1.0",
                  "name": "ExistingTaskCount",
                  "type": 1,
                  "query": "resources \r\n| where type =~ \"microsoft.logic/workflows\" \r\n| project id, name, tags_parsed=parse_json(tags), properties_parsed=parse_json(properties)\r\n| where tags_parsed.UsedByBackupReports==\"true\" \r\n| extend frequency=properties_parsed.definition.triggers.Recurrence.recurrence.frequency\r\n| project id, name, frequency=iff(frequency==\"Day\",\"Daily\",iff(frequency==\"Week\",\"Weekly\",iff(frequency==\"Month\",\"Monthly\",\"N/A\")))\r\n| count\r\n",
                  "crossComponentResources": [
                    "value::selected"
                  ],
                  "isHiddenWhenLocked": true,
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 1,
                  "resourceType": "microsoft.resourcegraph/resources"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.resourcegraph/resources"
            },
            "customWidth": "60",
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "LogicAppSubscription",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-ParameterBlock2"
          },
          {
            "type": 1,
            "content": {
              "json": "Below are the tasks that have already been configured. All Logic Apps which contain the tag 'UsedByBackupReports:true' are displayed in the below list. [Learn more](https://aka.ms/BackupReportsEmailLink3)",
              "style": "info"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ExistingTaskCount",
                "comparison": "isNotEqualTo",
                "value": "0"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-ExistingTasks-InstructionText1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources \r\n| where type =~ \"microsoft.logic/workflows\" \r\n| project id, name, tags_parsed=parse_json(tags), properties_parsed=parse_json(properties)\r\n| where tags_parsed.UsedByBackupReports==\"true\" \r\n| extend frequency=properties_parsed.definition.triggers.Recurrence.recurrence.frequency\r\n| project id, name, frequency=iff(frequency==\"Day\",\"Daily\",iff(frequency==\"Week\",\"Weekly\",iff(frequency==\"Month\",\"Monthly\",\"N/A\")))\r\n",
              "size": 4,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "id",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "name",
                    "formatter": 16,
                    "formatOptions": {
                      "linkColumn": "id",
                      "linkTarget": "Resource",
                      "showIcon": true,
                      "customColumnWidthSetting": "50%"
                    }
                  },
                  {
                    "columnMatch": "frequency",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "50%"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "id"
                  },
                  {
                    "columnId": "name",
                    "label": "Task Name"
                  },
                  {
                    "columnId": "frequency",
                    "label": "Task Frequency"
                  }
                ]
              }
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ExistingTaskCount",
                "comparison": "isNotEqualTo",
                "value": "0"
              }
            ],
            "name": "Email-TaskDetails-ExistingTasks-Grid1",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "_______________________________________"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskDetails-ExistingTasks-DividingLine1"
          },
          {
            "type": 1,
            "content": {
              "json": "### Task execution parameters"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-TaskExecutionParameters-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "#### Scope of task execution"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-ScopeOfTaskExecution-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "Specify the scope for which data will be queried and exported by the task. [Learn more](https://aka.ms/BackupReportsEmailLink4)"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-ScopeOfTaskExecution-InstructionText1"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "b1770ec1-1df5-4519-8a32-df99de039870",
                  "version": "KqlParameterItem/1.0",
                  "name": "DataToExport",
                  "label": "Data To Export",
                  "type": 2,
                  "description": "Use to select the tab to export via email. To configure email for all tabs at once, select 'All Tabs'",
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[{\"label\":\"All Tabs\", \"value\":\"AllTabs\", \"selected\":\"true\"},{\"label\":\"Summary\", \"value\":\"Summary\", \"selected\":\"false\"},{\"label\":\"Backup Instances\", \"value\":\"BackupInstances\", \"selected\":\"false\"},{\"label\":\"Usage\", \"value\":\"Usage\", \"selected\":\"false\"},{\"label\":\"Jobs\", \"value\":\"Jobs\", \"selected\":\"false\"},{\"label\":\"Policies\", \"value\":\"Policies\", \"selected\":\"false\"}, {\"label\":\"Optimize\", \"value\":\"Optimize\", \"selected\":\"false\"},{\"label\":\"Policy Adherence\", \"value\":\"PolicyAdherence\", \"selected\":\"false\"}]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": "Summary"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-ScopeOfTaskExecution-ParameterBlock1"
          },
          {
            "type": 1,
            "content": {
              "json": "#### Email options"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-EmailOptions-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "Summarized charts and detailed CSV files of data are sent by email at the specified frequency to the specified email address. [Learn more](https://aka.ms/backupcenter)"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-EmailOptions-InstructionText2"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "95d1802e-ae2e-4f28-8789-47dfbe11bcee",
                  "version": "KqlParameterItem/1.0",
                  "name": "Frequency",
                  "label": "Email Frequency",
                  "type": 2,
                  "description": "Frequency at whch emails should be received by the recipient(s)",
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[{ \"value\": \"Month\", \"label\": \"Monthly\", \"selected\":true },{ \"value\": \"Week\",           \"label\": \"Weekly\" }, { \"value\": \"Day\", \"label\": \"Daily\" }]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "value": "Day"
                },
                {
                  "id": "40b294bb-a030-40a5-a3d6-fe69c9bcc6b1",
                  "version": "KqlParameterItem/1.0",
                  "name": "EmailId",
                  "label": "Email id",
                  "type": 1,
                  "description": "Email id of the recipient(s). To specify multiple email ids, use a semicolon-separated list",
                  "isRequired": true,
                  "value": ""
                },
                {
                  "id": "8eb39edf-083f-4db7-ab27-62f4f2881cfe",
                  "version": "KqlParameterItem/1.0",
                  "name": "EmailSubject",
                  "label": "Email Subject",
                  "type": 1,
                  "description": "Subject of the email received by the recipient(s)",
                  "isRequired": true,
                  "value": ""
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-EmailOptions-ParameterBlock1"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "b28035af-751c-4fdb-88f8-b3004cfdf36c",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/FullReport.Json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "dailyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_DailyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "weeklyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_WeeklyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "monthlyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_MonthlyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "yearlyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_YearlyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "AllTabs"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button1"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "0e50e7c6-c24b-4e80-b2f9-b3f4c69964ed",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/Optimize.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "dailyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_DailyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "weeklyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_WeeklyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "monthlyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_MonthlyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "yearlyRPRetentionFilter",
                        "source": "parameter",
                        "value": "OptimizeTab_YearlyRPRetention",
                        "kind": "intValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "Optimize"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button2"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "fe11abfd-27de-4a1f-b5b2-9c5cde20794c",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/Policies.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "Policies"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button3"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "8bf1bbaf-1121-4019-b829-cfdfbc9acdc3",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/BackupInstance.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "BackupInstances"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button4"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "2c4738cc-da89-48d6-b64a-cb2d9fac90b8",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/Jobs.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupReportsEmailFeature)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/AzureBackupLogicAppsPricing)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "Jobs"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button5"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "d90bd63c-fa30-4285-b06a-09639956b6a9",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/Usage.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "Usage"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button6"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "43caff71-8f23-463b-8c0a-cbd62c1f1204",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/Summary.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "Summary"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button7"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "7bcc423d-e65e-49ff-918f-bb9f795d2612",
                  "linkTarget": "ArmTemplate",
                  "linkLabel": "Submit",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "templateRunContext": {
                    "componentIdSource": "parameter",
                    "componentId": "LogicAppResourceGroupId",
                    "templateUriSource": "static",
                    "templateUri": "https://raw.githubusercontent.com/VinothJeyaraman55/azure-quickstart-templates/master/BackupReport/PolicyAdherence.json",
                    "templateParameters": [
                      {
                        "name": "logicAppName",
                        "source": "parameter",
                        "value": "TaskName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "logicAppWorkspace",
                        "source": "parameter",
                        "value": "WorkspaceName",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspacesToQuery",
                        "source": "parameter",
                        "value": "Workspaces",
                        "kind": "arrayValue"
                      },
                      {
                        "name": "emailFrequency",
                        "source": "parameter",
                        "value": "Frequency",
                        "kind": "stringValue"
                      },
                      {
                        "name": "recipientEmailId",
                        "source": "parameter",
                        "value": "EmailId",
                        "kind": "stringValue"
                      },
                      {
                        "name": "startDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeStart",
                        "kind": "stringValue"
                      },
                      {
                        "name": "endDate",
                        "source": "parameter",
                        "value": "LogicApp_RangeEnd",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultSubscriptionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultSubscriptionList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultLocationListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultLocationList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "vaultListFilter",
                        "source": "parameter",
                        "value": "LogicApp_VaultList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "backupSolutionListFilter",
                        "source": "parameter",
                        "value": "LogicApp_DatasourceTypeList",
                        "kind": "stringValue"
                      },
                      {
                        "name": "excludeLegacyEvent",
                        "source": "parameter",
                        "value": "LogicApp_ExcludeLegacyEvent",
                        "kind": "boolValue"
                      },
                      {
                        "name": "aggregationType",
                        "source": "parameter",
                        "value": "LogicApp_AggregationType",
                        "kind": "stringValue"
                      },
                      {
                        "name": "location",
                        "source": "parameter",
                        "value": "LogicAppLocation",
                        "kind": "stringValue"
                      },
                      {
                        "name": "emailSubject",
                        "source": "parameter",
                        "value": "EmailSubject",
                        "kind": "stringValue"
                      },
                      {
                        "name": "workspaceResourceGroupId",
                        "source": "parameter",
                        "value": "ResourceGroupId",
                        "kind": "stringValue"
                      }
                    ],
                    "titleSource": "static",
                    "title": "Deploy Logic App template",
                    "descriptionSource": "static",
                    "description": "Clicking the 'Confirm' button below creates a Logic App that sends periodic emails to the specified email address. The Report filters that are currently selected in the report will be applied to the data that is sent over email as well.\r\n\r\nNote that after the Logic App is deployed, you will need to perform an additional authorization step for the configuration to work.\r\n\r\n[Learn more about emailing Backup Reports](https://aka.ms/BackupCenter)\r\n\r\n[Learn more about Logic Apps and their pricing](https://aka.ms/BackupCenter)",
                    "runLabelSource": "static",
                    "runLabel": "Confirm"
                  }
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DataToExport",
                "comparison": "isEqualTo",
                "value": "PolicyAdherence"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Button7 - Copy"
          },
          {
            "type": 1,
            "content": {
              "json": "_______________________________"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-DividingLine2"
          },
          {
            "type": 1,
            "content": {
              "json": "### Authorize Connections"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Authorize-Header1"
          },
          {
            "type": 1,
            "content": {
              "json": "Once email configuration is complete, you need to authorize API connections to Azure Monitor Logs and Office 365.\r\n\r\nThe below grid shows the list of all API connections which contain the tag 'UsedByBackupReports:true'. For all API connections that do not show 'Connected' status, click on the connection name and perform the authorization in the next screen that appears. [Learn more](https://aka.ms/BackupReportsEmailLink5)",
              "style": "info"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Authorize-InstructionText1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources  \r\n| where type==\"microsoft.web/connections\"\r\n| project id, name, tags_parsed=parse_json(tags), properties_parsed=parse_json(properties), subscriptionId, resourceGroup, location\r\n//| where tags_parsed.UsedByBackupReports==\"true\" \r\n| extend status=properties_parsed.statuses[0].status\r\n//| project id, name, frequency=iff(frequency==\"Day\",\"Daily\",iff(frequency==\"Week\",\"Weekly\",iff(frequency==\"Month\",\"Monthly\",\"N/A\")))\r\n",
              "size": 4,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "value::selected"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "id",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "name",
                    "formatter": 16,
                    "formatOptions": {
                      "linkColumn": "id",
                      "linkTarget": "Resource",
                      "subTarget": "edit",
                      "showIcon": true,
                      "customColumnWidthSetting": "20%"
                    }
                  },
                  {
                    "columnMatch": "tags_parsed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "properties_parsed",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "subscriptionId",
                    "formatter": 15,
                    "formatOptions": {
                      "linkTarget": null,
                      "showIcon": true,
                      "customColumnWidthSetting": "20%"
                    }
                  },
                  {
                    "columnMatch": "resourceGroup",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "20%"
                    }
                  },
                  {
                    "columnMatch": "location",
                    "formatter": 17,
                    "formatOptions": {
                      "customColumnWidthSetting": "20%"
                    }
                  },
                  {
                    "columnMatch": "status",
                    "formatter": 1,
                    "formatOptions": {
                      "customColumnWidthSetting": "20%"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "id"
                  },
                  {
                    "columnId": "name",
                    "label": "Connection name"
                  },
                  {
                    "columnId": "tags_parsed"
                  },
                  {
                    "columnId": "properties_parsed"
                  },
                  {
                    "columnId": "subscriptionId",
                    "label": "Subscription"
                  },
                  {
                    "columnId": "resourceGroup",
                    "label": "Resource Group"
                  },
                  {
                    "columnId": "location",
                    "label": "Location"
                  },
                  {
                    "columnId": "status",
                    "label": "Status"
                  }
                ]
              }
            },
            "conditionalVisibilities": [
              {
                "parameterName": "TabName",
                "comparison": "isEqualTo",
                "value": "Email"
              },
              {
                "parameterName": "Workspaces",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "DatasourceType",
                "comparison": "isNotEqualTo"
              },
              {
                "parameterName": "ErrorHandle",
                "comparison": "isNotEqualTo"
              }
            ],
            "name": "Email-Authorize-Grid1",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "name": "group - 0"
    }
  ],
  "fallbackResourceIds": [
    "Azure Monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
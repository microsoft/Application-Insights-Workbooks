{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "67dcb2cb-14b1-4d77-b52b-f728abbf43a2",
            "version": "KqlParameterItem/1.0",
            "name": "mappedTenantId",
            "type": 1,
            "query": "resources\r\n| take 1\r\n| project tenantId",
            "crossComponentResources": [
              "value::tenant"
            ],
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resources/tenants"
          },
          {
            "id": "0a66fd55-a5d0-4153-9615-4dfa1dbf6b87",
            "version": "KqlParameterItem/1.0",
            "name": "savedMapping",
            "type": 1,
            "isRequired": true,
            "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/admin/windows/updates/resourceConnections/\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.id\",\"columnid\":\"id\",\"columnType\":\"string\"},{\"path\":\"$.state\",\"columnid\":\"state\",\"columnType\":\"string\"},{\"path\":\"$.azureSubscriptionId\",\"columnid\":\"azureSubscriptionId\",\"columnType\":\"string\"},{\"path\":\"$.azureResourceGroupName\",\"columnid\":\"azureResourceGroupName\",\"columnType\":\"string\"},{\"path\":\"$.workspaceName\",\"columnid\":\"workspaceName\",\"columnType\":\"string\"}]}}]}",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 14
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "savedMappingSubscriptionId",
            "type": 1,
            "isRequired": true,
            "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/admin/windows/updates/resourceConnections/\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.azureSubscriptionId\",\"columnid\":\"azureSubscriptionId\",\"columnType\":\"string\"}]}}]}",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 14,
            "id": "f5393ae4-0179-40a2-a1e2-47e8bde4eb07"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "savedMappingWorkspaceName",
            "type": 1,
            "isRequired": true,
            "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/admin/windows/updates/resourceConnections/\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.workspaceName\",\"columnid\":\"workspaceName\",\"columnType\":\"string\"}]}}]}",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 14,
            "id": "212eae3e-2a6b-41e9-af99-b6796dfe45c2"
          },
          {
            "id": "7a2bb320-fa9c-45c8-bbf6-942c8b3a4b0e",
            "version": "KqlParameterItem/1.0",
            "name": "mappedSubscription",
            "label": "subscription",
            "type": 6,
            "isRequired": true,
            "query": "{\"version\":\"MsGraphEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/beta/admin/windows/updates/resourceConnections/\",\"urlParams\":[],\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.azureSubscriptionId\",\"columnid\":\"azureSubscriptionid\",\"columnType\":\"string\",\"substringRegexMatch\":\"^\",\"substringReplace\":\"/subscriptions/\"},{\"path\":\"$.azureSubscriptionId\",\"columnid\":\"selected\",\"columnType\":\"string\",\"substringRegexMatch\":\".*\",\"substringReplace\":\"true\"}]}}]}",
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 14,
            "value": null
          },
          {
            "id": "01c6d66e-3f87-4e8a-8be6-0accbe4f4036",
            "version": "KqlParameterItem/1.0",
            "name": "mappedWorkspace",
            "label": "workspace",
            "type": 5,
            "isRequired": true,
            "query": "resources\r\n| where type == \"microsoft.operationalinsights/workspaces\"\r\n| where \"{savedMappingWorkspaceName}\" == name",
            "crossComponentResources": [
              "{mappedSubscription}"
            ],
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1
          },
          {
            "id": "86531822-76f2-4c50-b766-542f46c8c41a",
            "version": "KqlParameterItem/1.0",
            "name": "isOnboarded",
            "type": 1,
            "query": "UCClient\r\n| summarize number = count()\r\n| project iff(number > 0, \"true\", \"false\")",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": null
          },
          {
            "id": "2776722c-672e-4a35-9c4b-3d8e74c1083f",
            "version": "KqlParameterItem/1.0",
            "name": "_SnapshotTime",
            "label": "Time range",
            "type": 1,
            "description": "Time indicating the latest snapshot",
            "query": "UCClient\r\n| where TimeGenerated >= ago(7d)\r\n| summarize max(TimeGenerated)\r\n",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "isHiddenWhenLocked": true,
            "defaultValue": "value::1",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": null
          },
          {
            "id": "4f746974-5b8c-4f59-9277-4240b8aaf1b5",
            "version": "KqlParameterItem/1.0",
            "name": "currentWorkbook",
            "type": 1,
            "isGlobal": true,
            "value": "Overview",
            "isHiddenWhenLocked": true
          },
          {
            "id": "4f6976fa-2240-4f36-87f3-15fc46334eaa",
            "version": "KqlParameterItem/1.0",
            "name": "DOSnapshotTime",
            "label": "SnapshotTime for Delivery Optimization",
            "type": 1,
            "query": "UCDOStatus\r\n| where TimeGenerated >= ago(7d)\r\n| summarize max(TimeGenerated)",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 14
      },
      "conditionalVisibility": {
        "parameterName": "NonExistentParam",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "parameters - 2"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "8b7a4ae6-50b7-441b-9e89-9c39a3ef43a1",
            "version": "KqlParameterItem/1.0",
            "name": "_TimePicked",
            "type": 1,
            "description": "Convert snapshot time in readable time",
            "isRequired": true,
            "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nprint TimePicked = format_datetime(_SnapshotTime, 'M/dd/yyyy')",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": null
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "_SecurityDate",
            "type": 1,
            "description": "Convert snapshot time in readable time",
            "isRequired": true,
            "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and UpdateClassification == \"Security\"\r\n| summarize arg_max(UpdateReleaseTime, *) by TimeGenerated\r\n| extend releaseTime =  format_datetime(UpdateReleaseTime, 'M/dd/yyyy')\r\n| summarize by releaseTime\r\n\r\n\r\n",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "id": "48539502-e298-4f38-9147-4206ecc9266f",
            "value": null
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "_FeatureWin10Version",
            "type": 1,
            "description": "Convert snapshot time in readable time",
            "isRequired": true,
            "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsFeatureUpdate\" and UpdateClassification == \"Upgrade\" and TargetVersion has \"Windows 10\" and isnotempty(UpdateReleaseTime)\r\n| summarize by TargetVersion\r\n| take 1\r\n",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "id": "793eb704-9554-46a0-9129-d517f18b9f5a",
            "value": null
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "_FeatureWin11Version",
            "type": 1,
            "description": "Convert snapshot time in readable time",
            "isRequired": true,
            "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsFeatureUpdate\" and UpdateClassification == \"Upgrade\" and TargetVersion has \"Windows 11\" and isnotempty(UpdateReleaseTime)\r\n| summarize by TargetVersion\r\n| take 1\r\n",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "id": "32751a78-a03f-4eb2-b3ba-6eeac17e3133",
            "value": null
          },
          {
            "id": "0c772731-1707-4ca6-badd-53c79b9dd7f4",
            "version": "KqlParameterItem/1.0",
            "name": "_KBArticleLink",
            "type": 1,
            "description": "Convert snapshot time in readable time",
            "isRequired": true,
            "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nlet KBLink = \"https://support.microsoft.com/help/\";\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and UpdateClassification == \"Security\"\r\n| extend KBNumberLink = substring(TargetKBNumber, 2,8)\r\n| sort by toint(KBNumberLink) desc\r\n| project-keep KBNumberLink\r\n| extend KBLinkText = iff(isnotempty(KBNumberLink), strcat(KBLink, KBNumberLink), \"\")\r\n| summarize arg_max(KBNumberLink, *)\r\n| take 1\r\n| summarize by KBLinkText",
            "crossComponentResources": [
              "{mappedWorkspace}"
            ],
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": null
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "TimeRange",
        "comparison": "isNotEqualTo"
      },
      "name": "parameters - 4"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<img src=\"https://admin.microsoft.com/images/EmptyState/EmptyState_illustration_admin-action_group-of-cards-with-pencil_200px.png\"\nstyle=\"display: block;width:350px;margin-left:auto;margin-right:auto;\">\n</img>\n<br></br>\n\n<h2 markdown=\"1\" style=\"display:block;text-align:center;margin-left:auto;margin-right:auto;\">\nMonitor updates across your Windows devices \n</h2>\n\n<p markdown=\"1\" style=\"display:block;width:45%;text-align:center;margin-left:auto;margin-right:auto;\">\nTrack the progress of your update deployments and report on devices with compliance issues. \n\n<br></br>\n<a href=\"https://docs.microsoft.com/en-us/windows/deployment/update/update-compliance-v2-overview\" target='_blank'>Learn more about Windows Update for Business reports</a> and make sure you <a href=\"https://docs.microsoft.com/en-us/windows/deployment/update/update-compliance-v2-prerequisites\" target='_blank'>meet the prerequisites.</a>\n</p>"
            },
            "name": "OnboardingDescription",
            "styleSettings": {
              "margin": "0",
              "padding": "50"
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": []
            },
            "name": "group - 1"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "d61c87c7-cf34-4c03-86e6-00fbe65cb373",
                  "linkTarget": "WorkbookTemplate",
                  "linkLabel": "Get started",
                  "style": "primary",
                  "linkIsContextBlade": true,
                  "workbookContext": {
                    "componentIdSource": "workbook",
                    "resourceIdsSource": "workbook",
                    "templateIdSource": "static",
                    "templateId": "community-workbooks/UpdateCompliance/Windows Update for Business reports enrollment",
                    "typeSource": "workbook",
                    "gallerySource": "workbook",
                    "locationSource": "default",
                    "passSpecificParams": true,
                    "templateParameters": [
                      {
                        "name": "SavedMapping",
                        "source": "parameter",
                        "value": "savedMapping"
                      }
                    ]
                  }
                }
              ]
            },
            "name": "links - 4"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibility": {
        "parameterName": "mappedWorkspace",
        "comparison": "isEqualTo"
      },
      "customWidth": "100",
      "name": "PreonboardingGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "**Tenant ID**: {mappedTenantId} &nbsp;&nbsp; **Subscription**: {mappedSubscription:name} &nbsp;&nbsp; **Workspace**: {savedMappingWorkspaceName}"
            },
            "customWidth": "60",
            "name": "text - 6"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "6b7dda39-6e2e-4f50-a2ed-b55355839eb0",
                  "linkTarget": "WorkbookTemplate",
                  "linkLabel": "Change the subscription or workspace",
                  "style": "link",
                  "linkIsContextBlade": true,
                  "workbookContext": {
                    "componentIdSource": "workbook",
                    "resourceIdsSource": "workbook",
                    "templateIdSource": "static",
                    "templateId": "community-workbooks/UpdateCompliance/Windows Update for Business reports enrollment",
                    "typeSource": "workbook",
                    "gallerySource": "workbook",
                    "locationSource": "default",
                    "passSpecificParams": true,
                    "templateParameters": [
                      {
                        "name": "SavedMapping",
                        "source": "parameter",
                        "value": "savedMapping"
                      }
                    ]
                  }
                }
              ]
            },
            "customWidth": "35",
            "name": "links - 7"
          },
          {
            "type": 1,
            "content": {
              "json": "<br></br><br></br>"
            },
            "name": "text - 3"
          },
          {
            "type": 1,
            "content": {
              "json": "<img src=\"https://res-1.cdn.office.net/admincenter/admin-main/2022.6.30.4/45d61a60d22c9f6dfce067f9991d8c0b.svg\"\nstyle=\"display: block;width:30%;margin-left:auto;margin-right:auto;\">\n</img>\n<br></br>\n\n<h2 markdown=\"1\" style=\"display:block;text-align:center;margin-left:auto;margin-right:auto;\">\nWaiting for Windows Update for Business reports data\n</h2>\n\n<p markdown=\"1\" style=\"display:block;width:45%;text-align:center;margin-left:auto;margin-right:auto;\">\nOnce you have met all the requirements, we will process your data as a first-time setup. This will typically take up to 24 hours. Check back soon!\n</p>"
            },
            "name": "OnboardingDescription",
            "styleSettings": {
              "margin": "0",
              "padding": "50"
            }
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "mappedWorkspace",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "isOnboarded",
          "comparison": "isNotEqualTo",
          "value": "true"
        }
      ],
      "customWidth": "100",
      "name": "PostonboardingGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Windows Update for Business reports\r\n\r\nUse Windows Update for Business reports to check the progress of Windows update deployments and report on devices with compliance issues. This data is updated every 24 hours. *** Last updated: {_TimePicked} ***\r\n\r\n\r\n"
            },
            "name": "WelcomeMessage"
          },
          {
            "type": 1,
            "content": {
              "json": "**Tenant ID**: {mappedTenantId} &nbsp;&nbsp; **Subscription**: {mappedSubscription:name} &nbsp;&nbsp; **Workspace**: {savedMappingWorkspaceName}"
            },
            "customWidth": "60",
            "name": "text - 6"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "paragraph",
              "links": [
                {
                  "id": "6b7dda39-6e2e-4f50-a2ed-b55355839eb0",
                  "linkTarget": "WorkbookTemplate",
                  "linkLabel": "Change the subscription or workspace",
                  "style": "link",
                  "linkIsContextBlade": true,
                  "workbookContext": {
                    "componentIdSource": "workbook",
                    "resourceIdsSource": "workbook",
                    "templateIdSource": "static",
                    "templateId": "community-workbooks/UpdateCompliance/Windows Update for Business reports enrollment",
                    "typeSource": "workbook",
                    "gallerySource": "workbook",
                    "locationSource": "default",
                    "passSpecificParams": true,
                    "templateParameters": [
                      {
                        "name": "SavedMapping",
                        "source": "parameter",
                        "value": "savedMapping"
                      }
                    ]
                  }
                }
              ]
            },
            "customWidth": "35",
            "name": "links - 7"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "b3f4c34c-d421-4373-a567-8e3b10e63235",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Overview",
                  "subTarget": "Overview",
                  "style": "link"
                },
                {
                  "id": "a55effea-5f5f-45c2-89ea-8032affc3541",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Quality updates",
                  "subTarget": "QualityUpdates",
                  "style": "link"
                },
                {
                  "id": "748a4c57-143e-4600-81db-1a44fca6aabf",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Feature updates",
                  "subTarget": "FeatureUpdates",
                  "style": "link"
                },
                {
                  "id": "a58ab8ff-ed50-487d-b661-4d680b693571",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Delivery Optimization",
                  "subTarget": "DeliveryOptimization",
                  "style": "link"
                }
              ]
            },
            "name": "WorkbookTabControl"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "News and links",
                    "expandable": true,
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "** What's new? **\r\n\r\nThis public preview version features a new experience that lets you easily monitor Windows updates and patch compliance, with insights into quality updates, feature updates, and more."
                        },
                        "customWidth": "25",
                        "name": "WhatsNew"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "** Related links **\r\n\r\n<a href='https://techcommunity.microsoft.com/t5/windows-it-pro-blog/azure-ad-required-for-update-compliance-after-october-15-2022/ba-p/3301621'>Azure Active Directory</a> will be required for Windows Update for Business after 10/15/22.\r\n\r\nKeep your Windows client devices up to date with <a href='https://docs.microsoft.com/en-us/windows/deployment/update/waas-manage-updates-wufb'>Windows Update for Business</a>."
                        },
                        "customWidth": "25",
                        "name": "RelatedLinks"
                      }
                    ]
                  },
                  "name": "GetStartedWithUpdateCompliance"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let SnapshotTime = datetime({_SnapshotTime});\r\nUCClient\r\n| where TimeGenerated == SnapshotTime\r\n| extend Title = \"Total enrolled devices\"\r\n| extend Subtitle = \"Total\"\r\n| extend SeeDeviceDistribution = \"View details\"\r\n| summarize TotalDevices=count() by SeeDeviceDistribution, Title, Subtitle\r\n",
                    "size": 3,
                    "title": "Total enrolled devices",
                    "noDataMessage": "No devices",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "Subtitle",
                        "formatter": 1
                      },
                      "rightContent": {
                        "columnMatch": "TotalDevices",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "SeeDeviceDistribution",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate",
                          "linkIsContextBlade": true,
                          "workbookContext": {
                            "componentIdSource": "workbook",
                            "resourceIdsSource": "workbook",
                            "templateIdSource": "static",
                            "templateId": "community-workbooks/UpdateCompliance/Total enrolled devices",
                            "typeSource": "workbook",
                            "gallerySource": "workbook",
                            "locationSource": "default"
                          },
                          "bladeOpenContext": {
                            "bladeParameters": []
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "0",
                  "name": "TotalEnrolledDevices",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nlet DeviceAlert = UCDeviceAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\";\r\nlet UpdateAlert = UCUpdateAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\";\r\nDeviceAlert\r\n| union (UpdateAlert)\r\n| extend Title = \"Total active alerts\"\r\n| extend Subtitle = \"Devices taking errors\"\r\n| extend ViewDetail = \"View details\"\r\n| summarize ActiveAlerts = count() by Title, ViewDetail,  Subtitle",
                    "size": 3,
                    "title": "Total active alerts",
                    "noDataMessage": "no alerts",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "Subtitle",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "4",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "ViewDetail",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate",
                          "linkIsContextBlade": true,
                          "workbookContext": {
                            "componentIdSource": "workbook",
                            "resourceIdsSource": "workbook",
                            "templateIdSource": "static",
                            "templateId": "community-workbooks/UpdateCompliance/Active alerts",
                            "typeSource": "workbook",
                            "gallerySource": "workbook",
                            "locationSource": "default",
                            "passSpecificParams": true,
                            "templateParameters": [
                              {
                                "name": "mappedSubscription",
                                "source": "parameter",
                                "value": "mappedSubscription"
                              },
                              {
                                "name": "mappedWorkspace",
                                "source": "parameter",
                                "value": "mappedWorkspace"
                              }
                            ]
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "0",
                  "name": "ActiveAlerts",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientReadinessStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where ReadinessStatus == \"Capable\"\r\n| summarize Total = count(), Title = \"Windows 11 eligibility\", Subtitle = \"Capable\"\r\n| extend ViewDetail = \"View details\"",
                    "size": 3,
                    "title": "Windows 11 eligibility",
                    "noDataMessage": "No devices eligible for Windows 11",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "Subtitle",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "success",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "Total",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "ViewDetail",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate",
                          "linkIsContextBlade": true,
                          "workbookContext": {
                            "componentIdSource": "workbook",
                            "resourceIdsSource": "workbook",
                            "templateIdSource": "static",
                            "templateId": "community-workbooks/WaaSUpdateInsights/Win11Reporting",
                            "typeSource": "workbook",
                            "gallerySource": "workbook",
                            "locationSource": "default",
                            "passSpecificParams": true,
                            "templateParameters": [
                              {
                                "name": "mappedSubscription",
                                "source": "parameter",
                                "value": "mappedSubscription"
                              },
                              {
                                "name": "mappedWorkspace",
                                "source": "parameter",
                                "value": "mappedWorkspace"
                              }
                            ]
                          }
                        }
                      },
                      "showBorder": true
                    }
                  },
                  "customWidth": "0",
                  "name": "Win11Eligibility",
                  "styleSettings": {
                    "margin": "10px 10px"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "name": "spacer text"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClient\r\n| where TimeGenerated == _SnapshotTime\r\n| summarize SecurityUpdateStatus = count() by OSSecurityUpdateStatus",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Security update status",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "piechart",
                    "chartSettings": {
                      "yAxis": [
                        "SecurityUpdateStatus"
                      ],
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Latest",
                          "color": "blue"
                        },
                        {
                          "seriesName": "NotLatest",
                          "label": "Not Latest",
                          "color": "orange"
                        },
                        {
                          "seriesName": "MultipleSecurityUpdatesMissing",
                          "label": "Multiple Security Updates Missing",
                          "color": "red"
                        }
                      ]
                    }
                  },
                  "customWidth": "45",
                  "name": "OverallSecurityUpdateStatusChart"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClient\r\n| where TimeGenerated == _SnapshotTime\r\n| extend OSFeatureUpdateStatusModified = iff(OSFeatureUpdateStatus == \"Unknown\", \"Windows Insider Program\", OSFeatureUpdateStatus)\r\n| summarize FeatureUpdateStatus = count() by OSFeatureUpdateStatusModified",
                    "size": 3,
                    "showAnalytics": true,
                    "title": "Feature update status",
                    "showExportToExcel": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "piechart",
                    "chartSettings": {
                      "yAxis": [
                        "FeatureUpdateStatus"
                      ],
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Latest",
                          "color": "blue"
                        },
                        {
                          "seriesName": "NotLatest",
                          "label": "Not Latest",
                          "color": "orange"
                        },
                        {
                          "seriesName": "MultipleSecurityUpdatesMissing",
                          "label": "Multiple Security Updates Missing",
                          "color": "red"
                        }
                      ]
                    }
                  },
                  "customWidth": "45",
                  "name": "OverallFeatureUpdateStatusChart"
                }
              ],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "Overview"
            },
            "name": "SummaryContentGroup",
            "styleSettings": {
              "margin": "0",
              "padding": "0"
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "template",
              "loadFromTemplateId": "community-workbooks/UpdateCompliance/Quality updates",
              "items": [],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "QualityUpdates"
            },
            "name": "QualityUpdatesContentGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "template",
              "loadFromTemplateId": "community-workbooks/UpdateCompliance/Feature updates",
              "items": [],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "FeatureUpdates"
            },
            "name": "FeatureUpdatesContentGroup"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "template",
              "loadFromTemplateId": "community-workbooks/UpdateCompliance/DeliveryOptimization",
              "items": [],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "DeliveryOptimization"
            },
            "name": "DeliveryOptimizationContentGroup"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "mappedSubscription",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "mappedWorkspace",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "isOnboarded",
          "comparison": "isEqualTo",
          "value": "true"
        }
      ],
      "name": "HubGroup"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
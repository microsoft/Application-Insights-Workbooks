{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "ce75a159-b005-424e-ac71-bff10eed3b97",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "HEART Summary",
            "subTarget": "HEART Overview",
            "style": "link"
          },
          {
            "id": "3a770d7b-f7cc-4f67-8f88-595d7aef489b",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Technical Requirements",
            "subTarget": "Technical",
            "style": "link"
          },
          {
            "id": "27dab657-c150-47c5-8a5f-b73b0d1dc928",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Adoption",
            "subTarget": "Adoption",
            "style": "link"
          },
          {
            "id": "6e195d77-85b7-4889-a32c-86895244e337",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Engagement",
            "subTarget": "Engagement",
            "style": "link"
          },
          {
            "id": "574c36fc-3aa9-44e9-8f1b-0c44728ee02d",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Retention",
            "subTarget": "Retention",
            "style": "link"
          },
          {
            "id": "76c92d09-38fa-42c1-877a-9d73ce5a435c",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Task Success",
            "subTarget": "Task Success",
            "style": "link"
          },
          {
            "id": "f21fcfe2-7dfa-4ac0-92bf-c637a4545921",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Happiness",
            "subTarget": "Happiness",
            "style": "link"
          },
          {
            "id": "45bbc158-3bbb-4e9c-8f0a-b503c798b37c",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Daily Metric View",
            "subTarget": "Daily",
            "style": "link"
          },
          {
            "id": "8b97dc75-0ecc-45e8-aa11-675cd1697888",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Feature Metrics",
            "subTarget": "Feature",
            "style": "link"
          }
        ]
      },
      "name": "Tabs"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "c1a902ed-1ec2-489b-a4a9-dbbd9d826564",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "description": "Set time period for data in the below visuals",
            "isRequired": true,
            "value": {
              "durationMs": 7776000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isNotEqualTo",
        "value": "HEART Overview"
      },
      "customWidth": "20",
      "name": "TimeRange"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "bf03cbc5-2416-40f4-850b-db1b72104b7b",
            "cellValue": "Cadence",
            "linkTarget": "parameter",
            "linkLabel": "Monthly",
            "subTarget": "Monthly",
            "preText": "Cadence",
            "style": "link"
          },
          {
            "id": "d3bca4d1-5ac5-43b7-bcfa-d47c008c7009",
            "cellValue": "Cadence",
            "linkTarget": "parameter",
            "linkLabel": "Daily",
            "subTarget": "Daily",
            "style": "link"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isNotEqualTo",
          "value": "HEART Overview"
        },
        {
          "parameterName": "Tab",
          "comparison": "isNotEqualTo",
          "value": "Task Success"
        },
        {
          "parameterName": "Tab",
          "comparison": "isNotEqualTo",
          "value": "Happiness"
        },
        {
          "parameterName": "Tab",
          "comparison": "isNotEqualTo",
          "value": "Daily"
        },
        {
          "parameterName": "Tab",
          "comparison": "isNotEqualTo",
          "value": "Technical"
        }
      ],
      "customWidth": "20",
      "name": "Cadence Tabs"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# HEART \n---\nA user engagement framework that enables holistic measurement of user experience by focusing on 5 dimensions captured through telemetry data.\n\nThe 5 dimensions of HEART enable measurement of **H**appiness, **E**ngagement, **A**doption, **R**etention & **T**ask Success.\n\nEngagement and Retention form a user activity funnel: a subset of users who **adopt** an experience progress become **retained** users. Completing **tasks successfully** drives users down this funnel.\n\nVisit the **Technical Requirements** tab to learn more about telemetry implementation."
            },
            "customWidth": "100",
            "conditionalVisibility": {
              "parameterName": "Tab",
              "comparison": "isEqualTo",
              "value": "HEART Overview"
            },
            "name": "Overview"
          },
          {
            "type": 1,
            "content": {
              "json": "## HEART Metrics\r\n---"
            },
            "name": "text - 11"
          },
          {
            "type": 1,
            "content": {
              "json": "Below is a subset of HEART Metrics, this view showcases the KPIs for each dimension.\r\n\r\n"
            },
            "name": "text - 7"
          },
          {
            "type": 1,
            "content": {
              "json": "### Adoption: Aware Users\r\nCount of unique users who have visited the experience."
            },
            "customWidth": "33",
            "name": "text - 8"
          },
          {
            "type": 1,
            "content": {
              "json": "### Engagement: Active Users\r\nCount of unique users who have voluntary interacted with the experience."
            },
            "customWidth": "34",
            "name": "text - 8 - Copy"
          },
          {
            "type": 1,
            "content": {
              "json": "### Retention: Retained Users\r\nCount of unique users who were active in both the current and previous time periods."
            },
            "customWidth": "33",
            "name": "text - 8 - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| summarize AwareUsers=dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4) by Month=format_datetime(timestamp, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Aware Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "customEvents\n| summarize ActiveUsers=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month=format_datetime(timestamp, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "34",
            "showPin": false,
            "name": "Active Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let ActiveUsersLastMonth = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Month = endofmonth(datetime_add(\"month\", 1, timestamp)), ActiveUser = user_AuthenticatedId\n;\nlet Retained = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Month = endofmonth(timestamp), ActiveUser = user_AuthenticatedId\n    | join kind = inner (ActiveUsersLastMonth) on Month, ActiveUser\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Month=format_datetime(Month, \"yyyy-MM\")\n;\ncustomEvents\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\n| join kind=leftouter (Retained) on Month\n| project Month, RetainedUsers=coalesce(RetainedUsers, 0)\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Retained Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Task Success (dummy data)\r\nProportion of tasks performed efficiently and effectively."
            },
            "customWidth": "50",
            "name": "Task Success Title"
          },
          {
            "type": 1,
            "content": {
              "json": "### Happiness (dummy data)\r\nMeasures how users feel about the experience offered to them."
            },
            "customWidth": "50",
            "name": "Happiness Title"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "datatable (Month:datetime, Purchase:real)\n    [datetime(2021-01-31), 0.654,\n     datetime(2021-02-28), 0.545,\n     datetime(2021-03-31), 0.607]\n| summarize Purchase=max(Purchase) by Month=format_datetime(Month, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": false,
                      "minimumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Task Success",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "datatable (Month:datetime, StarRating:real)\n    [datetime(2021-01-31), 2.5,\n     datetime(2021-02-28), 4.0,\n     datetime(2021-03-31), 4.2]\n| summarize AvgStarRating=avg(StarRating) by Month=format_datetime(Month, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Star Rating",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "HEART Overview"
      },
      "name": "HEART Overview"
    },
    {
      "type": 1,
      "content": {
        "json": "## Adoption\r\n### Defining Adoption\r\nAny user who has loaded or visited the experience is considered an adopted user.\r\n### Measuring Adoption\r\nAny user who loads or visits the experience is considered an aware user (regardless of whether or not they have clicked or selected anything in the experience)."
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Adoption"
      },
      "name": "Adoption Text"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| summarize AwareUsers=dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4) by Month=format_datetime(timestamp, \"yyyy-MM\") // count only authenticated users\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Aware Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Aware Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = pageViews | union customEvents;\ndata\n| summarize by Month=format_datetime(timestamp, \"yyyy-MM\")\n| join kind=leftouter (\n    data\n    | summarize FirstAware=format_datetime(min(timestamp), \"yyyy-MM\") by user_AuthenticatedId // first date each user visited the experience\n) on $left.Month==$right.FirstAware\n| summarize NetNewAware=coalesce(dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4), 0) by Month\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Net New Aware",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Net New Aware",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = pageViews | union customEvents;\r\ndata\r\n| summarize by Month=format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (\r\n    data\r\n    | where isnotempty(user_AuthenticatedId)\r\n    | summarize Month=format_datetime(min(timestamp), \"yyyy-MM\") by user_AuthenticatedId, Row=1 // first date each user visited the experience\r\n) on Month\r\n| order by Month asc\r\n| extend RowNum=row_cumsum(Row) // sum rows to count users, 1 row for each user\r\n| summarize CumulativeAwareUsers=coalesce(max(RowNum), 0) by Month",
              "size": 1,
              "aggregation": 5,
              "title": "Cumulative Aware Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "sortBy": [],
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true
              }
            },
            "customWidth": "50",
            "name": "Cumulative Aware Users",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Adoption"
        },
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Monthly"
        }
      ],
      "name": "Adoption Monthly"
    },
    {
      "type": 1,
      "content": {
        "json": "## Engagement\r\n### Why no \"Engagement Metric\"?\r\nIt is challenging to measure engagement generically because engagement is driven both by expected usage and actual usage. While an experience such as Microsoft Teams would have high daily usage as employees rely on Teams for daily communication, other experiences expect usage at a weekly or even monthly cadence (such as a rent payment portal). An accurate measurement of engagement should be based on an experience’s specific user-activity. For this reason, the HEART Framework measures engagement using the concept of active users (users who voluntarily interact with the experinces) and will be assessing it by breaking it down into 3 sub-dimensions: \r\n1. Activity depth – how many features are users leveraging each time the user interacts with the experience?\r\n2. Activity breadth – Over a given period, how many features of the experience is a user leveraging?\r\n3. How often does a user interact with the experience – daily, weekly, monthly?\r\n\r\n### Defining Engagement\t\r\nAn engaged user is a user who voluntary interacts with the experience. \r\n\r\n### Defining Active Users\t\r\nAny user who performs a user-initiated action like clicking a button, or typing an input etc. is counted as an active user. While Aware Users includes all users who have loaded the experience, active users must have performed an intentional action."
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Engagement"
      },
      "name": "Engagement Text"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "customEvents\n| summarize ActiveUsers=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month=format_datetime(timestamp, \"yyyy-MM\") // count only authenticated users with at least one keyboard or mouse click\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Active Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Active Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| where isnotempty(user_AuthenticatedId)\n| summarize OverallActivity=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType), 4) * 1.0 / dcount(user_AuthenticatedId, 4) by Month=format_datetime(timestamp, \"yyyy-MM\") // proportion of Aware Users who are also Active Users\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Overall Activity",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "34",
            "showPin": false,
            "name": "Overall Activity",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let MonthlyFeatureSession = customEvents\r\n    | where isnotnull(customDimensions.parentId) and isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n    | summarize MonthlyFeatureCount=dcount(tostring(customDimensions.parentId)) by Month=format_datetime(timestamp, \"yyyy-MM\"), user_AuthenticatedId, session_Id\r\n    | summarize MonthlyMedianFeaturesSession = percentile(MonthlyFeatureCount, 50) by Month\r\n;\r\ncustomEvents\r\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (MonthlyFeatureSession) on Month\r\n| project Month, [\"Features per Session\"]=coalesce(MonthlyMedianFeaturesSession, 0)\r\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Features per Session",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "yAxis": [
                  "Features per Session"
                ],
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true
              }
            },
            "customWidth": "33",
            "name": "Features per Session",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let dailyFeature = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n        , Day = startofday(timestamp)\r\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n| summarize DailyFeatures = dcount(tostring(customDimensions.parentId), 4) by Month, Day, user_AuthenticatedId\r\n| summarize DailyMedian = percentile(DailyFeatures, 50) by Month\r\n;\r\nlet monthlyFeature = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n        , Day = startofday(timestamp)\r\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n| summarize MonthlyFeatures = dcount(tostring(customDimensions.parentId), 4) by Month, user_AuthenticatedId\r\n| summarize MonthlyMedian = percentile(MonthlyFeatures, 50) by Month\r\n;\r\nmonthlyFeature\r\n| join dailyFeature on Month\r\n| project Month=format_datetime(Month, \"yyyy-MM\"), DailyFeatureUsage=DailyMedian, MonthlyFeatureUsage=MonthlyMedian\r\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Median Features Used Per User",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "Month",
                "yAxis": [
                  "DailyFeatureUsage",
                  "MonthlyFeatureUsage"
                ],
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  },
                  "min": 0
                }
              }
            },
            "customWidth": "33",
            "name": "Median Features Used",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let dau = customEvents\r\n| extend Month = format_datetime(timestamp, \"yyyy-MM\")\r\n         ,Day = startofday(timestamp)\r\n| summarize DailyActiveUsers = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month, Day // count active users by day\r\n;\r\nlet mau = customEvents\r\n| extend Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| summarize MonthlyActiveUsers = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month // count active users by month\r\n;\r\nmau\r\n| join dau on Month\r\n| summarize Intensity = percentile(DailyActiveUsers, 50) * 1.0 / min(MonthlyActiveUsers) by Month // divide median daily active users by monthly active users to get proportion of users visiting the experience on a daily basis\r\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Intensity - DAU / MAU",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "month",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Intensity",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Intensity (DAU / MAU)",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Engagement"
        },
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Monthly"
        }
      ],
      "name": "Engagement"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| summarize AwareUsers=dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4) by Day=startofday(timestamp) // count only authenticated users\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Aware Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Aware Users Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = pageViews | union customEvents;\ndata\n| summarize by Day=startofday(timestamp) \n| join kind=leftouter (\n    data\n    | summarize FirstAware=startofday(min(timestamp)) by user_AuthenticatedId // first date each user visited the experience\n) on $left.Day==$right.FirstAware\n| summarize NetNewAware=coalesce(dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4), 0) by Day\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Net New Aware",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Net New Aware Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = pageViews | union customEvents;\r\ndata\r\n| summarize by Day=startofday(timestamp)\r\n| join kind=leftouter (\r\n    data\r\n    | where isnotempty(user_AuthenticatedId)\r\n    | summarize Day=startofday(min(timestamp)) by user_AuthenticatedId, Row=1  // first date each user visited the experience\r\n) on Day\r\n| order by Day asc\r\n| extend RowNum=row_cumsum(Row) // sum rows to count users, 1 row per user\r\n| summarize CumulativeAwareUsers=coalesce(max(RowNum), 0) by Day",
              "size": 1,
              "aggregation": 5,
              "title": "Cumulative Aware Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "sortBy": [],
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true
              }
            },
            "customWidth": "50",
            "name": "Cumulative Aware Users",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Adoption"
        },
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Daily"
        }
      ],
      "name": "Adoption - Daily"
    },
    {
      "type": 1,
      "content": {
        "json": "| Metric                 | Definition                                                                          | Question Answered                                      |\r\n|------------------------|-------------------------------------------------------------------------------------|--------------------------------------------------------|\r\n| Aware Users            | Count of users who have loaded or visited the experience.                           | How many users are showing interest in the experience? |\r\n| Net New Aware Users    | Count of Aware Users who have visited the experience for the first time.            | How quickly is the experience gaining new users?       |\r\n| Cumulative Aware Users | Count of Aware Users who have visited the experience over the selected time period. | How has the interested user-base grown over time?      |"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Adoption"
      },
      "name": "Adoption Metric Definitions"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "customEvents\n| summarize ActiveUsers=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Day=startofday(timestamp) // count only authenticated users with at least one keyboard or mouse click\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Active Users",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Active Users Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| where isnotempty(user_AuthenticatedId) // filter to only authenticated users\n| summarize OverallActivity=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType), 4) * 1.0 / dcount(user_AuthenticatedId, 4) by Day=startofday(timestamp) // proportion of all authenticated users with at least 1 keyboard or mouse click \n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Overall Activity",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "34",
            "showPin": false,
            "name": "Overall Activity Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let DailyFeatureSession = customEvents\r\n    | where isnotnull(customDimensions.parentId) and isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n    | summarize DailyFeatureCount=dcount(tostring(customDimensions.parentId)) by Day=startofday(timestamp), user_AuthenticatedId, session_Id\r\n    | summarize DailyMedianFeaturesSession = percentile(DailyFeatureCount, 50) by Day\r\n;\r\ncustomEvents\r\n| summarize by Day = startofday(timestamp)\r\n| join kind=leftouter (DailyFeatureSession) on Day\r\n| project Day, [\"Features per Session\"]=coalesce(DailyMedianFeaturesSession, 0)\r\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Features per Session",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "Day",
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "min": 0
                }
              }
            },
            "customWidth": "33",
            "name": "Features per Session Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let dimdate = pageViews \r\n| union customEvents\r\n| summarize by Day=startofday(timestamp)\r\n;\r\nlet dailyFeature = customEvents\r\n| extend Day = startofday(timestamp)\r\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n| summarize DailyFeatures = dcount(tostring(customDimensions.parentId), 4) by Day, user_AuthenticatedId\r\n| summarize DailyMedian = percentile(DailyFeatures, 50) by Day\r\n;\r\nlet weeklyFeature = customEvents\r\n| extend Week = startofweek(timestamp)\r\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n| summarize WeeklyFeatures = dcount(tostring(customDimensions.parentId), 4) by Week, user_AuthenticatedId\r\n| summarize WeeklyMedian = percentile(WeeklyFeatures, 50) by Week\r\n;\r\ndimdate\r\n| join kind=leftouter dailyFeature on Day\r\n| join kind=leftouter weeklyFeature on $left.Day == $right.Week\r\n| project Day, DailyFeatureUsage=coalesce(DailyMedian, 0), WeeklyFeatureUsage=WeeklyMedian\r\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Median Features Used Per User",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "Day",
                "yAxis": [
                  "DailyFeatureUsage",
                  "WeeklyFeatureUsage"
                ],
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true
              }
            },
            "customWidth": "33",
            "name": "Median Features Used Per User Daily",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let dau = customEvents\r\n| extend week = startofweek(timestamp)\r\n         ,day = startofday(timestamp)\r\n| summarize DailyActiveUsers = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by week, day\r\n;\r\nlet wau = customEvents\r\n| extend week = startofweek(timestamp)\r\n| summarize WeeklyActiveUsers = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by week\r\n;\r\nwau\r\n| join dau on week\r\n| summarize Intensity = percentile(DailyActiveUsers, 50) * 1.0 / min(WeeklyActiveUsers) by week\r\n| project Intensity=case(isnan(Intensity), 0.0, Intensity), week\r\n| order by week asc",
              "size": 1,
              "aggregation": 5,
              "title": "Intensity - DAU / WAU",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "month",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Intensity",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "34",
            "name": "Intensity (DAU / WAU)",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Daily"
        },
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Engagement"
        }
      ],
      "name": "Engagement - Daily"
    },
    {
      "type": 1,
      "content": {
        "json": "| Metric                        | Definition                                                         | Question Answered                                                                                         |\r\n|-------------------------------|--------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|\r\n| Active Users                  | Count of users who have performed a user-initiated action          | How many users are interacting with the experience?                                                       |\r\n| Overall Activity              | Proportion of Aware Users who also Active Users                    | Are users progressing from interested to interacting with the experience?                                 |\r\n| Features Per Session          | Median number of features used per user per session                | Activity depth - how many features are users leveraging each time the user interacts with the experience? |\r\n| Median Features Used Per User | Median number of features used per user                            | Activity breadth - how many features of the experience is a user leveraging?                              |\r\n| Intensity (DAU / MAU)         | Proportion of Monthly Active Users who are also Daily Active Users | How many users in a given month interact with the experience on a daily basis?                            |\r\n| Intensity (DAU / WAU)         | Proportion of Weekly Active Users who are also Daily Active Users  | How many users in a given week interact with the experience on a daily basis?                             |"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Engagement"
      },
      "name": "Engagement Metric Definitions"
    },
    {
      "type": 1,
      "content": {
        "json": "## Retention\r\n### Definition Retention\r\nA retained user is someone who was active both this reporting period and the previous reporting period.\r\n### Measuring Retention\r\nIn addition to tracking repeat users, identifying cohorts of users based on when they first became active helps understand the impact of newly introduced features on retention."
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Retention"
      },
      "name": "Retention Text"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let ActiveUsersLastMonth = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) // filter to active authenticated users only\n    | summarize by Month = endofmonth(datetime_add(\"month\", 1, timestamp)), ActiveUser = user_AuthenticatedId // add 1 month to join on next month active users to count retained\n;\nlet Retained = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Month = endofmonth(timestamp), ActiveUser = user_AuthenticatedId\n    | join kind = inner (ActiveUsersLastMonth) on Month, ActiveUser  // users visited experiences in back-to-back months\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Month=format_datetime(Month, \"yyyy-MM\")\n;\ncustomEvents\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\n| join kind=leftouter (Retained) on Month\n| project Month, RetainedUsers=coalesce(RetainedUsers, 0)\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Retained Users",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Retained Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let ActiveUsersLastMonth = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Month = endofmonth(datetime_add(\"month\", 1, timestamp)), ActiveUser = user_AuthenticatedId\n;\nlet Retained = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Month = endofmonth(timestamp), ActiveUser = user_AuthenticatedId\n    | join kind = inner (ActiveUsersLastMonth) on Month, ActiveUser\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Month=format_datetime(Month, \"yyyy-MM\")\n;\ncustomEvents\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\n| join kind=leftouter (Retained) on Month\n| join kind=leftouter (ActiveUsersLastMonth | summarize ActiveUsers=dcount(ActiveUser,4) by Month=format_datetime(Month, \"yyyy-MM\")) on Month  // count all active users from previous month\n| extend Retention = RetainedUsers * 1.0 / ActiveUsers // proportion of active users who returned the following month\n| project Month, Retention=coalesce(case(isnan(Retention), 0.0, Retention), 0.0)\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Retention",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "Month",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "Month",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Retention",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Retention"
        },
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Monthly"
        }
      ],
      "name": "Retention"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let ActiveUsersLastDay = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Day = startofday(datetime_add(\"day\", 1, timestamp)), ActiveUser = user_AuthenticatedId\n;\nlet Retained = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Day = startofday(timestamp), ActiveUser = user_AuthenticatedId\n    | join kind = inner (ActiveUsersLastDay) on Day, ActiveUser\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Day\n;\ncustomEvents\n| summarize by Day = startofday(timestamp)\n| join kind=leftouter (Retained) on Day\n| project Day, RetainedUsers=coalesce(RetainedUsers, 0)\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Retained Users",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Retained Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let ActiveUsersLastDay = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Day = startofday(datetime_add(\"day\", 1, timestamp)), ActiveUser = user_AuthenticatedId\n;\nlet Retained = customEvents\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n    | summarize by Day = startofday(timestamp), ActiveUser = user_AuthenticatedId\n    | join kind = inner (ActiveUsersLastDay) on Day, ActiveUser\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Day\n;\ncustomEvents\n| summarize by Day=startofday(timestamp)\n| join kind=leftouter (Retained) on Day\n| join kind=leftouter (ActiveUsersLastDay | summarize ActiveUsers=dcount(ActiveUser,4) by Day) on Day\n| extend Retention = RetainedUsers * 1.0 / ActiveUsers\n| project Day, Retention=coalesce(case(isnan(Retention), 0.0, Retention), 0.0)\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Retention",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "Month",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "Month",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "showPin": false,
            "name": "Retention",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "Retention"
        },
        {
          "parameterName": "Cadence",
          "comparison": "isEqualTo",
          "value": "Daily"
        }
      ],
      "name": "Retention Daily"
    },
    {
      "type": 1,
      "content": {
        "json": "| Metric         | Definition                                                                          | Question Answered                                              |\r\n|----------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------|\r\n| Retained Users | Count of Active Users who were also Active the previous period                      | How many users are staying engaged with the experience?        |\r\n| Retention      | Proportion of Active Users from the previous period who are also Active this period | What percent of users are staying engaged with the experience? |"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Retention"
      },
      "name": "Retention Metric Definitions"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Task Success\r\n### Defining Task Success\r\nTask Success tracks whether users can perform a task efficiently and effectively using the capabilities provided by the feature. \r\n\r\n### Measuring Task Success\r\nA successful task meets 3 requirements:\r\n1.\tExpected Task Flow – the intended task flow of the feature was completed (the task flow of the user aligned with the expected task flow)\r\n2.\tHigh Performance – the intended functionality of the feature was accomplished in a reasonable amount of time\r\n3.\tHigh Reliability – the intended functionality of the feature was accomplished without failure\r\n\r\nA task is considered unsuccessful if any of the above requirements is not met.\r\n\r\n### Below is dummy data. ETA for live Task Success: June 2021.\r\n"
            },
            "name": "Task Success Overview"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "9cac7220-6c0a-440f-a425-5c540c21e5b2",
                  "version": "KqlParameterItem/1.0",
                  "name": "TopStep",
                  "type": 2,
                  "description": "Select the activities that form the top of your funnel.",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "union customEvents, pageViews\r\n| where timestamp > ago(90d)\r\n| summarize count() by name\r\n| order by count_ desc\r\n| project Id=name, Title=name, Selected=false\r\n| union (\r\ndatatable(Id:string, Title:string, Selected:boolean)[\r\n'*', 'All Events and Page Views', true\r\n]\r\n)",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ]
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.insights/components",
                  "value": [
                    "Search Button"
                  ]
                },
                {
                  "id": "43be0fbf-f7c5-4822-a582-b59407774e59",
                  "version": "KqlParameterItem/1.0",
                  "name": "SegmentBy",
                  "type": 2,
                  "isRequired": true,
                  "query": "datatable(value:string, text:string)[\r\n'itemType', '❌ None',\r\n'name', '📛 Activity',\r\n'cloud_RoleInstance', '🖥️ Machine',\r\n'client_CountryOrRegion', '📍 Country or Region',\r\n'client_StateOrProvince', '📍 State or Province',\r\n'client_City', '📍 City',\r\n'client_Browser', '🌐 Client Browser',\r\n'client_OS', '️️🖥️ Client Operating System',\r\n'client_Model', '📱 Client Model',\r\n'application_Version', '⚪ Application Version',\r\n'operation_Name', '⚪ Operation',\r\n]\r\n| union (union pageViews, customEvents\r\n| where timestamp >= ago(90d)\r\n| where name in ({TopStep}) or '*' in ({TopStep})\r\n| project customDimensions \r\n| summarize schema = buildschema(customDimensions) \r\n| mvexpand schema\r\n| extend e = extract(@'{\"(.+)\":.+}', 1, tostring(schema))\r\n| project text = strcat('❄️ ', e), value = strcat('customDimensions[\"', e, '\"]'))",
                  "value": "itemType",
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.insights/components"
                },
                {
                  "id": "9f478120-121f-4dfb-bf04-e6d6db46f298",
                  "version": "KqlParameterItem/1.0",
                  "name": "ConversionScope",
                  "type": 2,
                  "description": "Select the scope for your conversion calculations. In the Session scope, both the top and bottom activities need to happen in the same session to count towards conversion. For both User scopes, the user is allowed to have done both activities in different sessions.",
                  "isRequired": true,
                  "query": "datatable(key:string, display:string)\r\n[\r\n\"user_Id\", \"Anonymous Users\", \r\n\"user_AuthenticatedId\", \"Authenticated Users\",\"session_Id\", \"Sessions\",\r\n]",
                  "value": "user_AuthenticatedId",
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.insights/components"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.insights/components"
            },
            "name": "FunnelTop"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "af3d3fc1-9159-43b0-a851-25dc64c15cb7",
                  "version": "KqlParameterItem/1.0",
                  "name": "BottomStep",
                  "type": 2,
                  "description": "Select the activities that form the bottom of your funnel.",
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "union customEvents, pageViews\r\n| where timestamp > ago(90d)\r\n| summarize count() by name\r\n| order by count_ desc\r\n| project Id=name, Title=name, Selected=false\r\n| union (\r\ndatatable(Id:string, Title:string, Selected:boolean)[\r\n'*', 'All Events and Page Views', true\r\n]\r\n)",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.insights/components",
                  "value": [
                    "Save Button"
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.insights/components"
            },
            "name": "FunnelBottom"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = union customEvents, pageViews\r\n| where timestamp {TimeRange}\r\n| extend Month=format_datetime(timestamp, \"yyyy-MM\");\r\nlet topUsers = data\r\n| where name in ({TopStep}) or '*' in ({TopStep})\r\n| extend Dim1 = iff('{SegmentBy}' == 'itemType', 'Overall', {SegmentBy}) // reusing itemType to indicate no segmentation\r\n| summarize Min = min(timestamp) by {ConversionScope}, Dim1, Month;\r\nlet bottomUsers = data\r\n| where name in ({BottomStep}) or '*' in ({BottomStep})\r\n| summarize Max = max(timestamp) by {ConversionScope}, Month;\r\nlet funnel = topUsers\r\n| join kind=inner (bottomUsers) on {ConversionScope}, Month\r\n| where Max >= Min\r\n| summarize Bottom = dcount({ConversionScope}) by Dim1, Month;\r\nlet funnelTop = topUsers\r\n| summarize Top=dcount({ConversionScope}) by Dim1, Month\r\n| order by Top desc;\r\nlet multiFunnel = funnel\r\n| join kind=inner (funnelTop) on Dim1, Month\r\n| project Month, Dim1, Top, Bottom, Conversion = 1.0 * Bottom / Top\r\n//| extend Relevance = iff(Conversion == 0, pow(Top, 1.6), Top * 100 / Conversion)\r\n;\r\ndata\r\n| summarize by Month\r\n| join kind=leftouter (multiFunnel) on Month\r\n//| order by Relevance desc\r\n| order by Month asc\r\n| project Month, [\"Conversion Rate (%)\"] = coalesce(Conversion, 0.0) //, ['Segments'] = Dim1\r\n//| project Month, ['Segments'] = Dim1, [\"All Users\"] = Top, [\"Converted Users\"] = Bottom, [\"Conversion Rate (%)\"] = Conversion",
              "size": 1,
              "aggregation": 5,
              "title": "Task Success",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "Month",
                "yAxis": [
                  "Conversion Rate (%)"
                ],
                "group": null,
                "createOtherGroup": 0,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "name": "Task Success"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = union customEvents, pageViews\r\n| where timestamp {TimeRange}\r\n| extend Month=format_datetime(timestamp, \"yyyy-MM\");\r\nlet topUsers = data\r\n| where name in ({TopStep}) or '*' in ({TopStep})\r\n| extend Dim1 = iff('{SegmentBy}' == 'itemType', 'Overall', {SegmentBy}) // reusing itemType to indicate no segmentation\r\n| summarize Min = min(timestamp) by {ConversionScope}, Dim1, Month;\r\nlet bottomUsers = data\r\n| where name in ({BottomStep}) or '*' in ({BottomStep})\r\n| summarize Max = max(timestamp) by {ConversionScope}, Month;\r\nlet funnel = topUsers\r\n| join kind=inner (bottomUsers) on {ConversionScope}, Month\r\n| where Max >= Min\r\n| summarize Bottom = dcount({ConversionScope}) by Dim1, Month;\r\nlet funnelTop = topUsers\r\n| summarize Top=dcount({ConversionScope}) by Dim1, Month\r\n| order by Top desc;\r\nlet multiFunnel = funnel\r\n| join kind=inner (funnelTop) on Dim1, Month\r\n| project Month, Dim1, Top, Bottom, Conversion = 1.0 * Bottom / Top\r\n//| extend Relevance = iff(Conversion == 0, pow(Top, 1.6), Top * 100 / Conversion)\r\n;\r\ndata\r\n| summarize by Month\r\n| join kind=leftouter (multiFunnel) on Month\r\n//| order by Relevance desc\r\n| order by Month asc\r\n//| project Month, [\"Conversion Rate (%)\"] = coalesce(Conversion, 0.0)\r\n| project Month, ['Segments'] = Dim1, [\"All Users\"] = Top, [\"Converted Users\"] = Bottom, [\"Conversion Rate (%)\"] = Conversion",
              "size": 1,
              "aggregation": 5,
              "title": "Task Success",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Conversion Rate (%)",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "percent",
                        "useGrouping": false,
                        "minimumSignificantDigits": 3,
                        "maximumSignificantDigits": 3
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "xAxis": "Month",
                "yAxis": [
                  "Conversion Rate (%)"
                ],
                "group": null,
                "createOtherGroup": 0,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "name": "Task Success - Copy"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Task Success"
      },
      "name": "Task Success - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Happiness\r\n### Defining Happiness\t\r\nHappiness is a user-reported dimension that measures how users feel about the experience offered to them. \r\n\r\n### Measuring Happiness\r\nA common approach to measure this dimension is to ask users a Net Promoter Score (NPS) question such as “Would you recommend this experience to a co-worker?”. Users' responses on a 3 or a 5-point scale (e.g., no, maybe and yes) are aggregated to create an experience-level score ranging from 1-5 (with 5 being the highest). As user-initiated feedback tends to be negatively biased, HEART tracks Happiness from surveys displayed to users at pre-defined intervals.\r\n\r\n### Below is dummy data. ETA for live Happiness: June 2021"
            },
            "name": "text - 5"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "datatable (Month:datetime, StarRating:real)\n    [datetime(2021-01-31), 2.5,\n     datetime(2021-02-28), 4.0,\n     datetime(2021-03-31), 4.2]\n| summarize AvgStarRating=avg(StarRating) by Month=format_datetime(Month, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Star Rating",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "timechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "75",
            "showPin": false,
            "name": "Star Rating",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "datatable (Month:datetime, Responses:int)\n    [datetime(2021-01-31), 8,\n     datetime(2021-02-28), 6,\n     datetime(2021-03-31), 5]\n| summarize Responses=max(Responses) by Month=format_datetime(Month, \"yyyy-MM\")\n| order by Month asc",
              "size": 1,
              "aggregation": 5,
              "title": "Responses",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "timechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "25",
            "showPin": false,
            "name": "Responses",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Happiness"
      },
      "name": "Happiness"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = pageViews | union customEvents;\ndata\n| summarize AwareUsers=dcountif(user_AuthenticatedId,isnotempty(user_AuthenticatedId), 4) by Day=startofday(timestamp)\n| join kind=leftouter(\n    data\n    | summarize Day=startofday(min(timestamp)) by NewAwareUser=user_AuthenticatedId\n) on Day\n| summarize NewNewAwareUsers=coalesce(dcountif(NewAwareUser, isnotempty(NewAwareUser), 4), 0) by Day, AwareUsers\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Daily Aware Users, New New Aware Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Daily Aware Users, New New Aware Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "customEvents\n| summarize ActiveUsers=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Day=startofday(timestamp)\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Daily Active Users",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "34",
            "showPin": false,
            "name": "Daily Active Users",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let UserDates = customEvents\n//| summarize ActiveUsers=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Day=startofday(timestamp)\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\n| summarize by appName, ActiveUser=user_AuthenticatedId, Day=startofday(timestamp)\n;\nlet lookupWindow = 28day;\nlet lookupBin = lookupWindow / 2.0;\nUserDates\n| project appName, Start=Day, ActiveUser, TimeKey=bin(Day, lookupBin)\n| join kind=inner (\n    UserDates\n    | project appName, End=Day, ActiveUser, TimeKey = range(bin(Day-lookupWindow, lookupBin), bin(Day, lookupBin), lookupBin)\n    | mv-expand TimeKey to typeof(datetime)\n) on appName, TimeKey\n| where (End-Start) between (0day .. lookupWindow)\n| summarize MAU=dcount(ActiveUser, 4) by Day=End\n| join kind=inner (\n    UserDates\n    | summarize DailyActiveUsers=dcount(ActiveUser, 4) by Day\n) on Day\n| summarize by Day, Intensity=DailyActiveUsers * 1.0 / MAU\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Intensity (Median DAU / Rolling 28-Day MAU)",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "sortBy": [],
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true,
                      "minimumSignificantDigits": 3,
                      "maximumSignificantDigits": 3
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Intensity",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "pageViews\n| union customEvents\n| where isnotempty(user_AuthenticatedId)\n| summarize OverallActivity=dcountif(user_AuthenticatedId,isnotnull(customDimensions.actionType), 4) * 1.0 / dcount(user_AuthenticatedId, 4) by Day=startofday(timestamp)\n| order by Day asc",
              "size": 1,
              "aggregation": 5,
              "title": "Overall Activity",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "showPin": false,
            "name": "Overall Activity",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": " customEvents\r\n| extend Day = startofday(timestamp)\r\n| where isnotnull(customDimensions.actionType)\r\n| summarize DailyFeatures = dcount(tostring(customDimensions.parentId), 4) by Day, user_AuthenticatedId\r\n| summarize DailyMedian = percentile(DailyFeatures, 50) by Day\r\n| project Day, DailyFeatureUsage=DailyMedian",
              "size": 1,
              "aggregation": 5,
              "title": "Daily Feature Usage",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "Day",
                "yAxis": [
                  "DailyFeatureUsage"
                ],
                "group": null,
                "createOtherGroup": 0,
                "showDataPoints": true,
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  },
                  "min": 0
                }
              }
            },
            "customWidth": "34",
            "name": "Daily Feature Usage",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Daily"
      },
      "name": "Daily"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "445ab212-5be3-4534-9bb1-a2152c602b64",
                  "version": "KqlParameterItem/1.0",
                  "name": "Feature",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "customEvents\r\n| extend Feature = tostring(customDimensions.parentId)\r\n| where isnotempty(Feature)\r\n| distinct Feature",
                  "value": [
                    "App Name Search"
                  ],
                  "typeSettings": {
                    "limitSelectTo": 5,
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::1",
                  "queryType": 0,
                  "resourceType": "microsoft.insights/components"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.insights/components"
            },
            "name": "Feature Parameter"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let FeatureDAU = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | extend Month = format_datetime(timestamp, \"yyyy-MM\")\r\n         ,Day = startofday(timestamp)\r\n    | summarize DailyActiveUsers = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month, Day\r\n    | summarize DAU = percentile(DailyActiveUsers, 50) by Month\r\n\r\n;\r\nlet FeatureMAU = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize MAU=dcountif(user_AuthenticatedId,isnotempty(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Month=format_datetime(timestamp, \"yyyy-MM\")\r\n;\r\ncustomEvents\r\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (FeatureDAU) on Month\r\n| join kind=leftouter (FeatureMAU) on Month\r\n| project Month, MAU=coalesce(MAU, 0), DAU=coalesce(DAU, 0)\r\n| order by Month asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Feature Active Users",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Month",
                      "yAxis": [
                        "MAU",
                        "DAU"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "33",
                  "name": "Feature Active Users",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "customEvents\r\n| summarize by Month=format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (\r\n    customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize FirstAware=format_datetime(min(timestamp), \"yyyy-MM\") by user_AuthenticatedId\r\n) on $left.Month==$right.FirstAware\r\n| summarize NetNewAware=coalesce(dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4), 0) by Month\r\n| order by Month asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Net New Users (Feature)",
                    "timeContext": {
                      "durationMs": 0
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Month",
                      "yAxis": [
                        "NetNewAware"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "34",
                  "name": "Net New Users (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let DailyFeatureInteractions = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n    | summarize DailyInteractions=count() by Month=format_datetime(timestamp, \"yyyy-MM\"), Day=startofday(timestamp), user_AuthenticatedId\r\n    | summarize DailyMedianInteractions = percentile(DailyInteractions, 50) by Month\r\n;\r\nlet MonthlyFeatureInteractions = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n    | summarize MonthlyInteractions=count() by Month=format_datetime(timestamp, \"yyyy-MM\"), user_AuthenticatedId\r\n    | summarize MonthlyMedianInteractions = percentile(MonthlyInteractions, 50) by Month\r\n;\r\ncustomEvents\r\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (DailyFeatureInteractions) on Month\r\n| join kind=leftouter (MonthlyFeatureInteractions) on Month\r\n| project Month, DailyInteractions=coalesce(DailyMedianInteractions, 0), MonthlyInteractions=coalesce(MonthlyMedianInteractions, 0)\r\n| order by Month asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Interactions",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Month",
                      "yAxis": [
                        "MonthlyInteractions",
                        "DailyInteractions"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "33",
                  "name": "Interactions",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Retained = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Month = endofmonth(timestamp), ActiveUser = user_AuthenticatedId\r\n    | join kind = inner (\r\n        customEvents\r\n        | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n        | summarize by Month = endofmonth(datetime_add(\"month\", 1, timestamp)), ActiveUser = user_AuthenticatedId\r\n    ) on Month, ActiveUser\r\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Month=format_datetime(Month, \"yyyy-MM\")\r\n;\r\ncustomEvents\r\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (Retained) on Month\r\n| project Month, RetainedUsers=coalesce(RetainedUsers, 0)\r\n| order by Month asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Retained Users (Feature)",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Month",
                      "yAxis": [
                        "RetainedUsers"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true,
                      "xSettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "33",
                  "name": "Retained Users (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let ActiveUsersLastMonth = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Month = endofmonth(datetime_add(\"month\", 1, timestamp)), ActiveUser = user_AuthenticatedId\r\n;\r\nlet Retained = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Month = endofmonth(timestamp), ActiveUser = user_AuthenticatedId\r\n    | join kind = inner (ActiveUsersLastMonth) on Month, ActiveUser\r\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Month=format_datetime(Month, \"yyyy-MM\")\r\n;\r\ncustomEvents\r\n| summarize by Month = format_datetime(timestamp, \"yyyy-MM\")\r\n| join kind=leftouter (Retained) on Month\r\n| join kind=leftouter (ActiveUsersLastMonth | summarize ActiveUsers=dcount(ActiveUser,4) by Month=format_datetime(Month, \"yyyy-MM\")) on Month\r\n| extend Retention = RetainedUsers * 1.0 / ActiveUsers\r\n| project Month, Retention=coalesce(case(isnan(Retention), 0.0, Retention), 0.0)\r\n| order by Month asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Retention (Feature)",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Month",
                      "yAxis": [
                        "Retention"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true,
                      "xSettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      },
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "percent",
                            "useGrouping": true,
                            "minimumSignificantDigits": 3,
                            "maximumSignificantDigits": 3
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "34",
                  "name": "Retention (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "Cadence",
              "comparison": "isEqualTo",
              "value": "Monthly"
            },
            "name": "Feature Monthly"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let FeatureDAU = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | extend Month = format_datetime(timestamp, \"yyyy-MM\")\r\n         ,Day = startofday(timestamp)\r\n    | summarize DAU = dcountif(user_AuthenticatedId, isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId), 4) by Day\r\n\r\n;\r\ncustomEvents\r\n| summarize by Day = startofday(timestamp)\r\n| join kind=leftouter (FeatureDAU) on Day\r\n| project Day, DAU=coalesce(DAU, 0)\r\n| order by Day asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Feature Active Users",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Day",
                      "yAxis": [
                        "DAU"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "33",
                  "name": "Feature Active Users",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "customEvents\r\n| summarize by Day=startofday(timestamp)\r\n| join kind=leftouter (\r\n    customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize FirstAware=startofday(min(timestamp)) by user_AuthenticatedId\r\n) on $left.Day==$right.FirstAware\r\n| summarize NetNewAware=coalesce(dcountif(user_AuthenticatedId, isnotempty(user_AuthenticatedId), 4), 0) by Day\r\n| order by Day asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Net New Users (Feature)",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Day",
                      "yAxis": [
                        "NetNewAware"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "33",
                  "name": "Net New Users (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let DailyFeatureInteractions = customEvents\r\n    | where tostring(customDimensions.parentId) in ({Feature})\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n    | summarize DailyInteractions=count() by Day=startofday(timestamp), user_AuthenticatedId\r\n    | summarize DailyMedianInteractions = percentile(DailyInteractions, 50) by Day\r\n;\r\ncustomEvents\r\n| summarize by Day = startofday(timestamp)\r\n| join kind=leftouter (DailyFeatureInteractions) on Day\r\n| project Day, DailyInteractions=coalesce(DailyMedianInteractions, 0)\r\n| order by Day asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Interactions",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Day",
                      "yAxis": [
                        "DailyInteractions"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true
                    }
                  },
                  "customWidth": "33",
                  "name": "Interactions",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Retained = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Day = startofday(timestamp), ActiveUser = user_AuthenticatedId\r\n    | join kind = inner (\r\n        customEvents\r\n        | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n        | summarize by Day = startofday(datetime_add(\"day\", 1, timestamp)), ActiveUser = user_AuthenticatedId\r\n    ) on Day, ActiveUser\r\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Day\r\n;\r\ncustomEvents\r\n| summarize by Day = startofday(timestamp)\r\n| join kind=leftouter (Retained) on Day\r\n| project Day, RetainedUsers=coalesce(RetainedUsers, 0)\r\n| order by Day asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Retained Users (Feature)",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Day",
                      "yAxis": [
                        "RetainedUsers"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true,
                      "xSettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "33",
                  "name": "Retained Users (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let ActiveUsersLastDay = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Day = startofday(datetime_add(\"day\", 1, timestamp)), ActiveUser = user_AuthenticatedId\r\n;\r\nlet Retained = customEvents\r\n    | where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId) and tostring(customDimensions.parentId) in ({Feature})\r\n    | summarize by Day = startofday(timestamp), ActiveUser = user_AuthenticatedId\r\n    | join kind = inner (ActiveUsersLastDay) on Day, ActiveUser\r\n    | summarize RetainedUsers=dcount(ActiveUser, 4) by Day\r\n;\r\ncustomEvents\r\n| summarize by Day = startofday(timestamp)\r\n| join kind=leftouter (Retained) on Day\r\n| join kind=leftouter (ActiveUsersLastDay | summarize ActiveUsers=dcount(ActiveUser,4) by Day) on Day\r\n| extend Retention = RetainedUsers * 1.0 / ActiveUsers\r\n| project Day, Retention=coalesce(case(isnan(Retention), 0.0, Retention), 0.0)\r\n| order by Day asc",
                    "size": 1,
                    "aggregation": 5,
                    "title": "Retention (Feature)",
                    "timeContext": {
                      "durationMs": 7776000000
                    },
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.insights/components",
                    "visualization": "linechart",
                    "chartSettings": {
                      "xAxis": "Day",
                      "yAxis": [
                        "Retention"
                      ],
                      "group": null,
                      "createOtherGroup": 0,
                      "showDataPoints": true,
                      "xSettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "decimal",
                            "useGrouping": true
                          }
                        }
                      },
                      "ySettings": {
                        "numberFormatSettings": {
                          "unit": 0,
                          "options": {
                            "style": "percent",
                            "useGrouping": true,
                            "minimumSignificantDigits": 3,
                            "maximumSignificantDigits": 3
                          }
                        }
                      }
                    }
                  },
                  "customWidth": "33",
                  "name": "Retention (Feature)",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "Cadence",
              "comparison": "isEqualTo",
              "value": "Daily"
            },
            "name": "Feature Daily"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Feature"
      },
      "name": "Feature Metrics",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let dailyFeatureId = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n         ,Day = startofday(timestamp)\r\n         ,Id = coalesce(tostring(customDimensions.parentId), \"No parentId\")\r\n         ,ParentId=coalesce(tostring(customDimensions.pageName), \"No pageName\")\r\n| summarize FeatureDAU = dcountif(user_AuthenticatedId, isnotempty(customDimensions.actionType), 4) by ParentId, Id, Month, Day\r\n| summarize DAU = percentile(FeatureDAU, 50) by ParentId, Id\r\n;\r\nlet dailyFeatureParentId = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n         ,Day = startofday(timestamp)\r\n         ,ParentId=coalesce(tostring(customDimensions.pageName), \"No pageName\")\r\n| summarize FeatureDAU = dcountif(user_AuthenticatedId, isnotempty(customDimensions.actionType), 4) by ParentId, Month, Day\r\n| summarize DAU = percentile(FeatureDAU, 50) by ParentId\r\n;\r\nlet monthlyFeatureId = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n         ,Id = coalesce(tostring(customDimensions.parentId), \"No parentId\")\r\n         ,ParentId=coalesce(tostring(customDimensions.pageName), \"No pageName\")\r\n| summarize FeatureMAU = dcountif(user_AuthenticatedId, isnotempty(customDimensions.actionType), 4) by ParentId, Id, Month\r\n| summarize MAU = percentile(FeatureMAU, 50) by ParentId, Id\r\n;\r\nlet monthlyFeatureParentId = customEvents\r\n| extend Month = startofmonth(timestamp)\r\n         ,ParentId=coalesce(tostring(customDimensions.pageName), \"No pageName\")\r\n| summarize FeatureMAU = dcountif(user_AuthenticatedId, isnotempty(customDimensions.actionType), 4) by ParentId, Month\r\n| summarize MAU = percentile(FeatureMAU, 50) by ParentId\r\n;\r\ncustomEvents\r\n| where isnotempty(user_AuthenticatedId)\r\n| extend parentId = tostring(customDimensions.parentId)\r\n| extend pageName = tostring(customDimensions.pageName)\r\n| summarize AwareUsers=dcount(user_AuthenticatedId, 4), ActiveUsers=dcountif(user_AuthenticatedId, isnotempty(parentId), 4) by ParentId=coalesce(pageName, \"No pageName\"), Id=coalesce(parentId, \"No parentId\")\r\n| extend Name = Id\r\n| order by ParentId, AwareUsers\r\n| extend RN = row_number(1, prev(ParentId) != ParentId)\r\n| where RN < 11\r\n| join kind=inner(dailyFeatureId | project Id, ParentId, DAU) on Id, ParentId\r\n| join kind=inner(monthlyFeatureId | project Id, ParentId, MAU) on Id, ParentId\r\n| union (\r\n    customEvents\r\n    | extend parentId = tostring(customDimensions.parentId)\r\n    | extend pageName = tostring(customDimensions.pageName)\r\n    | summarize AwareUsers=dcount(user_AuthenticatedId, 4), ActiveUsers=dcountif(user_AuthenticatedId, isnotempty(parentId), 4) by ParentId='', Id=coalesce(pageName, \"No pageName\")\r\n    | extend Name=Id\r\n    | join kind=inner(dailyFeatureParentId | project ParentId, DAU) on $left.Id==$right.ParentId\r\n    | join kind=inner(monthlyFeatureParentId | project ParentId, MAU) on $left.Id==$right.ParentId\r\n)\r\n| project  Name, AwareUsers, ActiveUsers, Id, ParentId, OverallActivity = ActiveUsers * 1.0 / AwareUsers, DAU, MAU, [\"Intensity (DAU/MAU)\"]=(DAU)*1.0/(MAU)\r\n| order by AwareUsers desc",
        "size": 0,
        "title": "Users by Feature",
        "timeContext": {
          "durationMs": 7776000000
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "AwareUsers",
              "formatter": 3,
              "formatOptions": {
                "min": 0,
                "palette": "blue"
              }
            },
            {
              "columnMatch": "ActiveUsers",
              "formatter": 3,
              "formatOptions": {
                "min": 0,
                "palette": "blue"
              }
            },
            {
              "columnMatch": "Id",
              "formatter": 5
            },
            {
              "columnMatch": "ParentId",
              "formatter": 5
            },
            {
              "columnMatch": "OverallActivity",
              "formatter": 0,
              "numberFormat": {
                "unit": 0,
                "options": {
                  "style": "percent",
                  "useGrouping": false,
                  "maximumFractionDigits": 2,
                  "minimumSignificantDigits": 2
                }
              }
            },
            {
              "columnMatch": "DAU",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "10ch"
              }
            },
            {
              "columnMatch": "MAU",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "10ch"
              }
            },
            {
              "columnMatch": "Intensity (DAU/MAU)",
              "formatter": 0,
              "numberFormat": {
                "unit": 0,
                "options": {
                  "style": "percent",
                  "useGrouping": false,
                  "minimumSignificantDigits": 2,
                  "maximumSignificantDigits": 2
                }
              }
            },
            {
              "columnMatch": "Intensity",
              "formatter": 0,
              "formatOptions": {
                "customColumnWidthSetting": "13ch"
              },
              "numberFormat": {
                "unit": 0,
                "options": {
                  "style": "percent",
                  "useGrouping": false,
                  "minimumSignificantDigits": 2,
                  "maximumSignificantDigits": 2
                }
              }
            }
          ],
          "rowLimit": 100,
          "hierarchySettings": {
            "idColumn": "Id",
            "parentColumn": "ParentId",
            "treeType": 0,
            "expanderColumn": "Name",
            "expandTopLevel": true
          },
          "sortBy": [
            {
              "itemKey": "$gen_bar_AwareUsers_1",
              "sortOrder": 2
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "$gen_bar_AwareUsers_1",
            "sortOrder": 2
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Feature"
      },
      "customWidth": "100",
      "name": "Users by Feature",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "| Metric                   | Definition                                                                                                            | Question Answered                                           |\r\n|--------------------------|-----------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\r\n| Net New Users (Feature)  | Count of users who have visited the feature for the first time                                                        | How quickly is the feature gaining new users?               |\r\n| Feature Active Users     | Count of users who have performed a user-initiated action on a specific feature                                       | How many users are actively using this feature?             |\r\n| Interactions             | Median number of user-initiated actions on a specific feature over a time period                                      | How deep is the engagement for this feature?                |\r\n| Retained Users (Feature) | Count of Active Users for this feature who were also Active for this feature the previous period                      | How many users are staying engaged with this feature?       |\r\n| Retention (Feature)      | Proportion of Active Users for this feature from the previous period who are also Active for this feature this period | What percent of users are staying engaged with the feature? |"
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Feature"
      },
      "name": "Feature Metrics Defintions"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Data Dictionaries\r\nThe required attributes to calculate HEART metrics are listed below."
            },
            "name": "Data Dictionary Title"
          },
          {
            "type": 1,
            "content": {
              "json": "### customEvents\r\n| Attribute            | Description                                |\r\n|----------------------|--------------------------------------------|\r\n| user_AuthenticatedId | unique user identifier                     |\r\n| session_Id           | unique session identifier                  |\r\n| appName              | unique Application Insights app identifier |\r\n| itemType             | category of customEvents record            |\r\n| timestamp            | datetime of event                          |\r\n| operation_Id         | correlate telemetry events                 |"
            },
            "customWidth": "25",
            "name": "customEvents Data Dictionary"
          },
          {
            "type": 1,
            "content": {
              "json": "### pageViews\r\n| Attribute            | Description                                |\r\n|----------------------|--------------------------------------------|\r\n| user_AuthenticatedId | unique user identifier                     |\r\n| session_Id           | unique session identifier                  |\r\n| appName              | unique Application Insights app identifier |\r\n| itemType             | category of customEvents record            |\r\n| timestamp            | datetime of event                          |\r\n| operation_Id         | correlate telemetry events                 |"
            },
            "customWidth": "25",
            "name": "pageViews Data Dictionary"
          },
          {
            "type": 1,
            "content": {
              "json": "### Click Analytics\r\n| Attribute  | Description                        |\r\n|------------|------------------------------------|\r\n| parentId   | name of feature                    |\r\n| pageName   | name of page                       |\r\n| actionType | category of Click Analytics record |"
            },
            "customWidth": "25",
            "name": "Click Analytics Data Dictionary"
          },
          {
            "type": 1,
            "content": {
              "json": "### Telemetry Warnings\r\nCommon data discrepancies, along with their suggestion resolutions, are listed below."
            },
            "name": "Telemetry Warnings Title"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let WarningCodes = datatable (Code:long, Warning:string, Resolution:string)\r\n    [0, \"No Warning\", \"None\",\r\n     1, \"⚠️ No user rows found in selected time period.\", \"Ensure telemetry is authenticating users in the selected time period.\",\r\n     2, \"⚠️ Multiple users found in the same session.\", \"Check if telemetry is creating sessions without authenticating users.\",\r\n     3, \"️️️⚠️ Row(s) with actionType value but no user_AuthenticatedId\", \"Check if telemetry is creating sessions without authenticating users.\",\r\n     4, \"⚠️ Row(s) with user_AuthenticatedId but no actionType value.\", \"Visit the Click Analytics documentation for more information about its implementation.\",\r\n     5, \"⚠️ Users with actionType items but no pageView items\", \"Implement pageViews and Click Analytics on the same pages of the experience.\"]\r\n;\r\nlet Code1Check = customEvents\r\n| summarize Occurrences=countif(isnotempty(user_AuthenticatedId)), Total=count()\r\n| project Code = case(Occurrences == 0, 1, 0), Occurrences, Total\r\n;\r\nlet Code2Check = customEvents\r\n| summarize UserCount=dcount(user_AuthenticatedId, 4) by session_Id\r\n| summarize Occurrences=countif(UserCount > 1), Total=count()\r\n| project Code = case(Occurrences > 0, 2, 0), Occurrences, Total\r\n;\r\nlet Code3Check = customEvents\r\n| summarize Occurrences=countif(isnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)), Total=count()\r\n| project Code = case(Occurrences > 0, 3, 0), Occurrences, Total\r\n;\r\nlet Code4Check = customEvents\r\n| summarize Occurrences=countif(isnotnull(customDimensions.actionType) and isempty(user_AuthenticatedId)), Total=count()\r\n| project Code = case(Occurrences > 0, 4, 0), Occurrences, Total\r\n;\r\nlet Code5Check = customEvents\r\n| where isnotnull(customDimensions.actionType) and isnotempty(user_AuthenticatedId)\r\n| join kind = leftanti (pageViews | where itemType == \"pageView\" and isnotempty(user_AuthenticatedId) | distinct user_AuthenticatedId) \r\non user_AuthenticatedId\r\n| summarize Occurrences = dcount(user_AuthenticatedId, 4), One=1\r\n| join kind=inner (customEvents| union pageViews| summarize Total=dcount(user_AuthenticatedId), One=1)\r\non One\r\n| project Code = case(Occurrences > 0, 5, 0), Occurrences, Total\r\n;\r\nCode1Check\r\n| union Code2Check\r\n| union Code3Check\r\n| union Code4Check\r\n| union Code5Check\r\n| join (WarningCodes) on Code\r\n| where Code > 0\r\n| project Warning, Occurrences, Pct = Occurrences*1.0 / Total, [\"Suggested Resolution\"] = Resolution\r\n| order by Pct desc\r\n\r\n",
              "size": 1,
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Warning",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "60ch"
                    }
                  },
                  {
                    "columnMatch": "Pct",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "10ch"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "percent",
                        "useGrouping": false,
                        "minimumSignificantDigits": 3,
                        "maximumSignificantDigits": 3
                      }
                    }
                  },
                  {
                    "columnMatch": "Suggested Resolution",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "118ch"
                    }
                  }
                ]
              }
            },
            "customWidth": "100",
            "name": "Telemetry Warnings"
          },
          {
            "type": 1,
            "content": {
              "json": "### Data Validation\r\nThe HEART Framework uses the [Click Analytics plugin for Application Insights](https://docs.microsoft.com/en-us/azure/azure-monitor/app/javascript-click-analytics-plugin). The Attribute Completion grids below display the Completion % of the required attributes for the HEART Framework. Note that **these grids only consider records with a non-empty user_AuthenticatedId** to disregard any user-initited back-end events.\r\n#### How do I interpret Completion? Is 100% necessary to calculate HEART Metrics? \r\nCompletion represents the proportion of records with a value. For example, a Completion of 25% for parentId means that 75% of records have no value. For the most informed product decisions, Completion above 90% is recommended for each required attribute. HEART Metrics can still be calculated with lower Completion; however, lower Completion could result in HEART Metrics calculated on an unrepresentative dataset."
            },
            "name": "Technical Requirements Text"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let tablePack = customEvents \r\n| where isnotempty(user_AuthenticatedId)\r\n| project array = pack_array(*), Dummy = 1\r\n;\r\ncustomEvents\r\n| getschema \r\n| project ColumnName, ColumnOrdinal, Dummy = 1\r\n| join kind = inner (tablePack) on Dummy\r\n| project ColumnName, value = tostring(array[ColumnOrdinal])\r\n| summarize Complete=countif(value !in (\"\", \"not_specified\")), Rows=count() by ColumnName\r\n| extend Completion = Complete * 1.0 / Rows\r\n| project Status=case(Completion >= 0.90, '✔️ Good', '⚠️ Low Completion'), Attribute=ColumnName, Completion=coalesce(case(isnan(Completion), 0.0, Completion ), 0.0), Complete, Rows\r\n| order by Attribute asc\r\n| where Attribute in (\"user_AuthenticatedId\", \"session_Id\", \"appName\", \"itemType\", \"timestamp\", \"operation_Id\")\r\n",
              "size": 1,
              "title": "customEvents Attribute Completion",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ColumnName",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "26ch"
                    }
                  },
                  {
                    "columnMatch": "Completion",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "max": 1,
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "percent",
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 2
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "customEvents Attribute Completion"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let tablePack = pageViews \r\n| where isnotempty(user_AuthenticatedId)\r\n| project array = pack_array(*), Dummy = 1\r\n;\r\npageViews\r\n| getschema \r\n| project ColumnName, ColumnOrdinal, Dummy = 1\r\n| join kind = inner (tablePack) on Dummy\r\n| project ColumnName, value = tostring(array[ColumnOrdinal])\r\n| summarize Complete=countif(value !in (\"\", \"not_specified\")), Rows=count() by ColumnName\r\n| extend Completion = Complete * 1.0 / Rows\r\n| project Status=case(Completion >= 0.90, '✔️ Good', '⚠️ Low Completion'), Attribute=ColumnName, Completion=coalesce(case(isnan(Completion), 0.0, Completion ), 0.0), Complete, Rows\r\n| order by Completion asc\r\n| where Attribute in (\"user_AuthenticatedId\", \"session_Id\", \"appName\", \"itemType\", \"timestamp\", \"operation_Id\")\r\n",
              "size": 1,
              "title": "pageViews Attribute Completion",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ColumnName",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "26ch"
                    }
                  },
                  {
                    "columnMatch": "Completion",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "max": 1,
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "percent",
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 2
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "pageViews Attribute Completion"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let UnpackCD = customEvents\r\n| where isnotempty(user_AuthenticatedId)\r\n| project customDimensions\r\n| evaluate bag_unpack(customDimensions)\r\n;\r\nUnpackCD\r\n| getschema \r\n| project ColumnName, ColumnOrdinal, Dummy = 1\r\n| join kind = inner (UnpackCD | project array = pack_array(*), Dummy = 1) on Dummy\r\n| project ColumnName, value = tostring(array[ColumnOrdinal])\r\n| summarize Complete=countif(value !in (\"\", \"not_specified\")), Rows=count() by ColumnName\r\n| extend Completion = Complete * 1.0 / Rows\r\n| project Status=case(Completion >= 0.90, '✔️ Good', '⚠️ Low Completion'), ColumnName, Completion=coalesce(case(isnan(Completion), 0.0, Completion ), 0.0), Complete, Rows\r\n| order by Completion asc\r\n| where ColumnName in (\"parentId\", \"pageName\", \"actionType\")",
              "size": 1,
              "title": "ClickAnalytics Attribute Completion",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "ColumnName",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "26ch"
                    }
                  },
                  {
                    "columnMatch": "Completion",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "max": 1,
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "percent",
                        "minimumSignificantDigits": 2,
                        "maximumSignificantDigits": 2
                      }
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "ClickAnalytics Attribute Completion"
          },
          {
            "type": 1,
            "content": {
              "json": "### Data Retention\r\nLearn more about data retention in the [Application Insights documentation](https://docs.microsoft.com/en-us/azure/azure-monitor/app/pricing#change-the-data-retention-period). For the most informed product decisions, at least 13 months of data is recommended to consider seasonality and year-over-year growth. "
            },
            "name": "Data Retention"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "customEvents\r\n| summarize [\"First Record\"]=min(timestamp), [\"Most Recent Record\"]=max(timestamp) by appName\r\n| order by [\"Most Recent Record\"] desc",
              "size": 4,
              "queryType": 0,
              "resourceType": "microsoft.insights/components"
            },
            "name": "Records"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "Technical"
      },
      "name": "Technical Validation"
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/96eced6b-b9cc-4575-99ad-ff12cf25085a/resourceGroups/HEART-Scorecard-NonProd/providers/microsoft.insights/components/HeartAppInsightsDemoInstance"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}

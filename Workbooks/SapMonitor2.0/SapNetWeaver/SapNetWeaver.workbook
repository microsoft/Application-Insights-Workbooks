{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "2c886879-e271-4da3-801c-c932bc075074",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_table_exists",
            "type": 1,
            "query": "let checktable = (tb: string) {\r\n    // 0 = no error\r\n    // 1 = table does not exist (need to enable RFC)\r\n    // 2 = table exists, but column v1 does not (or) column v1 exists but no data in the table (need to wait)\r\n    let c1 = \"SID_s\";\r\n    let dummy = \"unmÃ¶glicher-wert!\";\r\n    let MissingTable = view () { print miss = 1, columnV1 = dummy, records = -1 };\r\n    let checkRecords =\r\n        union\r\n            isfuzzy=true\r\n            MissingTable,\r\n            (table(tb)\r\n            | take 1\r\n            | summarize records = count()\r\n            )\r\n        | project records\r\n        | top 1 by records desc\r\n    ;\r\n    let checkTableExists =\r\n        union\r\n            isfuzzy=true\r\n            MissingTable,\r\n            (table(tb)\r\n            | take 1\r\n            | count\r\n            | extend miss = 0\r\n            )\r\n        | project miss\r\n        | limit 2\r\n        | top 1 by miss asc\r\n    ;\r\n    let checkColumnExists =\r\n        union\r\n            isfuzzy=true\r\n            MissingTable,\r\n            (table(tb)\r\n            | take 1\r\n            | extend miss = 0\r\n            | extend columnV1 = column_ifexists(c1, dummy)\r\n            )\r\n        | project miss, columnV1\r\n        | limit 2\r\n        | top 1 by miss asc\r\n    ;\r\n    let tableExists = toscalar(checkTableExists\r\n        | summarize max(miss) != 1);\r\n    let columnV1Exists = toscalar(checkColumnExists\r\n        | summarize max(columnV1) != dummy);\r\n    let tableRecords = toscalar(checkRecords\r\n        | summarize max(records));\r\n    let x = iif(tableExists, iif(columnV1Exists, iif(tableRecords > 0, \"0\", \"2\"), \"2\"), \"1\");\r\n    toscalar(x)\r\n};\r\nlet system = checktable('SapNetweaver_GetSystemInstanceList_CL');\r\nlet enqueue = checktable('SapNetweaver_EnqGetStatistic_CL');\r\nlet queue = checktable('SapNetweaver_GetQueueStatistic_CL');\r\nlet process = checktable('SapNetweaver_GetProcessList_CL');\r\nlet abap = checktable('SapNetweaver_ABAPGetWPTable_CL');\r\nlet swnc = checktable('SapNetweaver_SWNC_CL');\r\nlet sdump = checktable('SapNetweaver_ShortDumps_CL');\r\nlet smon = checktable('SapNetweaver_SMON_CL');\r\n//rfc v1.3 tables\r\nlet enqread = checktable('SapNetweaver_EnqueueRead_CL');\r\nlet inboundq = checktable('SapNetweaver_InboundQueues_CL');\r\nlet outboundq = checktable('SapNetweaver_OutboundQueues_CL');\r\nlet batchjob = checktable('SapNetweaver_BatchJobs_CL');\r\nlet failedupdate = checktable('SapNetweaver_FailedUpdates_CL');\r\nlet syslog = checktable('SapNetweaver_SysLogs_CL');\r\n//aiops tables\r\nlet hostmapping = checktable('SapNetweaver_SAP_Host_AzRId_Mapping_CL');\r\nlet rhevents = checktable('AIOps_GetRHEvents_CL');\r\n//rfc v1.5 tables\r\nlet swncuser = checktable('SapNetweaver_SWNC_User_CL');\r\nlet swncmemory = checktable('SapNetweaver_SWNC_Memory_CL');\r\nlet swncrfc = checktable('SapNetweaver_SWNC_RFC_Usage_CL');\r\nlet swnctransaction = checktable('SapNetweaver_SWNC_Transaction_CL');\r\nlet stms = checktable('SapNetweaver_STMS_CL');\r\nlet trfc = checktable('SapNetweaver_TransactionalRfc_CL');\r\nlet stmsobject = checktable('SapNetweaver_STMS_ObjectEntries_CL');\r\n\r\nlet T = datatable(tablename:string, id:string)\r\n[\r\n'SapNetweaver_SMON_CL', '',\r\n];\r\nT\r\n|project tablename\r\n| extend new_col = strcat('SapNetweaver_SMON_CL:',smon,\r\n',SapNetweaver_ShortDumps_CL:',sdump,\r\n',SapNetweaver_SWNC_CL:',swnc,\r\n',SapNetweaver_GetSystemInstanceList_CL:',system,',SapNetweaver_GetQueueStatistic_CL:',queue,\r\n',SapNetweaver_EnqGetStatistic_CL:',enqueue,\r\n',SapNetweaver_GetProcessList_CL:',process,\r\n',SapNetweaver_ABAPGetWPTable_CL:',abap,\r\n',SapNetweaver_EnqueueRead_CL:',enqread,\r\n',SapNetweaver_InboundQueues_CL:',inboundq,\r\n',SapNetweaver_OutboundQueues_CL:',outboundq,\r\n',SapNetweaver_BatchJobs_CL:',batchjob,\r\n',SapNetweaver_FailedUpdates_CL:',failedupdate,\r\n',SapNetweaver_SysLogs_CL:',syslog,\r\n',SapNetweaver_SAP_Host_AzRId_Mapping_CL:',hostmapping,\r\n',AIOps_GetRHEvents_CL:',rhevents,\r\n',SapNetweaver_SWNC_User_CL:',swncuser,\r\n',SapNetweaver_SWNC_Memory_CL:',swncmemory,\r\n',SapNetweaver_SWNC_RFC_Usage_CL:',swncrfc,\r\n',SapNetweaver_SWNC_Transaction_CL:',swnctransaction,\r\n',SapNetweaver_STMS_CL:',stms,\r\n',SapNetweaver_TransactionalRfc_CL:',trfc,\r\n'SapNetweaver_STMS_ObjectEntries_CL:',stmsobject)\r\n|project-away tablename",
            "timeContext": {
              "durationMs": 604800000
            },
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "aa8ab18f-5d36-4f34-8a54-f0f2e25ecbb8",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_error",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetSystemInstanceList_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetSystemInstanceList_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "225baab0-e4ce-4a45-92de-ddda00795a2d",
            "version": "KqlParameterItem/1.0",
            "name": "param_ams_resource",
            "type": 5,
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.workloads/monitors": true
              },
              "additionalResourceOptions": [
                "value::1"
              ],
              "showDefault": false
            },
            "defaultValue": "value::1"
          },
          {
            "id": "92bd4772-a480-4a10-a48d-fecfd54bb22f",
            "version": "KqlParameterItem/1.0",
            "name": "param_providers_list",
            "type": 1,
            "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"{param_ams_resource}/providerInstances/\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2023-04-01\"},{\"key\":\"pageLimit\",\"value\":\"1000\"}],\"batchDisabled\":false,\"transformers\":null}",
            "queryType": 12
          },
          {
            "id": "a00ff9e0-9235-4aa2-b617-933d7977bdb6",
            "version": "KqlParameterItem/1.0",
            "name": "param_provider_type",
            "type": 1,
            "value": "SapNetWeaver",
            "isHiddenWhenLocked": true
          },
          {
            "id": "979c1ab9-90e4-4b19-9c58-7c1f96c38754",
            "version": "KqlParameterItem/1.0",
            "name": "param_alert_templates",
            "type": 1,
            "value": "[\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver System Availability\",\r\n        \"description\": \"Fired when SAP NetWeaver Message Server is not available or all servers are not available.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-system-availability\",\r\n        \"severity\": \"1\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"let TotalInstanceAvailability = SapNetweaver_GetSystemInstanceList_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | extend Status = iff(dispstatus_s == 'SAPControl-GREEN', 1, 0) | summarize available=countif(Status == 1), total=count() by PROVIDER_INSTANCE_s, serverTimestamp_t;TotalInstanceAvailability | join kind = leftouter SapNetweaver_GetSystemInstanceList_CL on $left.PROVIDER_INSTANCE_s == $right.PROVIDER_INSTANCE_s and $left.serverTimestamp_t == $right.serverTimestamp_t | extend Status = iff(dispstatus_s == 'SAPControl-GREEN', 1, 0) | extend ServiceStatus = iff(available == 0, 0, iff(features_s contains 'MESSAGESERVER' and Status == 0, 0, 1)), AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | summarize AggregatedValue = min(ServiceStatus) by bin(TimeGenerated, 1m), PROVIDER_INSTANCE_s, AppServer, dispstatus_s, serverTimestamp_t, features_s | where AggregatedValue == 0\",\r\n            \"thresholdOperator\": \"LessThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"1\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"PROVIDER_INSTANCE_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver Instance Availability\",\r\n        \"description\": \"Fired when SAP Netweaver ABAP, J2EE, JEE instances are not available.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-instance-availability\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"let TotalInstanceAvailability = SapNetweaver_GetSystemInstanceList_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | extend Status = iff(dispstatus_s == 'SAPControl-GREEN', 1, 0) | summarize available=countif(Status == 1), total=count() by PROVIDER_INSTANCE_s, serverTimestamp_t; TotalInstanceAvailability | join kind = leftouter SapNetweaver_GetSystemInstanceList_CL on $left.PROVIDER_INSTANCE_s == $right.PROVIDER_INSTANCE_s and $left.serverTimestamp_t == $right.serverTimestamp_t | where features_s contains 'J2EE' or features_s contains 'JEE' or features_s contains 'ABAP' | extend InstanceStatus = iff(available != 0 and dispstatus_s == 'SAPControl-GREEN', 1, 0), AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | summarize AggregatedValue = min(InstanceStatus) by bin(TimeGenerated, 1m), PROVIDER_INSTANCE_s, AppServer, dispstatus_s, serverTimestamp_t, features_s | where AggregatedValue == 0\",\r\n            \"thresholdOperator\": \"LessThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"1\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"PROVIDER_INSTANCE_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver EnqueueServer Availability\",\r\n        \"description\": \"Fired when SAP Netweaver EnqueueServer is not available.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-enqueue-server\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_GetProcessList_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' and description_s contains 'EnqueueServer' | extend Status = iff(dispstatus_s == 'SAPControl-GREEN', 1, 0), AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | summarize AggregatedValue = min(Status) by bin(TimeGenerated, 1m), PROVIDER_INSTANCE_s, AppServer, dispstatus_s, description_s, serverTimestamp_t | where AggregatedValue == 0\",\r\n            \"thresholdOperator\": \"LessThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"1\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"PROVIDER_INSTANCE_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver EnqueueReplicationServer Availability\",\r\n        \"description\": \"Fired when SAP Netweaver EnqueueReplicationServer is not available.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-enqueue-replicator-server\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_GetProcessList_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' and description_s contains 'EnqueueReplicator' | extend Status = iff(dispstatus_s == 'SAPControl-GREEN', 1, 0), AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | summarize AggregatedValue = min(Status) by bin(TimeGenerated, 1m), PROVIDER_INSTANCE_s, AppServer, dispstatus_s, description_s, serverTimestamp_t | where AggregatedValue == 0\",\r\n            \"thresholdOperator\": \"LessThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"1\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"PROVIDER_INSTANCE_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver Instance Work Process Utilization\",\r\n        \"description\": \"Fired when SAP Netweaver Instance with DIA or BTC Usage breaches specified threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-instance-work-process-utilization\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_ABAPGetWPTable_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where Typ_s has '{Aggregate}' | summarize totalWP = count(), freeWP = countif(Status_s == 'Wait') by TimeGenerated, Typ_s, serverTimestamp_t, AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | extend UtilizationPctWP = round(toreal(totalWP - freeWP) / toreal(totalWP) * 100, 3) | summarize AggregatedValue = max(UtilizationPctWP) by bin(TimeGenerated, 1m), AppServer, Typ_s, serverTimestamp_t | where AggregatedValue > {AlertThreshold}\",\r\n            \"aggregateName\": \"WorkType\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_ABAPGetWPTable_CL | where Typ_s has 'DIA' or Typ_s has 'BTC' | distinct Typ_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"70\",\r\n            \"alertUnit\": \"percent\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"2\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"AppServer\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SOAP] SAP Netweaver Instance Queue Wait\",\r\n        \"description\": \"Fired when SAP Netweaver Instance with DIA or BTC Queue Wait breaches specified threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-instance-queue-wait\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_GetQueueStatistic_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where Typ_s has '{Aggregate}' | summarize QueueLimit=max(Max_d)/7 by hostname_s, instanceNr_d, Typ_s, serverTimestamp_t, Now_d, TimeGenerated | extend QueueWaitPct = iff(QueueLimit != 0, (toreal(Now_d) / toreal(QueueLimit)) * 100, 0.0), AppServer = strcat(hostname_s, '_', tostring(toint(instanceNr_d))) | summarize AggregatedValue = max(QueueWaitPct) by bin(TimeGenerated, 1m), AppServer, Typ_s, serverTimestamp_t | where AggregatedValue > {AlertThreshold}\",\r\n            \"aggregateName\": \"WorkType\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_GetQueueStatistic_CL | where Typ_s has 'DIA' or Typ_s has 'BTC' | distinct Typ_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"5\",\r\n            \"alertUnit\": \"percent\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"2\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"AppServer\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SMON] SAP Netweaver Memory Utilization\",\r\n        \"description\": \"Fired when the memory utilization reaches a threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-memory-utilization\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SMON_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | summarize AggregatedValue = avg(FREE_MEM_PERC_d) by hostname_s, bin(TimeGenerated, 1m) | where AggregatedValue < {AlertThreshold}\",\r\n            \"thresholdOperator\": \"LessThan\",\r\n            \"defaultThreshold\": \"20\",\r\n            \"alertUnit\": \"percent\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"hostname_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SMON] SAP Netweaver CPU System Utilization\",\r\n        \"description\": \"Fired when CPU system utilization reaches a threshold value.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-cpu-system-utilization\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SMON_CL| where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where hostname_s has '{Aggregate}' | extend TOTAL_CPU = (100 - IDLE_TOTAL_d)| summarize AggregatedValue = avg(TOTAL_CPU) by bin(TimeGenerated, 30m),SYS_TOTAL_d, hostname_s | where AggregatedValue > {AlertThreshold} \",\r\n            \"aggregateName\": \"SystemCPUUtilization\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_SMON_CL| where isnotempty(hostname_s)| distinct hostname_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"severity\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"hostname_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SMON] SAP Netweaver CPU User Utilization\",\r\n        \"description\": \"Fired when CPU user utilization reaches a threshold value.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-cpu-user-utilization\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SMON_CL| where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where hostname_s has '{Aggregate}' | extend TOTAL_CPU = (100 - IDLE_TOTAL_d)| summarize AggregatedValue = avg(TOTAL_CPU) by bin(TimeGenerated, 30m),USR_TOTAL_d, hostname_s | where AggregatedValue > {AlertThreshold} \",\r\n            \"aggregateName\": \"UserCPUUtilization\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_SMON_CL| where isnotempty(hostname_s)| distinct hostname_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"severity\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"hostname_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SMQ1] SAP Netweaver Outbound Queue length more than threshold\",\r\n        \"description\": \"Fired when a desired outbound queue is active and length is greater than equal to the threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-outbound-queue-length\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_OutboundQueues_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where QNAME_s has '{Aggregate}' | summarize AggregatedValue  = max(QDEEP_d) by QNAME_s, bin(TimeGenerated, 1m) | where AggregatedValue > {AlertThreshold}\",\r\n            \"aggregateName\": \"QNAME\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_OutboundQueues_CL | distinct QNAME_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"5\",\r\n            \"alertUnit\": \"count\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"2\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"QDEEP_d\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SMQ2] SAP Netweaver Inbound Queue length more than threshold\",\r\n        \"description\": \"Fired when a desired inbound queue is active and length is greater than equal to the threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-inbound-queue-length\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_InboundQueues_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where QNAME_s has '{Aggregate}' | summarize AggregatedValue  = max(QDEEP_d) by QNAME_s, bin(TimeGenerated, 1m) | where AggregatedValue > {AlertThreshold}\",\r\n            \"aggregateName\": \"QNAME\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_InboundQueues_CL | distinct QNAME_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"5\",\r\n            \"alertUnit\": \"count\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"2\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"QDEEP_d\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM12] SAP Netweaver Enqueue Entry Volume\",\r\n        \"description\": \"Fired when count of enqueue entries are more than the threshold value.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-enqueue-read-volume\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_EnqueueRead_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | summarize AggregatedValue = dcount(GARG_s) by GNAME_s, bin(TimeGenerated, 1m) | where AggregatedValue > {AlertThreshold}\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"5\",\r\n            \"alertUnit\": \"count\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"2\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"GNAME_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM12] SAP Netweaver Aging Enqueue Entries\",\r\n        \"description\": \"Fired when a to enqueue entries are active for more than 1 day.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-enqueue-read-aging\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"let base = SapNetweaver_EnqueueRead_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where bin(now() - 1d, 1d) == bin(serverTimestamp_t, 1d) | summarize by GNAME_s, GARG_s, GTWP_s, bin(TimeGenerated, 1d); SapNetweaver_EnqueueRead_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where bin(now() - 60min, 1h) == bin(serverTimestamp_t, 1h) | join kind = inner base on GNAME_s | summarize by GNAME_s, GARG_s, GTWP_s, bin(TimeGenerated, 1d) | summarize AggregatedValue = count() by GNAME_s, bin(TimeGenerated, 1d) | where AggregatedValue > {AlertThreshold}\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"GNAME_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"2880\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM13] SAP Netweaver Failed Updates\",\r\n        \"description\": \"Fired when SAP Netweaver Instance has any type of failed updates.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-instance-failed-update-any\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_FailedUpdates_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | summarize AggregatedValue = count() by VBKEY_g, VBTCODE_s, VBREPORT_s, bin(TimeGenerated, 5m) | where AggregatedValue > {AlertThreshold}\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"1\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"VBKEY_g\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[ST22] SAP Netweaver Short Dump\",\r\n        \"description\": \"Fired when SAP Netweaver Instance raises any type of short dump\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-instance-short-dump_any\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_ShortDumps_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | summarize AggregatedValue = count() by Runtime_Error_s, bin(TimeGenerated, 5m) | where AggregatedValue > {AlertThreshold}\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"2\",\r\n            \"alertUnit\": \"count\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"Runtime_Error_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"10\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM21] SAP Netweaver Alert for a Specific Message ID And Severity Error\",\r\n        \"description\": \"Fired when a desired inbound queue is active and length is greater than equal to the threshold.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-system-log-by-message-id\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SysLogs_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where Msg_area_Msd_Id_s has '{Aggregate}' | where toint(E2E_SEVERITY_s) > {AlertThreshold} | extend datevalue = format_datetime(serverTimestamp_t, 'dd-MM-yy') | extend timevalue = format_datetime(serverTimestamp_t, 'HH:mm:ss') | summarize AggregatedValue = count() by Msg_area_Msd_Id_s, instanceNr_s, Problem_Class_s, Application_Comp_s, Program_s, bin(TimeGenerated, 1h) | where AggregatedValue  > 0\",\r\n            \"aggregateName\": \"MessageID\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_SysLogs_CL | distinct Msg_area_Msd_Id_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"severity\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"Msg_area_Msd_Id_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"1440\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM21] SAP Netweaver Alert for a Specific User And Severity Error\",\r\n        \"description\": \"Fired when a system log with severity is raised for a specific user.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-system-log-by-user\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SysLogs_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | where E2E_USER_s has '{Aggregate}' | where toint(E2E_SEVERITY_s) > {AlertThreshold} | extend datevalue = format_datetime(serverTimestamp_t, 'dd-MM-yy') | extend timevalue = format_datetime(serverTimestamp_t, 'HH:mm:ss') | summarize AggregatedValue = count() by E2E_USER_s, instanceNr_s, Problem_Class_s, Application_Comp_s, Program_s, bin(TimeGenerated, 1h) | where AggregatedValue  > 0\",\r\n            \"aggregateName\": \"UserID\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_SysLogs_CL | distinct E2E_USER_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"severity\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"E2E_USER_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"1440\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[SM37] SAP Netweaver Long Running Job\",\r\n        \"description\": \"Fired when a job takes more than the threshold value.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-batch-job-jobname\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_BatchJobs_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | extend startdatetime = todatetime(strcat(STRTDATE_s,STRTTIME_s))| extend enddatetime = todatetime(strcat(ENDDATE_s,ENDTIME_s))| extend runtime = enddatetime - startdatetime| extend min = runtime / 1s | summarize AggregatedValue = countif(min > 600) by JOBNAME_s, bin(TimeGenerated, 1m) | where AggregatedValue > {AlertThreshold} \",\r\n            \"aggregateName\": \"JobName\",\r\n            \"aggregateDropDownQuery\": \"SapNetweaver_BatchJobs_CL | where isnotempty(JOBNAME_s )| distinct JOBNAME_s\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"severity\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"JOBNAME_s\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"5\"\r\n            }\r\n        }\r\n    },\r\n    {\r\n        \"name\": \"[ST03] SAP Netweaver High Response Time\",\r\n        \"description\": \"Fired when the average response time reaches or exceeds the configured threshold value.\",\r\n        \"author\": \"Microsoft\",\r\n        \"templateId\": \"sapnetweaver-response-time\",\r\n        \"severity\": \"2\",\r\n        \"alertTemplate\": {\r\n            \"query\": \"SapNetweaver_SWNC_CL | where PROVIDER_INSTANCE_s == '{ProviderInstance}' | summarize AggregatedValue = avg(ST03_Avg_Resp_Time_d) by bin(TimeGenerated, 30m) | where AggregatedValue > {AlertThreshold} \",\r\n            \"aggregateName\": \"\",\r\n            \"aggregateDropDownQuery\": \"\",\r\n            \"thresholdOperator\": \"GreaterThan\",\r\n            \"defaultThreshold\": \"0\",\r\n            \"alertUnit\": \"milliseconds\",\r\n            \"metricMeasurement\": {\r\n                \"thresholdOperator\": \"GreaterThan\",\r\n                \"threshold\": \"0\",\r\n                \"metricTriggerType\": \"Consecutive\",\r\n                \"metricColumn\": \"\",\r\n                \"frequencyInMinutes\": \"5\",\r\n                \"timeWindowInMinutes\": \"30\"\r\n            }\r\n        }\r\n    }\r\n]\r\n",
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "multiLineText": true,
              "editorLanguage": "text",
              "multiLineHeight": 10
            }
          },
          {
            "id": "e856ad78-557b-4ba1-898e-81ad94d86abb",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_aiops",
            "type": 1,
            "description": "Parameter to check if AIOps is enabled",
            "query": "let tableList = '{param_check_table_exists}';\r\nlet tableListValue = iff (((tableList) contains 'AIOps_GetRHEvents_CL:0') or \r\n                           ((tableList) contains 'SapNetweaver_SAP_Host_AzRId_Mapping_CL:0'), \"0\", \"1\");\r\nprint toscalar(tableListValue)",
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "750a19d9-5cf6-49bc-902f-c40e3d8411d1",
            "version": "KqlParameterItem/1.0",
            "name": "param_availability_timerange",
            "type": 4,
            "value": {
              "durationMs": 1800000
            },
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 1800000
                }
              ],
              "allowCustom": false
            }
          },
          {
            "id": "90bcea9a-3fcb-4f45-b88c-98782c711569",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_rfc_metrics",
            "type": 1,
            "query": "let tableList = '{param_check_table_exists}';\nlet tableListValue = iff (((tableList) contains 'SapNetweaver_Short_Dumps_CL:0') or \n                           ((tableList) contains 'SapNetweaver_SMON_CL:0') or \n                           ((tableList) contains 'SapNetweaver_SWNC_CL:0') or\n                           ((tableList) contains 'SapNetweaver_EnqueueRead_CL:0') or\n                           ((tableList) contains 'SapNetweaver_BatchJobs_CL:0') or\n                           ((tableList) contains 'SapNetweaver_FailedUpdates_CL:0') or\n                           ((tableList) contains 'SapNetweaver_SysLogs_CL:0') or\n                           ((tableList) contains 'SapNetweaver_InboundQueues_CL:0') or\n                           ((tableList) contains 'SapNetweaver_OutboundQueues_CL:0'), \"0\", \"1\");\nprint toscalar(tableListValue)",
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "dummy_neverset",
        "comparison": "isNotEqualTo"
      },
      "name": "overview_section_params"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "09b7cbce-8782-46bf-b1af-02ebf80071b1",
                  "version": "KqlParameterItem/1.0",
                  "name": "param_check_provider_error",
                  "type": 1,
                  "query": "print allProviders=parse_json(tostring(\"{param_providers_list:escapejson}\")).value\r\n| mv-expand allProviders\r\n| extend type = parse_json(allProviders.properties).providerSettings.providerType\r\n| extend state = parse_json(allProviders.properties).provisioningState\r\n| where type == \"SapNetWeaver\"\r\n| where state != \"Failed\"\r\n| summarize iff(count() > 0,count(), -1)",
                  "isHiddenWhenLocked": true,
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "queryType": 0,
                  "resourceType": "microsoft.workloads/monitors"
                },
                {
                  "id": "45e53dae-8a94-4d74-ad48-9a58b658afd0",
                  "version": "KqlParameterItem/1.0",
                  "name": "netWeaverProviderExist",
                  "type": 1,
                  "isHiddenWhenLocked": true,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "param_providers_list",
                        "operator": "is Empty",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    },
                    {
                      "criteriaContext": {
                        "leftOperand": "param_check_provider_error",
                        "operator": "==",
                        "rightValType": "static",
                        "rightVal": "-1",
                        "resultValType": "static",
                        "resultVal": "false"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    }
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "ProviderParameter"
          },
          {
            "type": 1,
            "content": {
              "json": "The workbook is loading. This can take up to 2 minutes.",
              "style": "info"
            },
            "conditionalVisibility": {
              "parameterName": "netWeaverProviderExist",
              "comparison": "isEqualTo",
              "value": ""
            },
            "name": "WorkbookLoadingMsg"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "### No active SAP Netweaver provider found.\r\nCreate one or more SAP Netweaver providers to get started. [Learn More](https://learn.microsoft.com/en-us/azure/sap/monitor/provider-netweaver)",
                    "style": "warning"
                  },
                  "name": "text - 0"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "list",
                    "links": [
                      {
                        "id": "17108865-b53f-48c3-830e-58f5a6510e4a",
                        "cellValue": "{param_ams_resource}",
                        "linkTarget": "Resource",
                        "linkLabel": "Create Provider",
                        "subTarget": "monitor_provider",
                        "preText": "",
                        "style": "primary",
                        "bladeOpenContext": {
                          "bladeName": "ManageProviderv2.ReactView",
                          "extensionName": "Microsoft_Azure_WorkloadMonitor",
                          "bladeParameters": [
                            {
                              "name": "resourceId",
                              "source": "parameter",
                              "value": "param_ams_resource"
                            }
                          ]
                        }
                      }
                    ]
                  },
                  "name": "links - 1"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "netWeaverProviderExist",
              "comparison": "isEqualTo",
              "value": "false"
            },
            "name": "No active provider warning"
          },
          {
            "type": 1,
            "content": {
              "json": "If the provider is recently added, it may take up to 15 minutes for the initial telemetry information to be available for review. Else, check if system is down, or health of AMS system is degraded.",
              "style": "warning"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "netWeaverProviderExist",
                "comparison": "isEqualTo",
                "value": "true"
              },
              {
                "parameterName": "param_check_error",
                "comparison": "isNotEqualTo",
                "value": "0"
              }
            ],
            "name": "ingestionerror"
          },
          {
            "type": 1,
            "content": {
              "json": "There was an error while adding the SAP NetWeaver provider. Please reach out to support for further assistance.",
              "style": "warning"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "param_check_error",
                "comparison": "isEqualTo",
                "value": "0"
              },
              {
                "parameterName": "param_check_provider_error",
                "comparison": "isEqualTo",
                "value": "-1"
              }
            ],
            "name": "ProviderFailure"
          }
        ]
      },
      "name": "overview_group_error"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "1f9002cb-36a6-4dff-8ade-a86b9394a3ff",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_queuestatistics",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetQueueStatistic_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetQueueStatistic_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "2b9aff63-5047-4c0f-bd8b-612790daf309",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_enqgetstatistics",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_EnqGetStatistic_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_EnqGetStatistic_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "a134306b-a79f-4df5-ba11-940c1f56d836",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_abapwp",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_ABAPGetWPTable_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_ABAPGetWPTable_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "87833d8d-b023-4ccc-95af-8ab1d11223f7",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_systeminstancelist",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetSystemInstanceList_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetSystemInstanceList_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "c5b1e8a0-0321-4058-9f9f-73c24177e5d4",
            "version": "KqlParameterItem/1.0",
            "name": "pram_check_processlist",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetProcessList_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_GetProcessList_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "a4281d63-4bdb-48f3-8b91-8bffc69c2701",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_swnc",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "cc0d1c26-c8c2-4d38-aa91-aac907ce4d4e",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_smon",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SMON_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SMON_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "50d932ae-0a86-4e9b-b183-b14fcf6e401c",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_sdump",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_ShortDumps_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_ShortDumps_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "a31e2711-8cb7-4408-9606-8b40429b528f",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_enqread",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_EnqueueRead_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_EnqueueRead_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "42c423f1-c67b-402f-a8ef-68c5d1f7467a",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_inbound_queue",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_InboundQueues_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_InboundQueues_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "d4209b99-84cf-4175-a368-42e44397f961",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_outbound_queue",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_OutboundQueues_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_OutboundQueues_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "6765c648-3fa9-46d8-8d1f-8f74859e35fb",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_batchjobs",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_BatchJobs_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_BatchJobs_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "92513bbc-5343-4c22-8036-e3fa3fe674d1",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_failedupdates",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_FailedUpdates_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_FailedUpdates_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "44dec127-8ff2-434e-a75d-e609fc562d50",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_syslogs",
            "type": 1,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SysLogs_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SysLogs_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "dcc370fd-8366-4fbd-859c-0170ca1b8687",
            "version": "KqlParameterItem/1.0",
            "name": "time_stamp_status_update",
            "type": 1,
            "query": "let extractColumn = dynamic('UTC Timestamp');\r\nSapNetweaver_GetSystemInstanceList_CL\r\n| summarize ['UTC Timestamp'] = max(serverTimestamp_t)\r\n| project properties = pack_all()\r\n| mv-apply name = extractColumn to typeof(string) on \r\n(\r\n    project name, value=properties[name]\r\n)\r\n| extend time_stamp = format_datetime(todatetime(value), \"dd-MM-yyyy HH:mm:ss\")\r\n| project time_stamp",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "20163d5e-cab0-4d77-a266-32a965c6bfaf",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_swnc_user",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_User_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_User_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "fb16b504-f857-4585-b079-2e788ee332dd",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_swnc_memory",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_Memory_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_Memory_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "fa23bd20-c7de-4c3e-b5b8-0a28afee099d",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_swnc_transaction",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_Transaction_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_Transaction_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "23e33206-bbce-4d9b-a7ab-647d4b064599",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_swnc_rfc_usage",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_RFC_Usage_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_SWNC_RFC_Usage_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "bc159dae-b81d-4d5f-8062-122c3f72cfa0",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_stms",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_STMS_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_STMS_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "87fd1a81-50ee-44eb-bbe9-57d3c1c19102",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_transactionalRfc",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_TransactionalRfc_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_TransactionalRfc_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          },
          {
            "id": "37813c2f-5926-402e-9395-39da2d339e0a",
            "version": "KqlParameterItem/1.0",
            "name": "param_check_stms_objectentries",
            "type": 1,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_STMS_ObjectEntries_CL:0",
                  "resultValType": "static",
                  "resultVal": "0"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "param_check_table_exists",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "SapNetweaver_STMS_ObjectEntries_CL:1",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ]
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "dummy_neverset",
        "comparison": "isNotEqualTo"
      },
      "name": "GlobalParameters"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "810c5c3b-c12c-4ecc-a875-a7135a34af90",
            "cellValue": "selectedMenu",
            "linkTarget": "parameter",
            "linkLabel": "Overview",
            "subTarget": "Overview",
            "style": "link"
          },
          {
            "id": "2fcffdc4-ba32-4d94-82c9-69b0e90a3f04",
            "cellValue": "selectedMenu",
            "linkTarget": "parameter",
            "linkLabel": "Availability",
            "subTarget": "Availability",
            "style": "link"
          },
          {
            "id": "e844d4f7-2017-4360-824f-4ac26e8a941d",
            "cellValue": "selectedMenu",
            "linkTarget": "parameter",
            "linkLabel": "Enqueue Statistics",
            "subTarget": "EnqueueStatistics",
            "style": "link"
          },
          {
            "id": "718a2865-1736-41f9-91fe-b0084ecd795d",
            "cellValue": "selectedMenu",
            "linkTarget": "parameter",
            "linkLabel": "Queue Statistics",
            "subTarget": "QueueStatistics",
            "style": "link"
          },
          {
            "id": "bd309ce8-c389-493f-961f-6fc4cfd718dd",
            "cellValue": "selectedMenu",
            "linkTarget": "parameter",
            "linkLabel": "System Performance",
            "subTarget": "Performance",
            "style": "link"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_provider_error",
          "comparison": "isNotEqualTo",
          "value": "-1"
        },
        {
          "parameterName": "param_check_rfc_metrics",
          "comparison": "isNotEqualTo",
          "value": "0"
        }
      ],
      "customWidth": "90",
      "name": "Main Navigation Links"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "c69bbaf6-d2a9-4ebf-8985-a14e22643035",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Overview",
            "subTarget": "Overview",
            "style": "link"
          },
          {
            "id": "3d052c5d-65d8-4462-83ae-375b5c7f65c6",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Availability",
            "subTarget": "Availability",
            "style": "link"
          },
          {
            "id": "0e04320b-60b3-463a-afc2-ff6546e574c7",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Application Performance",
            "subTarget": "Application",
            "style": "link"
          },
          {
            "id": "6a312e51-76b6-4afc-a948-1f22094c392e",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Enqueue Statistics",
            "subTarget": "EnqueueStatistics",
            "style": "link"
          },
          {
            "id": "0155da79-79b5-4e35-91d3-3aeb2ac640e8",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Queue Statistics",
            "subTarget": "QueueStatistics",
            "style": "link"
          },
          {
            "id": "8e505b33-7bc1-427b-9d1c-4998942e885e",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "System Performance",
            "subTarget": "Performance",
            "style": "link"
          },
          {
            "id": "7c7d7b69-c644-4744-a3b4-6027d942036c",
            "cellValue": "selectedMenuRFC",
            "linkTarget": "parameter",
            "linkLabel": "Workload Statistics",
            "subTarget": "WorkloadStatistics",
            "style": "link"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_provider_error",
          "comparison": "isNotEqualTo",
          "value": "-1"
        },
        {
          "parameterName": "param_check_rfc_metrics",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "customWidth": "90",
      "name": "Main Navigation Links - RFC"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "nav",
        "links": [
          {
            "id": "2d20d63e-d352-46e8-bcb0-9ca9ce897996",
            "linkTarget": "WorkbookTemplate",
            "linkLabel": "Alerts",
            "style": "primary",
            "workbookContext": {
              "componentIdSource": "workbook",
              "resourceIdsSource": "workbook",
              "templateIdSource": "static",
              "templateId": "Community-Workbooks/SapMonitor2.0/Alerts/Alerts",
              "typeSource": "workbook",
              "gallerySource": "workbook",
              "locationSource": "default",
              "passSpecificParams": true,
              "templateParameters": [
                {
                  "name": "ProviderType",
                  "source": "parameter",
                  "value": "param_provider_type"
                },
                {
                  "name": "AlertTemplates",
                  "source": "parameter",
                  "value": "param_alert_templates"
                }
              ]
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_provider_error",
          "comparison": "isNotEqualTo",
          "value": "-1"
        }
      ],
      "customWidth": "10",
      "name": "Alert Button Step",
      "styleSettings": {
        "margin": "10px 0px 0px 0px",
        "padding": "10px 0px 0px 0px"
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "aa8ab18f-5d36-4f34-8a54-f0f2e25ecbb8",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedTab",
            "type": 1,
            "query": "let selMenu = '{selectedMenu}';\nlet selMenuRFC = '{selectedMenuRFC}';\nlet rfcCheckParam = '{param_check_rfc_metrics}';\nlet selTabValue = case(selMenu == \"Overview\", \"Overview\", \n                        selMenu == \"Availability\", \"Availability\" ,\n                        selMenu == \"Performance\", \"Performance\" , \n                        selMenu == \"WorkloadStatistics\", \"WorkloadStatistics\" , \n                        selMenu == \"EnqueueStatistics\", \"EnqueueStatistics\" ,\n                        selMenu == \"QueueStatistics\", \"QueueStatistics\",    \n                        \"\");\nlet selTabRFCValue = case(selMenuRFC == \"Overview\", \"Overview\", \n                          selMenuRFC == \"Availability\", \"Availability\" ,\n                          selMenuRFC == \"Utilization\", \"Utilization\" , \n                          selMenuRFC == \"EnqueueStatistics\", \"EnqueueStatistics\" ,\n                          selMenuRFC == \"QueueStatistics\", \"QueueStatistics\" ,\n                          selMenuRFC == \"Application\", \"Application\" ,\n                          selMenuRFC == \"WorkloadStatistics\", \"WorkloadStatistics\" ,\n                          selMenuRFC == \"Performance\", \"Performance\" ,\n                            \"\");    \n\nlet chooseTab = iff((rfcCheckParam == 0),selTabRFCValue, selTabValue);\nprint toscalar(chooseTab);\n",
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "dummy_neverset",
        "comparison": "isNotEqualTo"
      },
      "name": "SelectedTabParameter"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ccee9c3e-3680-4f30-91f7-b53705ab19cf",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": {
              "durationMs": 172800000
            }
          },
          {
            "id": "c3a0f233-017a-4db7-accf-771525491be4",
            "version": "KqlParameterItem/1.0",
            "name": "SID",
            "type": 2,
            "query": "SapNetweaver_GetSystemInstanceList_CL\r\n| where isnotempty(SID_s)\r\n| distinct SID_s",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1"
              ],
              "showDefault": false
            },
            "defaultValue": "value::1",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "71edfc3a-35c4-4aa0-ae7b-1756cee46705",
            "version": "KqlParameterItem/1.0",
            "name": "ApplicationServer",
            "label": "Application Server",
            "type": 2,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SapNetweaver_GetSystemInstanceList_CL\r\n| where serverTimestamp_t between (todatetime({TimeRange:start}) .. todatetime({TimeRange:end}))\r\n| extend instanceNr_s = tostring(toint(instanceNr_d))\r\n| extend instanceNr_s = iff(strlen(instanceNr_s) == 2, instanceNr_s, strcat( \"0\", instanceNr_s))\r\n| where SID_s == '{SID}'\r\n| distinct SID_s, hostname_s, instanceNr_s\r\n| project AppServer = strcat(hostname_s, \"_\", instanceNr_s)\r\n| distinct AppServer",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.workloads/monitors"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "Overview"
        },
        {
          "parameterName": "SelectedTab",
          "comparison": "isNotEqualTo",
          "value": "WorkloadStatistics"
        }
      ],
      "name": "MasterParameters"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadType": "always",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/OverviewTab",
        "items": []
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "Overview"
        },
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_provider_error",
          "comparison": "isNotEqualTo",
          "value": "-1"
        },
        {
          "parameterName": "pram_check_processlist",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "Overview"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/AvailabilityTab",
        "items": []
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "Availability"
        },
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_provider_error",
          "comparison": "isNotEqualTo",
          "value": "-1"
        },
        {
          "parameterName": "pram_check_processlist",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "Availability Group"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "Unable to create the required table (ABAPGetWPTable) to capture telemetry information. Please try after some time. If the issue persists, please contact support.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_abapwp",
              "comparison": "isEqualTo",
              "value": "1"
            },
            "name": "AbapTableCreationError"
          },
          {
            "type": 1,
            "content": {
              "json": "It may take up to 15 minutes for the initial telemetry information to be available for review. Please check again later.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_abapwp",
              "comparison": "isEqualTo",
              "value": "2"
            },
            "name": "AbapIngestionError"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "Performance"
        },
        {
          "parameterName": "param_check_abapwp",
          "comparison": "isNotEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "performance_group_error"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "f6abaf17-46a5-4849-9d72-d4a262bb2965",
                  "cellValue": "selectedPerfRFCTab",
                  "linkTarget": "parameter",
                  "linkLabel": "CPU and Memory (/SDF/SMON)",
                  "subTarget": "CPUMemory",
                  "style": "link"
                },
                {
                  "id": "ee23bc56-4d33-4a4b-8d68-54a1f8173a04",
                  "cellValue": "selectedPerfRFCTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Process Utilization",
                  "subTarget": "ProcessUtilization",
                  "style": "link"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "Performance"
              },
              {
                "parameterName": "param_check_smon",
                "comparison": "isEqualTo",
                "value": "0"
              },
              {
                "parameterName": "param_check_abapwp",
                "comparison": "isEqualTo",
                "value": "0"
              },
              {
                "parameterName": "param_check_rfc_metrics",
                "comparison": "isEqualTo",
                "value": "0"
              },
              {
                "parameterName": "param_check_provider_error",
                "comparison": "isNotEqualTo",
                "value": "-1"
              }
            ],
            "name": "RFCPerformaceTab"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "9c13180c-e1fe-4d7d-ac8c-68e6fce92bcd",
                  "cellValue": "selectedPerfTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Process Utilization",
                  "subTarget": "ProcessUtilization",
                  "style": "link"
                }
              ]
            },
            "conditionalVisibilities": [
              {
                "parameterName": "SelectedTab",
                "comparison": "isEqualTo",
                "value": "Performance"
              },
              {
                "parameterName": "param_check_provider_error",
                "comparison": "isNotEqualTo",
                "value": "-1"
              },
              {
                "parameterName": "param_check_rfc_metrics",
                "comparison": "isNotEqualTo",
                "value": "0"
              },
              {
                "parameterName": "param_check_abapwp",
                "comparison": "isEqualTo",
                "value": "0"
              }
            ],
            "name": "NonRFCPerformaceTab"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "2a6540cb-5072-4185-8a3c-bece3c4b1ed0",
                  "version": "KqlParameterItem/1.0",
                  "name": "selectedPerformanceTab",
                  "type": 1,
                  "query": "let selMenu = dynamic(\"{selectedPerfRFCTab}\");\nlet selMenuRFC = dynamic(\"{selectedPerfTab}\");\nlet rfcCheckParam = dynamic(\"{param_check_rfc_metrics}\");\nlet selTabValue = case(selMenu == \"CPUMemory\", \"CPUMemory\", \n                        selMenu == \"ProcessUtilization\", \"ProcessUtilization\" ,  \n                        \"\");\nlet selTabRFCValue = case(\n                          selMenuRFC == \"ProcessUtilization\", \"ProcessUtilization\" ,\n                            \"\");    \n\nlet chooseTab = iff((rfcCheckParam == 0),selTabValue,selTabRFCValue);\nprint toscalar(chooseTab);\n",
                  "isHiddenWhenLocked": true,
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "SelectedPerfTabParameter"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "Performance"
        },
        {
          "parameterName": "param_check_abapwp",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "PerformanceTabGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/SystemPerformance",
        "items": [],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "Performance"
        },
        {
          "parameterName": "param_check_abapwp",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "performanceprocessutilizationgroup"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "1dc67097-34d6-4ef1-b0c1-2b3b7b16a148",
            "version": "KqlParameterItem/1.0",
            "name": "WorkloadTimeRange",
            "label": "Time Range",
            "type": 4,
            "value": {
              "durationMs": 172800000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "6f7246d7-6be3-463b-9a60-0e80f7e21644",
            "version": "KqlParameterItem/1.0",
            "name": "WorkloadSID",
            "type": 2,
            "quote": "'",
            "delimiter": ",",
            "query": "SapNetweaver_GetSystemInstanceList_CL\r\n| where isnotempty(SID_s)\r\n| distinct SID_s",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::1"
              ],
              "showDefault": false
            },
            "defaultValue": "value::1",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "label": "SID"
          },
          {
            "id": "fc6e4d15-16f3-4ab0-99de-cc5e28322caa",
            "version": "KqlParameterItem/1.0",
            "name": "WorkloadTaskType",
            "type": 2,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SapNetweaver_SWNC_CL\r\n| where serverTimestamp_t between (todatetime({WorkloadTimeRange:start}) .. todatetime({WorkloadTimeRange:end}))\r\n| where SID_s == '{WorkloadSID}'\r\n| summarize count() by Task_Type_Name_s\r\n| order by count_\r\n| project Task_Type_Name_s",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "showDefault": false
            },
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "label": "Workload Task Type"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "WorkloadStatistics"
        },
        {
          "parameterName": "param_check_swnc",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "Workload Parameters"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/WorkloadStatistics",
        "items": []
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "WorkloadStatistics"
      },
      "name": "WorkloadStatisticsGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/ApplicationPerformance",
        "items": []
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Application"
      },
      "name": "applicationgroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "Unable to create the required table (EnqGetStatistic) to capture telemetry information. Please try after some time. If the issue persists, please contact support.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_enqgetstatistics",
              "comparison": "isEqualTo",
              "value": "1"
            },
            "name": "EnqTableCreationError"
          },
          {
            "type": 1,
            "content": {
              "json": "It may take up to 15 minutes for the initial telemetry information to be available for review. Please check again later.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_enqgetstatistics",
              "comparison": "isEqualTo",
              "value": "2"
            },
            "name": "EnqIngestionError"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "EnqueueStatistics"
        },
        {
          "parameterName": "param_check_enqgetstatistics",
          "comparison": "isNotEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "enqStat_group_error"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/EnqueueStatistics",
        "items": []
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "EnqueueStatistics"
        },
        {
          "parameterName": "param_check_enqgetstatistics",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "enqueueStatistics"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "Unable to create the required table (GetQueueStatistics) to capture telemetry information. Please try after some time. If the issue persists, please contact support.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_queuestatistics",
              "comparison": "isEqualTo",
              "value": "1"
            },
            "name": "QueueStatTableCreationError"
          },
          {
            "type": 1,
            "content": {
              "json": "It may take up to 15 minutes for the initial telemetry information to be available for review. Please check again later.",
              "style": "warning"
            },
            "conditionalVisibility": {
              "parameterName": "param_check_queuestatistics",
              "comparison": "isEqualTo",
              "value": "2"
            },
            "name": "QueueStatIngestionError"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "QueueStatistics"
        },
        {
          "parameterName": "param_check_queuestatistics",
          "comparison": "isNotEqualTo",
          "value": "0"
        },
        {
          "parameterName": "param_check_error",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "queuestat_group_error"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "template",
        "loadFromTemplateId": "Community-Workbooks/SapMonitor2.0/SapNetWeaver/QueueStatistics",
        "items": []
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectedTab",
          "comparison": "isEqualTo",
          "value": "QueueStatistics"
        },
        {
          "parameterName": "param_check_queuestatistics",
          "comparison": "isEqualTo",
          "value": "0"
        }
      ],
      "name": "Queue Statistics Group"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
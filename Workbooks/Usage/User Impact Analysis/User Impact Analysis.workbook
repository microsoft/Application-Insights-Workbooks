{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "8e5b3d6e-f2a7-4d5f-99e7-8d51e31d842e",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "During",
            "type": 4,
            "description": "Choose the time range for this report.",
            "isRequired": true,
            "value": {
              "durationMs": 86400000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "24f98f96-2d26-4567-b8c1-9eca1b0121c5",
            "version": "KqlParameterItem/1.0",
            "name": "SelectEvent",
            "label": "Selected event",
            "type": 2,
            "description": "Use the value of the selected metric on this event.",
            "query": "union customEvents, pageViews, requests\r\n    | where timestamp {TimeRange}\r\n    | top-nested 3 of itemType by Ignore = max(1), top-nested 333 of name by Count = count() desc\r\n    | extend value = replace(\"\\n\", \"\",name)\r\n    | project value, label = case(itemType == 'pageView', strcat(\"ðŸŸ¨ \", value), itemType == 'customEvent', strcat(\"ðŸŸ¦ \", value), strcat(\"ðŸŸ¥ \", value)), selected=false, group = case(itemType == 'pageView', 'Page Views', itemType == 'customEvent', 'Custom Events', 'Requests')\r\n    | order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "e4152b00-9f31-4ac2-b1c9-2f0964513368",
            "version": "KqlParameterItem/1.0",
            "name": "usageStandardDimension",
            "type": 1,
            "description": "Query Standard dimension ",
            "isRequired": true,
            "query": "let dimensionList = datatable(ColumnName:string, label:string)[\r\n\t'application_Version', 'Application version',\r\n\t'user_AuthenticatedId', 'Authenticated or anonymous traffic',\r\n\t'client_Browser', 'Browser version', \r\n\t'client_City', 'City',\r\n    'client_CountryOrRegion', 'Country or region', \r\n\t'cloud_RoleInstance', 'Cloud role instance', \r\n\t'cloud_RoleName', 'Cloud role name',\r\n\t'client_Model', 'Device model', \r\n    'client_OS', 'Operating system',\r\n\t'client_Type', 'Device type',\r\n\t'isSynthetic', 'Is real user traffic',\r\n    'name', 'Name', \r\n\t'operation_Name', 'Operation name',\r\n\t'performanceBucket', 'Performance',\r\n    'resultCode', 'Result code',\r\n    'responseCode', 'Response code',\r\n\t'tostring(parseurl(url)[\"Host\"])', 'URL host', \r\n\t'tostring(parseurl(url)[\"Path\"])', 'URL path',\r\n\t'operation_SyntheticSource', 'Source of synthetic traffic',\r\n\t'client_StateOrProvince', 'State or province', \r\n\t'success', 'Successful request',\r\n    'type','Telemetry type'\r\n\t] | order by label asc;\r\nunion customEvents, pageViews, requests\r\n    | where timestamp {TimeRange}\r\n    | getschema \r\n    | where ColumnType == \"string\"\r\n    | summarize count() by ColumnName\r\n    | join kind = inner dimensionList on ColumnName\r\n    | project ColumnName, label\r\n    | order by label asc\r\n    | project data = strcat(\"'\", replace(@\"\\'\",@\"/:/\", ColumnName),\"','\",replace(@\"\\'\",@\"/:/\", label),\"','Standard Properties'\")",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "b6db195f-a819-45ff-8eed-bae7c09ab135",
            "version": "KqlParameterItem/1.0",
            "name": "getCustomDimensions",
            "type": 1,
            "description": "The query is used by ByValue, SplityBy and Properties dropdown",
            "isRequired": true,
            "query": "union customEvents, pageViews, requests\r\n            | where timestamp {TimeRange}\r\n            | project  column_ifexists(\"customDimensions\",'')\r\n            | evaluate bag_unpack(column_ifexists(\"customDimensions\",''))\r\n            | getschema \r\n            | top-nested 800 of ColumnName by Count = count() desc\r\n            | project value =strcat(\"customDimensions[\\\"\", ColumnName, \"\\\"]\"), label =ColumnName, group='Custom Properties'\r\n            | order by label asc\r\n            | project data = strcat(\"'\", replace(@\"\\'\",@\"/:/\", value),\"','\",replace(@\"\\'\",@\"/:/\", label),\"','\",group,\"'\")",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "8b11feda-c3d4-4fb6-93d4-92321ccabd9d",
            "version": "KqlParameterItem/1.0",
            "name": "formattedCustomDimensions",
            "type": 1,
            "isRequired": true,
            "query": "print iff(isempty('{getCustomDimensions:escape}'), '[]',iff('{getCustomDimensions:escape}' startswith '[', '{getCustomDimensions:escape}', strcat('[','{getCustomDimensions:escape}',']')))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "809c2750-18d5-47e3-b41a-f6cdb7ef561a",
            "version": "KqlParameterItem/1.0",
            "name": "BucketItem",
            "label": "analyze how its",
            "type": 2,
            "description": "Select the metric used to bucketize data.",
            "isRequired": true,
            "query": "let getTableSchema = (table: (*), tableName: string) { \r\n\t  table\r\n      | project  column_ifexists(\"customDimensions\",'')\r\n      | evaluate bag_unpack(column_ifexists(\"customDimensions\",''))\r\n      | getschema \r\n      | project label=ColumnName, ColumnType, TableName=tableName};\r\nlet t1 = getTableSchema(pageViews, 'pageViews');\r\nlet t2 = getTableSchema(customEvents, 'customEvents');\r\nlet t3 = getTableSchema(requests, 'requests');\r\nlet durationTable = datatable(value:string, label:string, group: string, selected: string)[\r\n\t'duration', 'Duration', 'Metrics', ''\r\n    ];\r\nlet customDimension =  union t1, t2, t3\r\n    | where ColumnType == 'string'\r\n    | summarize count() by label\r\n    | project value = strcat(\"customDimensions[\\\"\", label,\"\\\"]\"), label, group='Custom Properties', selected=''\r\n    | order by label asc;    \r\nlet validDimensionList = datatable(value:string, label:string)[\r\n\t'application_Version', 'Application version',\r\n\t'user_AuthenticatedId', 'Authenticated or anonymous traffic',\r\n\t'client_Browser', 'Browser version', \r\n\t'client_City', 'City',\r\n    'client_CountryOrRegion', 'Country or region', \r\n\t'cloud_RoleInstance', 'Cloud role instance', \r\n\t'cloud_RoleName', 'Cloud role name',\r\n\t'client_Model', 'Device model', \r\n    'client_OS', 'Operating system',\r\n\t'client_Type', 'Device type',\r\n\t'isSynthetic', 'Is real user traffic',\r\n    'name', 'Name', \r\n\t'operation_Name', 'Operation name',\r\n\t'performanceBucket', 'Performance',\r\n    'resultCode', 'Result code',\r\n    'responseCode', 'Response code',\r\n\t'tostring(parseurl(url)[\"Host\"])', 'URL host', \r\n\t'tostring(parseurl(url)[\"Path\"])', 'URL path',\r\n\t'operation_SyntheticSource', 'Source of synthetic traffic',\r\n\t'client_StateOrProvince', 'State or province', \r\n\t'success', 'Successful request',\r\n    'type','Telemetry type'\r\n\t] | order by label asc;\r\nlet dimensionList = union pageViews, customEvents, requests\r\n    | where timestamp {TimeRange}\r\n    | getschema \r\n    | where ColumnType == \"string\"\r\n    | summarize count() by value = ColumnName\r\n    | join kind = inner validDimensionList on value\r\n    | project value, label, group = \"Standard Properties\", selected = ''\r\n    | order by label asc;\r\nunion durationTable, dimensionList, customDimension \r\n    | project value, label, group, selected\r\n    | where iff('{SelectEvent:label}' contains 'ðŸŸ¦', group != 'Metrics', 1==1)\r\n\r\n",
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "593233a9-14c2-464b-98fe-63c8e1419ae9",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactItem",
            "label": "Impacting event",
            "type": 2,
            "description": "Conversion will be calculated based on how many times this event happened after the impacting event.",
            "query": "union customEvents, pageViews\r\n    | where timestamp {TimeRange}\r\n    | top-nested 2 of itemType by Ignore = max(1), top-nested 333 of name by Count = count() desc\r\n    | extend value = replace(\"\\n\", \"\",name)\r\n    | project value, label =  case(itemType == 'pageView', strcat(\"ðŸŸ¨ \", value), strcat(\"ðŸŸ¦ \", value)), selected=false, group = case(itemType == 'pageView', 'Page Views', 'Custom Events')\r\n    | order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "1123006c-b3e0-4404-a47f-657ac07936f3",
            "version": "KqlParameterItem/1.0",
            "name": "Bucketize",
            "label": "Bucketize by",
            "type": 2,
            "description": "Determines how to bucketize the events.",
            "isRequired": true,
            "query": "datatable(value:string, text:string, selected: string)[\r\n'0.5', 'Half seconds', '',\r\n'0.25', 'Quarters of a second', '',\r\n'1', 'Seconds', '',\r\n'10', 'Deciles', '',\r\n'25', 'Quartiles', '',\r\n'5', 'Ventiles', 'true'\r\n]",
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "5cb59496-3f78-417f-a79f-e0b99af5203f",
            "version": "KqlParameterItem/1.0",
            "name": "commonFilterDimensions",
            "type": 1,
            "isRequired": true,
            "value": "['user_AccountId', 'Account Id',  'Standard Properties', 'user_AuthenticatedId', 'Authenticated user Id', 'Standard Properties', 'operation_Id', 'Operation Id', 'Standard Properties', 'session_Id', 'Session Id',  'Standard Properties', 'user_Id', 'User Id', 'Standard Properties']",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "['user_AccountId', 'Account Id',  'Standard Properties', 'user_AuthenticatedId', 'Authenticated user Id', 'Standard Properties', 'operation_Id', 'Operation Id', 'Standard Properties', 'session_Id', 'Session Id',  'Standard Properties', 'user_Id', 'User Id', 'Standard Properties']"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters - common"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "c154702e-61f0-4501-8f1f-1f76053f607b",
            "cellValue": "EventFiltersVisibility",
            "linkTarget": "parameter",
            "linkLabel": "Hide Filters",
            "subTarget": "0",
            "style": "link"
          },
          {
            "id": "e0773581-c512-4101-8d28-755751a84829",
            "cellValue": "EventFiltersVisibility",
            "linkTarget": "parameter",
            "linkLabel": "Add selected event filters",
            "subTarget": "1",
            "preText": "",
            "style": "link"
          },
          {
            "id": "e357ebe4-2135-4e96-a9ee-bd302528209b",
            "cellValue": "EventFiltersVisibility",
            "linkTarget": "parameter",
            "linkLabel": "Add impacting event filters",
            "subTarget": "2",
            "style": "link"
          }
        ]
      },
      "name": "links - 25"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterDimension1",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "30a9cd77-3c20-49bf-8470-1711cabdfafb",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterOperator1",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterValues1text",
            "label": "Value",
            "type": 1,
            "description": "Delimiter with comma for \"is in\" and \"is not in\" operators, like \"a, b\"",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "26daf779-8964-4640-9b3f-16ace257559f",
            "version": "KqlParameterItem/1.0",
            "name": "isSelectedEventFilter1Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (SelectedEventFilterDimension1 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterDimension1",
                  "operator": "is Empty",
                  "rightValType": "static",
                  "rightVal": "",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (SelectedEventFilterValues1text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterValues1text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator1 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator1 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterValues1",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{SelectedEventFilterValues1text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilter1Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({SelectedEventFilterDimension1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({SelectedEventFilterDimension1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{SelectedEventFilterDimension1} in ({SelectedEventFilterValues1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{SelectedEventFilterDimension1} !in ({SelectedEventFilterValues1})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{SelectedEventFilterDimension1} {SelectedEventFilterOperator1} \"{SelectedEventFilterValues1text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibility": {
        "parameterName": "EventFiltersVisibility",
        "comparison": "isEqualTo",
        "value": "1"
      },
      "name": "parameters - SelectedEventFilterDimension1"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilterDimension2",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| where value != '{SelectedEventFilterDimension1}'\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "d5f89cf5-6ae3-4a27-8afc-80a8112b1391",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterOperator2",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventSelectedEventFilterValues2text",
            "label": "Value",
            "type": 1,
            "value": "",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "06f2574c-b29c-4ab3-92c4-2e837289f6b5",
            "version": "KqlParameterItem/1.0",
            "name": "isSelectedEventFilter2Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isSelectedEventFilter1Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (selectedEventFilterDimension2 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "selectedEventFilterDimension2",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (SelectedEventSelectedEventFilterValues2text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventSelectedEventFilterValues2text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator2 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator2 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterValues2",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{SelectedEventSelectedEventFilterValues2text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilter2Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({selectedEventFilterDimension2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({selectedEventFilterDimension2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension2} in ({SelectedEventFilterValues2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension2} !in ({SelectedEventFilterValues2})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension2} {SelectedEventFilterOperator2} \"{SelectedEventSelectedEventFilterValues2text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "EventFiltersVisibility",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "parameterName": "isSelectedEventFilter1Completed",
          "comparison": "isEqualTo",
          "value": "1"
        }
      ],
      "name": "parameters - selectedEventFilterDimension2"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilterDimension3",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| where value != '{SelectedEventFilterDimension1}' and value != '{selectedEventFilterDimension2}'\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "d5f89cf5-6ae3-4a27-8afc-80a8112b1391",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterOperator3",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterValues3text",
            "label": "Value",
            "type": 1,
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "06f2574c-b29c-4ab3-92c4-2e837289f6b5",
            "version": "KqlParameterItem/1.0",
            "name": "isSelectedEventFilter3Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isSelectedEventFilter1Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (isSelectedEventFilter2Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (selectedEventFilterDimension3 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "selectedEventFilterDimension3",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (SelectedEventFilterValues3text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterValues3text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator3 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (SelectedEventFilterOperator3 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedEventFilterValues3",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{SelectedEventFilterValues3text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilter3Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter3Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({selectedEventFilterDimension3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({selectedEventFilterDimension3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension3} in ({SelectedEventFilterValues3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "SelectedEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension3} !in ({SelectedEventFilterValues3})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{selectedEventFilterDimension3} {SelectedEventFilterOperator3} \"{SelectedEventFilterValues3text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isSelectedEventFilter2Completed",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "parameterName": "isSelectedEventFilter2Completed",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "parameterName": "EventFiltersVisibility",
          "comparison": "isEqualTo",
          "value": "1"
        }
      ],
      "name": "parameters - selectedEventFilterDimension3"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterDimension1",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "30a9cd77-3c20-49bf-8470-1711cabdfafb",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterOperator1",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues1text",
            "label": "Value",
            "type": 1,
            "description": "Delimiter with comma for \"is in\" and \"is not in\" operators, like \"a, b\"",
            "value": "",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "26daf779-8964-4640-9b3f-16ace257559f",
            "version": "KqlParameterItem/1.0",
            "name": "isImpactingEventFilter1Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (ImpactingEventFilterDimension1 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterDimension1",
                  "operator": "is Empty",
                  "rightValType": "static",
                  "rightVal": "",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (ImpactingEventFilterValues1text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterValues1text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator1 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator1 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues1",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{ImpactingEventFilterValues1text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "impactingEventFilter1Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({ImpactingEventFilterDimension1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({ImpactingEventFilterDimension1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension1} in ({ImpactingEventFilterValues1})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator1",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension1} !in ({ImpactingEventFilterValues1})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension1} {ImpactingEventFilterOperator1} \"{ImpactingEventFilterValues1text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibility": {
        "parameterName": "EventFiltersVisibility",
        "comparison": "isEqualTo",
        "value": "2"
      },
      "name": "parameters - ImpactingEventFilterDimension1"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterDimension2",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| where value != '{ImpactingEventFilterDimension1}'\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "d5f89cf5-6ae3-4a27-8afc-80a8112b1391",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterOperator2",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues2text",
            "label": "Value",
            "type": 1,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "06f2574c-b29c-4ab3-92c4-2e837289f6b5",
            "version": "KqlParameterItem/1.0",
            "name": "isImpactingEventFilter2Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isImpactingEventFilter1Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (ImpactingEventFilterDimension2 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterDimension2",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (ImpactingEventFilterValues2text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterValues2text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator2 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator2 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues2",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{ImpactingEventFilterValues2text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "impactingEventFilter2Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({ImpactingEventFilterDimension2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({ImpactingEventFilterDimension2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension2} in ({ImpactingEventFilterValues2})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator2",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension2} !in ({ImpactingEventFilterValues2})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension2} {ImpactingEventFilterOperator2} \"{ImpactingEventFilterValues2text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "EventFiltersVisibility",
          "comparison": "isEqualTo",
          "value": "2"
        },
        {
          "parameterName": "isImpactingEventFilter1Completed",
          "comparison": "isEqualTo",
          "value": "1"
        }
      ],
      "name": "parameters - ImpactingEventFilterDimension2"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "ed55d4b0-7ca0-4a60-afeb-95a005c87e1a",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterDimension3",
            "label": "Dimension",
            "type": 2,
            "query": "let customDimension = datatable(value:string, label:string, group: string) \r\n{formattedCustomDimensions}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label); \r\nlet dimensionList = datatable(value:string, label:string, group: string) {usageStandardDimension}\r\n| extend value = replace(@\"/:/\", @\"\\'\", value), label = replace(@\"/:/\", @\"\\'\", label);\r\nlet commonFilterDimensionList = datatable(value:string, label:string, group: string) \r\n{commonFilterDimensions};\r\nunion dimensionList, customDimension, commonFilterDimensionList\r\n| project value, label, selected=false, group\r\n| where value != '{ImpactingEventFilterDimension1}' and value != '{ImpactingEventFilterDimension2}'\r\n| order by group desc, label asc",
            "value": null,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "d5f89cf5-6ae3-4a27-8afc-80a8112b1391",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterOperator3",
            "label": "Operator",
            "type": 2,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n    { \"value\":\"==\", \"label\":\"==\", \"selected\":true },\r\n    { \"value\":\"!=\", \"label\":\"!=\" },\r\n    { \"value\":\"contains\", \"label\":\"contains\" },\r\n    { \"value\":\"!contains\", \"label\":\"not contains\" },\r\n    { \"value\":\"startswith\", \"label\":\"starts with\" },\r\n    { \"value\":\"!startswith\", \"label\":\"does not start with\" },\r\n    { \"value\":\"endswith\", \"label\":\"ends with\" },\r\n    { \"value\":\"!endswith\", \"label\":\"does not end with\" },\r\n    { \"value\":\"isempty\", \"label\":\"is empty\" },\r\n    { \"value\":\"isnotempty\", \"label\":\"is not empty\" },\r\n    { \"value\":\"in\", \"label\":\"is in\" },\r\n    { \"value\":\"!in\", \"label\":\"is not in\" }\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "ef15d795-cfec-4bcf-ba31-8e4344251143",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues3text",
            "label": "Value",
            "type": 1,
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "06f2574c-b29c-4ab3-92c4-2e837289f6b5",
            "version": "KqlParameterItem/1.0",
            "name": "isImpactingEventFilter3Completed",
            "type": 1,
            "isRequired": true,
            "value": "2",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isImpactingEventFilter1Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (isImpactingEventFilter2Completed == '2'), result = '2'",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (ImpactingEventFilterDimension3 is empty ), result = '2'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterDimension3",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              },
              {
                "condition": "if (ImpactingEventFilterValues3text is not empty ), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterValues3text",
                  "operator": "isNotNull",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator3 == 'isempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "if (ImpactingEventFilterOperator3 == 'isnotempty'), result = '1'",
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "1"
                }
              },
              {
                "condition": "else result = '2'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "2"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "a4fc0b77-fbf1-41f4-9c81-8a3b3398bd8f",
            "version": "KqlParameterItem/1.0",
            "name": "ImpactingEventFilterValues3",
            "type": 1,
            "isRequired": true,
            "query": "print trim_end(\"]\",substring(split(trim_end(\" \", trim_start(\" \", replace(@' ,', @',', replace(@', ', @',', '{ImpactingEventFilterValues3text:escapejson}')))),\",\"),1))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "6aaefa03-6368-423e-a797-34df9c319772",
            "version": "KqlParameterItem/1.0",
            "name": "impactingEventFilter3Query",
            "type": 1,
            "isRequired": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter3Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "2",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isempty",
                  "resultValType": "static",
                  "resultVal": "isempty({ImpactingEventFilterDimension3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "isnotempty",
                  "resultValType": "static",
                  "resultVal": "isnotempty({ImpactingEventFilterDimension3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension3} in ({ImpactingEventFilterValues3})"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactingEventFilterOperator3",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "!in",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension3} !in ({ImpactingEventFilterValues3})"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "{ImpactingEventFilterDimension3} {ImpactingEventFilterOperator3} \"{ImpactingEventFilterValues3text:escapejson}\""
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "doNotRunWhenHidden": true,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isImpactingEventFilter2Completed",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "parameterName": "isImpactingEventFilter2Completed",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "parameterName": "EventFiltersVisibility",
          "comparison": "isEqualTo",
          "value": "2"
        }
      ],
      "name": "parameters - ImpactingEventFilterDimension3"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7b2d237c-3dff-4bba-89c2-fac04b4324a9",
            "version": "KqlParameterItem/1.0",
            "name": "selectedEventFilters",
            "type": 1,
            "isRequired": true,
            "value": "| where true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isSelectedEventFilter3Completed == '1'), result = '| where {selectedEventFilter1Query} and {selectedEventFilter2Query} and {selectedEventFilter3Query}'",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter3Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {selectedEventFilter1Query} and {selectedEventFilter2Query} and {selectedEventFilter3Query}"
                }
              },
              {
                "condition": "if (isSelectedEventFilter2Completed == '1'), result = '| where {selectedEventFilter1Query} and {selectedEventFilter2Query} '",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {selectedEventFilter1Query} and {selectedEventFilter2Query} "
                }
              },
              {
                "condition": "if (isSelectedEventFilter1Completed == '1'), result = '| where {selectedEventFilter1Query} '",
                "criteriaContext": {
                  "leftOperand": "isSelectedEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {selectedEventFilter1Query} "
                }
              },
              {
                "condition": "else result = '| where true'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "| where true"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "7b2d237c-3dff-4bba-89c2-fac04b4324a9",
            "version": "KqlParameterItem/1.0",
            "name": "impactingEventFilters",
            "type": 1,
            "isRequired": true,
            "value": "| where true",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (isImpactingEventFilter3Completed == '1'), result = '| where {impactingEventFilter1Query} and {impactingEventFilter2Query} and {impactingEventFilter3Query}'",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter3Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {impactingEventFilter1Query} and {impactingEventFilter2Query} and {impactingEventFilter3Query}"
                }
              },
              {
                "condition": "if (isImpactingEventFilter2Completed == '1'), result = '| where {impactingEventFilter1Query} and {impactingEventFilter2Query} '",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter2Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {impactingEventFilter1Query} and {impactingEventFilter2Query} "
                }
              },
              {
                "condition": "if (isImpactingEventFilter1Completed == '1'), result = '| where {impactingEventFilter1Query} '",
                "criteriaContext": {
                  "leftOperand": "isImpactingEventFilter1Completed",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| where {impactingEventFilter1Query} "
                }
              },
              {
                "condition": "else result = '| where true'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "| where true"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isSelectedEventFilter1Completed",
          "comparison": "isEqualTo",
          "value": "1"
        },
        {
          "comparison": "isEqualTo",
          "parameterName": "EventFiltersVisibility",
          "value": "1"
        }
      ],
      "name": "parameters - Filters connect"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "db57ed02-320a-4427-81cc-d96b08ddc32d",
            "version": "KqlParameterItem/1.0",
            "name": "bucketQuery",
            "type": 1,
            "value": "| summarize percentiles(average, 5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100) | extend list = parse_json(strcat(\"[\", percentile_average_5,\",\",percentile_average_10,\",\",percentile_average_15,\",\",percentile_average_20,\",\",percentile_average_25,\",\",percentile_average_30,\",\",percentile_average_35,\",\",percentile_average_40,\",\",percentile_average_45,\",\",percentile_average_50,\",\",percentile_average_55,\",\",percentile_average_60,\",\",percentile_average_65,\",\",percentile_average_70,\",\",percentile_average_75,\",\",percentile_average_80,\",\",percentile_average_85,\",\",percentile_average_90,\",\",percentile_average_95,\",\",percentile_average_100, \"]\"))",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (Bucketize == '0.5'), result = '| extend list = parse_json(strcat(\"[\", 500,\",\",1000,\",\",1500,\",\",2000,\",\",2500,\",\",3000,\",\",3500,\",\",4000,\",\",4500,\",\",5000, \"]\"))'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "0.5",
                  "resultValType": "static",
                  "resultVal": "| extend list = parse_json(strcat(\"[\", 500,\",\",1000,\",\",1500,\",\",2000,\",\",2500,\",\",3000,\",\",3500,\",\",4000,\",\",4500,\",\",5000, \"]\"))"
                }
              },
              {
                "condition": "if (Bucketize == '10'), result = '| summarize percentiles(average, 10,20,30,40,50,60,70,80,90,100) | extend list = parse_json(strcat(\"[\", percentile_average_10,\",\",percentile_average_20,\",\",percentile_average_30,\",\",percentile_average_40,\",\",percentile_average_50,\",\",percentile_average_60,\",\",percentile_average_70,\",\",percentile_average_80,\",\",percentile_average_90,\",\",percentile_average_100, \"]\"))'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "10",
                  "resultValType": "static",
                  "resultVal": "| summarize percentiles(average, 10,20,30,40,50,60,70,80,90,100) | extend list = parse_json(strcat(\"[\", percentile_average_10,\",\",percentile_average_20,\",\",percentile_average_30,\",\",percentile_average_40,\",\",percentile_average_50,\",\",percentile_average_60,\",\",percentile_average_70,\",\",percentile_average_80,\",\",percentile_average_90,\",\",percentile_average_100, \"]\"))"
                }
              },
              {
                "condition": "if (Bucketize == '25'), result = '| summarize percentiles(average, 25,50,75,100) | extend list = parse_json(strcat(\"[\", percentile_average_25,\",\",percentile_average_50,\",\",percentile_average_75,\",\",percentile_average_100, \"]\"))'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "25",
                  "resultValType": "static",
                  "resultVal": "| summarize percentiles(average, 25,50,75,100) | extend list = parse_json(strcat(\"[\", percentile_average_25,\",\",percentile_average_50,\",\",percentile_average_75,\",\",percentile_average_100, \"]\"))"
                }
              },
              {
                "condition": "if (Bucketize == '1'), result = '| extend list = parse_json(strcat(\"[\", 1000,\",\",2000,\",\",3000,\",\",4000,\",\",5000,\",\",6000,\",\",7000,\",\",8000,\",\",9000,\",\",10000, \"]\"))'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "| extend list = parse_json(strcat(\"[\", 1000,\",\",2000,\",\",3000,\",\",4000,\",\",5000,\",\",6000,\",\",7000,\",\",8000,\",\",9000,\",\",10000, \"]\"))"
                }
              },
              {
                "condition": "if (Bucketize == '5'), result = '| summarize percentiles(average, 5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100) | extend list = parse_json(strcat(\"[\", percentile_average_5,\",\",percentile_average_10,\",\",percentile_average_15,\",\",percentile_average_20,\",\",percentile_average_25,\",\",percentile_average_30,\",\",percentile_average_35,\",\",percentile_average_40,\",\",percentile_average_45,\",\",percentile_average_50,\",\",percentile_average_55,\",\",percentile_average_60,\",\",percentile_average_65,\",\",percentile_average_70,\",\",percentile_average_75,\",\",percentile_average_80,\",\",percentile_average_85,\",\",percentile_average_90,\",\",percentile_average_95,\",\",percentile_average_100, \"]\"))'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "5",
                  "resultValType": "static",
                  "resultVal": "| summarize percentiles(average, 5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100) | extend list = parse_json(strcat(\"[\", percentile_average_5,\",\",percentile_average_10,\",\",percentile_average_15,\",\",percentile_average_20,\",\",percentile_average_25,\",\",percentile_average_30,\",\",percentile_average_35,\",\",percentile_average_40,\",\",percentile_average_45,\",\",percentile_average_50,\",\",percentile_average_55,\",\",percentile_average_60,\",\",percentile_average_65,\",\",percentile_average_70,\",\",percentile_average_75,\",\",percentile_average_80,\",\",percentile_average_85,\",\",percentile_average_90,\",\",percentile_average_95,\",\",percentile_average_100, \"]\"))"
                }
              },
              {
                "condition": "else result = '| extend list = parse_json(strcat(\"[\", 250,\",\",500,\",\",750,\",\",1000,\",\",1250,\",\",1500,\",\",1750,\",\",2000,\",\",2250,\",\",2500,\",\",2750,\",\",3000,\",\",3250,\",\",3500,\",\",3750,\",\",4000,\",\",4250,\",\",4500,\",\",4750,\",\",5000, \"]\"))'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "| extend list = parse_json(strcat(\"[\", 250,\",\",500,\",\",750,\",\",1000,\",\",1250,\",\",1500,\",\",1750,\",\",2000,\",\",2250,\",\",2500,\",\",2750,\",\",3000,\",\",3250,\",\",3500,\",\",3750,\",\",4000,\",\",4250,\",\",4500,\",\",4750,\",\",5000, \"]\"))"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "6a99cb19-efab-4114-a56f-4b20dc76bd83",
            "version": "KqlParameterItem/1.0",
            "name": "bucketizeFunc",
            "type": 1,
            "value": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9,metric > buckets[9] and metric <= buckets[10], 10,metric > buckets[10] and metric <= buckets[11], 11,metric > buckets[11] and metric <= buckets[12], 12,metric > buckets[12] and metric <= buckets[13], 13,metric > buckets[13] and metric <= buckets[14], 14,metric > buckets[14] and metric <= buckets[15], 15,metric > buckets[15] and metric <= buckets[16], 16,metric > buckets[16] and metric <= buckets[17], 17,metric > buckets[17] and metric <= buckets[18], 18,metric > buckets[18] and metric <= buckets[19], 19, -1)",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (Bucketize == '0.5'), result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "0.5",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)"
                }
              },
              {
                "condition": "if (Bucketize == '10'), result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "10",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)"
                }
              },
              {
                "condition": "if (Bucketize == '25'), result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3, -1)'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "25",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3, -1)"
                }
              },
              {
                "condition": "if (Bucketize == '1'), result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9, -1)"
                }
              },
              {
                "condition": "if (Bucketize == '5'), result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9,metric > buckets[9] and metric <= buckets[10], 10,metric > buckets[10] and metric <= buckets[11], 11,metric > buckets[11] and metric <= buckets[12], 12,metric > buckets[12] and metric <= buckets[13], 13,metric > buckets[13] and metric <= buckets[14], 14,metric > buckets[14] and metric <= buckets[15], 15,metric > buckets[15] and metric <= buckets[16], 16,metric > buckets[16] and metric <= buckets[17], 17,metric > buckets[17] and metric <= buckets[18], 18,metric > buckets[18] and metric <= buckets[19], 19, -1)'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "5",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9,metric > buckets[9] and metric <= buckets[10], 10,metric > buckets[10] and metric <= buckets[11], 11,metric > buckets[11] and metric <= buckets[12], 12,metric > buckets[12] and metric <= buckets[13], 13,metric > buckets[13] and metric <= buckets[14], 14,metric > buckets[14] and metric <= buckets[15], 15,metric > buckets[15] and metric <= buckets[16], 16,metric > buckets[16] and metric <= buckets[17], 17,metric > buckets[17] and metric <= buckets[18], 18,metric > buckets[18] and metric <= buckets[19], 19, -1)"
                }
              },
              {
                "condition": "else result = 'case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9,metric > buckets[9] and metric <= buckets[10], 10,metric > buckets[10] and metric <= buckets[11], 11,metric > buckets[11] and metric <= buckets[12], 12,metric > buckets[12] and metric <= buckets[13], 13,metric > buckets[13] and metric <= buckets[14], 14,metric > buckets[14] and metric <= buckets[15], 15,metric > buckets[15] and metric <= buckets[16], 16,metric > buckets[16] and metric <= buckets[17], 17,metric > buckets[17] and metric <= buckets[18], 18,metric > buckets[18] and metric <= buckets[19], 19, -1)'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "case(metric >= 0 and metric <= buckets[0], 0,metric > buckets[0] and metric <= buckets[1], 1,metric > buckets[1] and metric <= buckets[2], 2,metric > buckets[2] and metric <= buckets[3], 3,metric > buckets[3] and metric <= buckets[4], 4,metric > buckets[4] and metric <= buckets[5], 5,metric > buckets[5] and metric <= buckets[6], 6,metric > buckets[6] and metric <= buckets[7], 7,metric > buckets[7] and metric <= buckets[8], 8,metric > buckets[8] and metric <= buckets[9], 9,metric > buckets[9] and metric <= buckets[10], 10,metric > buckets[10] and metric <= buckets[11], 11,metric > buckets[11] and metric <= buckets[12], 12,metric > buckets[12] and metric <= buckets[13], 13,metric > buckets[13] and metric <= buckets[14], 14,metric > buckets[14] and metric <= buckets[15], 15,metric > buckets[15] and metric <= buckets[16], 16,metric > buckets[16] and metric <= buckets[17], 17,metric > buckets[17] and metric <= buckets[18], 18,metric > buckets[18] and metric <= buckets[19], 19, -1)"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "10d00564-f0c4-4dbe-b4dd-781cfc7cea78",
            "version": "KqlParameterItem/1.0",
            "name": "bucketLabel",
            "type": 1,
            "value": "case(bucket == 0, \"Ventile 1\",bucket == 1, \"Ventile 2\",bucket == 2, \"Ventile 3\",bucket == 3, \"Ventile 4\",bucket == 4, \"Ventile 5\",bucket == 5, \"Ventile 6\",bucket == 6, \"Ventile 7\",bucket == 7, \"Ventile 8\",bucket == 8, \"Ventile 9\",bucket == 9, \"Ventile 10\",bucket == 10, \"Ventile 11\",bucket == 11, \"Ventile 12\",bucket == 12, \"Ventile 13\",bucket == 13, \"Ventile 14\",bucket == 14, \"Ventile 15\",bucket == 15, \"Ventile 16\",bucket == 16, \"Ventile 17\",bucket == 17, \"Ventile 18\",bucket == 18, \"Ventile 19\",bucket == 19, \"Ventile 20\", \"\")",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (Bucketize == '0.5'), result = 'case(bucket == 0, \"0s - 0.5s\",bucket == 1, \"0.5s - 1s\",bucket == 2, \"1s - 1.5s\",bucket == 3, \"1.5s - 2s\",bucket == 4, \"2s - 2.5s\",bucket == 5, \"2.5s - 3s\",bucket == 6, \"3s - 3.5s\",bucket == 7, \"3.5s - 4s\",bucket == 8, \"4s - 4.5s\",bucket == 9, \"4.5s - 5s\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "0.5",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"0s - 0.5s\",bucket == 1, \"0.5s - 1s\",bucket == 2, \"1s - 1.5s\",bucket == 3, \"1.5s - 2s\",bucket == 4, \"2s - 2.5s\",bucket == 5, \"2.5s - 3s\",bucket == 6, \"3s - 3.5s\",bucket == 7, \"3.5s - 4s\",bucket == 8, \"4s - 4.5s\",bucket == 9, \"4.5s - 5s\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '10'), result = 'case(bucket == 0, \"Decile 1\",bucket == 1, \"Decile 2\",bucket == 2, \"Decile 3\",bucket == 3, \"Decile 4\",bucket == 4, \"Decile 5\",bucket == 5, \"Decile 6\",bucket == 6, \"Decile 7\",bucket == 7, \"Decile 8\",bucket == 8, \"Decile 9\",bucket == 9, \"Decile 10\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "10",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"Decile 1\",bucket == 1, \"Decile 2\",bucket == 2, \"Decile 3\",bucket == 3, \"Decile 4\",bucket == 4, \"Decile 5\",bucket == 5, \"Decile 6\",bucket == 6, \"Decile 7\",bucket == 7, \"Decile 8\",bucket == 8, \"Decile 9\",bucket == 9, \"Decile 10\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '25'), result = 'case(bucket == 0, \"Quartile 1\",bucket == 1, \"Quartile 2\",bucket == 2, \"Quartile 3\",bucket == 3, \"Quartile 4\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "25",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"Quartile 1\",bucket == 1, \"Quartile 2\",bucket == 2, \"Quartile 3\",bucket == 3, \"Quartile 4\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '1'), result = 'case(bucket == 0, \"0s - 1s\",bucket == 1, \"1s - 2s\",bucket == 2, \"2s - 3s\",bucket == 3, \"3s - 4s\",bucket == 4, \"4s - 5s\",bucket == 5, \"5s - 6s\",bucket == 6, \"6s - 7s\",bucket == 7, \"7s - 8s\",bucket == 8, \"8s - 9s\",bucket == 9, \"9s - 10s\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"0s - 1s\",bucket == 1, \"1s - 2s\",bucket == 2, \"2s - 3s\",bucket == 3, \"3s - 4s\",bucket == 4, \"4s - 5s\",bucket == 5, \"5s - 6s\",bucket == 6, \"6s - 7s\",bucket == 7, \"7s - 8s\",bucket == 8, \"8s - 9s\",bucket == 9, \"9s - 10s\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '5'), result = 'case(bucket == 0, \"Ventile 1\",bucket == 1, \"Ventile 2\",bucket == 2, \"Ventile 3\",bucket == 3, \"Ventile 4\",bucket == 4, \"Ventile 5\",bucket == 5, \"Ventile 6\",bucket == 6, \"Ventile 7\",bucket == 7, \"Ventile 8\",bucket == 8, \"Ventile 9\",bucket == 9, \"Ventile 10\",bucket == 10, \"Ventile 11\",bucket == 11, \"Ventile 12\",bucket == 12, \"Ventile 13\",bucket == 13, \"Ventile 14\",bucket == 14, \"Ventile 15\",bucket == 15, \"Ventile 16\",bucket == 16, \"Ventile 17\",bucket == 17, \"Ventile 18\",bucket == 18, \"Ventile 19\",bucket == 19, \"Ventile 20\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "5",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"Ventile 1\",bucket == 1, \"Ventile 2\",bucket == 2, \"Ventile 3\",bucket == 3, \"Ventile 4\",bucket == 4, \"Ventile 5\",bucket == 5, \"Ventile 6\",bucket == 6, \"Ventile 7\",bucket == 7, \"Ventile 8\",bucket == 8, \"Ventile 9\",bucket == 9, \"Ventile 10\",bucket == 10, \"Ventile 11\",bucket == 11, \"Ventile 12\",bucket == 12, \"Ventile 13\",bucket == 13, \"Ventile 14\",bucket == 14, \"Ventile 15\",bucket == 15, \"Ventile 16\",bucket == 16, \"Ventile 17\",bucket == 17, \"Ventile 18\",bucket == 18, \"Ventile 19\",bucket == 19, \"Ventile 20\", \"\")"
                }
              },
              {
                "condition": "else result = 'case(bucket == 0, \"0s - 0.25s\",bucket == 1, \"0.25s - 0.5s\",bucket == 2, \"0.5s - 0.75s\",bucket == 3, \"0.75s - 1s\",bucket == 4, \"1s - 1.25s\",bucket == 5, \"1.25s - 1.5s\",bucket == 6, \"1.5s - 1.75s\",bucket == 7, \"1.75s - 2s\",bucket == 8, \"2s - 2.25s\",bucket == 9, \"2.25s - 2.5s\",bucket == 10, \"2.5s - 2.75s\",bucket == 11, \"2.75s - 3s\",bucket == 12, \"3s - 3.25s\",bucket == 13, \"3.25s - 3.5s\",bucket == 14, \"3.5s - 3.75s\",bucket == 15, \"3.75s - 4s\",bucket == 16, \"4s - 4.25s\",bucket == 17, \"4.25s - 4.5s\",bucket == 18, \"4.5s - 4.75s\",bucket == 19, \"4.75s - 5s\", \"\")'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"0s - 0.25s\",bucket == 1, \"0.25s - 0.5s\",bucket == 2, \"0.5s - 0.75s\",bucket == 3, \"0.75s - 1s\",bucket == 4, \"1s - 1.25s\",bucket == 5, \"1.25s - 1.5s\",bucket == 6, \"1.5s - 1.75s\",bucket == 7, \"1.75s - 2s\",bucket == 8, \"2s - 2.25s\",bucket == 9, \"2.25s - 2.5s\",bucket == 10, \"2.5s - 2.75s\",bucket == 11, \"2.75s - 3s\",bucket == 12, \"3s - 3.25s\",bucket == 13, \"3.25s - 3.5s\",bucket == 14, \"3.5s - 3.75s\",bucket == 15, \"3.75s - 4s\",bucket == 16, \"4s - 4.25s\",bucket == 17, \"4.25s - 4.5s\",bucket == 18, \"4.5s - 4.75s\",bucket == 19, \"4.75s - 5s\", \"\")"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "46276124-a667-4cb0-926e-056a309b91f9",
            "version": "KqlParameterItem/1.0",
            "name": "bucketTooltip",
            "type": 1,
            "value": "case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"),bucket == 4, strcat(buckets[3]*100/100000.0 , \" s \", \"to\", \" \" , buckets[4]*100/100000.0, \" s\"),bucket == 5, strcat(buckets[4]*100/100000.0 , \" s \", \"to\", \" \" , buckets[5]*100/100000.0, \" s\"),bucket == 6, strcat(buckets[5]*100/100000.0 , \" s \", \"to\", \" \" , buckets[6]*100/100000.0, \" s\"),bucket == 7, strcat(buckets[6]*100/100000.0 , \" s \", \"to\", \" \" , buckets[7]*100/100000.0, \" s\"),bucket == 8, strcat(buckets[7]*100/100000.0 , \" s \", \"to\", \" \" , buckets[8]*100/100000.0, \" s\"),bucket == 9, strcat(buckets[8]*100/100000.0 , \" s \", \"to\", \" \" , buckets[9]*100/100000.0, \" s\"),bucket == 10, strcat(buckets[9]*100/100000.0 , \" s \", \"to\", \" \" , buckets[10]*100/100000.0, \" s\"),bucket == 11, strcat(buckets[10]*100/100000.0 , \" s \", \"to\", \" \" , buckets[11]*100/100000.0, \" s\"),bucket == 12, strcat(buckets[11]*100/100000.0 , \" s \", \"to\", \" \" , buckets[12]*100/100000.0, \" s\"),bucket == 13, strcat(buckets[12]*100/100000.0 , \" s \", \"to\", \" \" , buckets[13]*100/100000.0, \" s\"),bucket == 14, strcat(buckets[13]*100/100000.0 , \" s \", \"to\", \" \" , buckets[14]*100/100000.0, \" s\"),bucket == 15, strcat(buckets[14]*100/100000.0 , \" s \", \"to\", \" \" , buckets[15]*100/100000.0, \" s\"),bucket == 16, strcat(buckets[15]*100/100000.0 , \" s \", \"to\", \" \" , buckets[16]*100/100000.0, \" s\"),bucket == 17, strcat(buckets[16]*100/100000.0 , \" s \", \"to\", \" \" , buckets[17]*100/100000.0, \" s\"),bucket == 18, strcat(buckets[17]*100/100000.0 , \" s \", \"to\", \" \" , buckets[18]*100/100000.0, \" s\"),bucket == 19, strcat(buckets[18]*100/100000.0 , \" s \", \"to\", \" \" , buckets[19]*100/100000.0, \" s\"), \"\")",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "condition": "if (Bucketize == '0.5'), result = 'case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "0.5",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '10'), result = 'case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"),bucket == 4, strcat(buckets[3]*100/100000.0 , \" s \", \"to\", \" \" , buckets[4]*100/100000.0, \" s\"),bucket == 5, strcat(buckets[4]*100/100000.0 , \" s \", \"to\", \" \" , buckets[5]*100/100000.0, \" s\"),bucket == 6, strcat(buckets[5]*100/100000.0 , \" s \", \"to\", \" \" , buckets[6]*100/100000.0, \" s\"),bucket == 7, strcat(buckets[6]*100/100000.0 , \" s \", \"to\", \" \" , buckets[7]*100/100000.0, \" s\"),bucket == 8, strcat(buckets[7]*100/100000.0 , \" s \", \"to\", \" \" , buckets[8]*100/100000.0, \" s\"),bucket == 9, strcat(buckets[8]*100/100000.0 , \" s \", \"to\", \" \" , buckets[9]*100/100000.0, \" s\"), \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "10",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"),bucket == 4, strcat(buckets[3]*100/100000.0 , \" s \", \"to\", \" \" , buckets[4]*100/100000.0, \" s\"),bucket == 5, strcat(buckets[4]*100/100000.0 , \" s \", \"to\", \" \" , buckets[5]*100/100000.0, \" s\"),bucket == 6, strcat(buckets[5]*100/100000.0 , \" s \", \"to\", \" \" , buckets[6]*100/100000.0, \" s\"),bucket == 7, strcat(buckets[6]*100/100000.0 , \" s \", \"to\", \" \" , buckets[7]*100/100000.0, \" s\"),bucket == 8, strcat(buckets[7]*100/100000.0 , \" s \", \"to\", \" \" , buckets[8]*100/100000.0, \" s\"),bucket == 9, strcat(buckets[8]*100/100000.0 , \" s \", \"to\", \" \" , buckets[9]*100/100000.0, \" s\"), \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '25'), result = 'case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"), \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "25",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"), \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '1'), result = 'case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\", \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "1",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\", \"\")"
                }
              },
              {
                "condition": "if (Bucketize == '5'), result = 'case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"),bucket == 4, strcat(buckets[3]*100/100000.0 , \" s \", \"to\", \" \" , buckets[4]*100/100000.0, \" s\"),bucket == 5, strcat(buckets[4]*100/100000.0 , \" s \", \"to\", \" \" , buckets[5]*100/100000.0, \" s\"),bucket == 6, strcat(buckets[5]*100/100000.0 , \" s \", \"to\", \" \" , buckets[6]*100/100000.0, \" s\"),bucket == 7, strcat(buckets[6]*100/100000.0 , \" s \", \"to\", \" \" , buckets[7]*100/100000.0, \" s\"),bucket == 8, strcat(buckets[7]*100/100000.0 , \" s \", \"to\", \" \" , buckets[8]*100/100000.0, \" s\"),bucket == 9, strcat(buckets[8]*100/100000.0 , \" s \", \"to\", \" \" , buckets[9]*100/100000.0, \" s\"),bucket == 10, strcat(buckets[9]*100/100000.0 , \" s \", \"to\", \" \" , buckets[10]*100/100000.0, \" s\"),bucket == 11, strcat(buckets[10]*100/100000.0 , \" s \", \"to\", \" \" , buckets[11]*100/100000.0, \" s\"),bucket == 12, strcat(buckets[11]*100/100000.0 , \" s \", \"to\", \" \" , buckets[12]*100/100000.0, \" s\"),bucket == 13, strcat(buckets[12]*100/100000.0 , \" s \", \"to\", \" \" , buckets[13]*100/100000.0, \" s\"),bucket == 14, strcat(buckets[13]*100/100000.0 , \" s \", \"to\", \" \" , buckets[14]*100/100000.0, \" s\"),bucket == 15, strcat(buckets[14]*100/100000.0 , \" s \", \"to\", \" \" , buckets[15]*100/100000.0, \" s\"),bucket == 16, strcat(buckets[15]*100/100000.0 , \" s \", \"to\", \" \" , buckets[16]*100/100000.0, \" s\"),bucket == 17, strcat(buckets[16]*100/100000.0 , \" s \", \"to\", \" \" , buckets[17]*100/100000.0, \" s\"),bucket == 18, strcat(buckets[17]*100/100000.0 , \" s \", \"to\", \" \" , buckets[18]*100/100000.0, \" s\"),bucket == 19, strcat(buckets[18]*100/100000.0 , \" s \", \"to\", \" \" , buckets[19]*100/100000.0, \" s\"), \"\")'",
                "criteriaContext": {
                  "leftOperand": "Bucketize",
                  "operator": "==",
                  "rightValType": "static",
                  "rightVal": "5",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, strcat(0 , \" s \", \"to\", \" \" , buckets[0]*100/100000.0, \" s\"),bucket == 1, strcat(buckets[0]*100/100000.0 , \" s \", \"to\", \" \" , buckets[1]*100/100000.0, \" s\"),bucket == 2, strcat(buckets[1]*100/100000.0 , \" s \", \"to\", \" \" , buckets[2]*100/100000.0, \" s\"),bucket == 3, strcat(buckets[2]*100/100000.0 , \" s \", \"to\", \" \" , buckets[3]*100/100000.0, \" s\"),bucket == 4, strcat(buckets[3]*100/100000.0 , \" s \", \"to\", \" \" , buckets[4]*100/100000.0, \" s\"),bucket == 5, strcat(buckets[4]*100/100000.0 , \" s \", \"to\", \" \" , buckets[5]*100/100000.0, \" s\"),bucket == 6, strcat(buckets[5]*100/100000.0 , \" s \", \"to\", \" \" , buckets[6]*100/100000.0, \" s\"),bucket == 7, strcat(buckets[6]*100/100000.0 , \" s \", \"to\", \" \" , buckets[7]*100/100000.0, \" s\"),bucket == 8, strcat(buckets[7]*100/100000.0 , \" s \", \"to\", \" \" , buckets[8]*100/100000.0, \" s\"),bucket == 9, strcat(buckets[8]*100/100000.0 , \" s \", \"to\", \" \" , buckets[9]*100/100000.0, \" s\"),bucket == 10, strcat(buckets[9]*100/100000.0 , \" s \", \"to\", \" \" , buckets[10]*100/100000.0, \" s\"),bucket == 11, strcat(buckets[10]*100/100000.0 , \" s \", \"to\", \" \" , buckets[11]*100/100000.0, \" s\"),bucket == 12, strcat(buckets[11]*100/100000.0 , \" s \", \"to\", \" \" , buckets[12]*100/100000.0, \" s\"),bucket == 13, strcat(buckets[12]*100/100000.0 , \" s \", \"to\", \" \" , buckets[13]*100/100000.0, \" s\"),bucket == 14, strcat(buckets[13]*100/100000.0 , \" s \", \"to\", \" \" , buckets[14]*100/100000.0, \" s\"),bucket == 15, strcat(buckets[14]*100/100000.0 , \" s \", \"to\", \" \" , buckets[15]*100/100000.0, \" s\"),bucket == 16, strcat(buckets[15]*100/100000.0 , \" s \", \"to\", \" \" , buckets[16]*100/100000.0, \" s\"),bucket == 17, strcat(buckets[16]*100/100000.0 , \" s \", \"to\", \" \" , buckets[17]*100/100000.0, \" s\"),bucket == 18, strcat(buckets[17]*100/100000.0 , \" s \", \"to\", \" \" , buckets[18]*100/100000.0, \" s\"),bucket == 19, strcat(buckets[18]*100/100000.0 , \" s \", \"to\", \" \" , buckets[19]*100/100000.0, \" s\"), \"\")"
                }
              },
              {
                "condition": "else result = 'case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\",bucket == 10, \"\",bucket == 11, \"\",bucket == 12, \"\",bucket == 13, \"\",bucket == 14, \"\",bucket == 15, \"\",bucket == 16, \"\",bucket == 17, \"\",bucket == 18, \"\",bucket == 19, \"\", \"\")'",
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "case(bucket == 0, \"\",bucket == 1, \"\",bucket == 2, \"\",bucket == 3, \"\",bucket == 4, \"\",bucket == 5, \"\",bucket == 6, \"\",bucket == 7, \"\",bucket == 8, \"\",bucket == 9, \"\",bucket == 10, \"\",bucket == 11, \"\",bucket == 12, \"\",bucket == 13, \"\",bucket == 14, \"\",bucket == 15, \"\",bucket == 16, \"\",bucket == 17, \"\",bucket == 18, \"\",bucket == 19, \"\", \"\")"
                }
              }
            ],
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibility": {
        "parameterName": "BucketItem",
        "comparison": "isEqualTo",
        "value": "duration"
      },
      "name": "parameters - Duration"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let sampleSize = 10000000;\r\nlet unSampledImpactingEvents = union customEvents, pageViews, requests\r\n| where itemType == iff('{SelectEvent:label}' contains 'ðŸŸ¦', 'customEvent',  iff('{SelectEvent:label}' contains 'ðŸŸ¨', 'pageView', 'request'))\r\n| where timestamp {TimeRange}\r\n| where replace(\"\\n\", \"\",name) == '{SelectEvent}'\r\n{selectedEventFilters}\r\n| extend metric = todouble(duration)\r\n| extend metric = iff(isnull(metric), 0.0, metric)\r\n| project metric, timestamp, session_Id;\r\nlet totalImpactingEvents = toscalar(unSampledImpactingEvents | count);\r\nlet impactingSamplingRatio = iff(totalImpactingEvents == 0 or totalImpactingEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactingEvents);\r\nlet impactingEvents = unSampledImpactingEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id);\r\nlet unSampledImpactedEvents = union customEvents, pageViews\r\n| where itemType == iff('{ImpactItem:label}' contains 'ðŸŸ¦', 'customEvent', 'pageView')\r\n| where timestamp {TimeRange}\r\n| where replace(\"\\n\", \"\",name) =='{ImpactItem}'\r\n{impactingEventFilters};\r\nlet totalImpactedEvents = toscalar(unSampledImpactedEvents | count);\r\nlet impactedSamplingRatio = iff(totalImpactedEvents == 0 or totalImpactedEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactedEvents);\r\nlet impactedEvents = unSampledImpactedEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id)\r\n| summarize itemIds = makelist(itemId), timestamps = makelist(timestamp) by session_Id;\r\nlet mappedSessions = materialize( impactingEvents\r\n| join  kind= leftouter ( impactedEvents ) on session_Id);\r\nlet mappedImpactedMetrics = mappedSessions\r\n| mvexpand impactedEventTimeStamp = timestamps, impactedEventId = itemIds\r\n| extend impactedEventTimeStamp = todatetime(impactedEventTimeStamp)  \r\n| where timestamp < impactedEventTimeStamp\r\n| extend impactedEventId = tostring(impactedEventId)\r\n| summarize average= avg(metric) by impactedEventId\r\n| extend impactedMetricHappened = true;\r\nlet umappedPerformanceMetrics = mappedSessions\r\n| extend impactedEventsLen = arraylength(timestamps) - 1\r\n| where isnull(timestamps) or timestamp >= timestamps[impactedEventsLen]\r\n| summarize average = avg(metric) by session_Id\r\n| extend impactedMetricHappened = false;\r\nlet buckets = toscalar( union mappedImpactedMetrics, umappedPerformanceMetrics\r\n{bucketQuery}\r\n| project list );\r\nlet bucketize = (metric: double) {\r\n     {bucketizeFunc}\r\n};\r\nlet getBucketLabel = (bucket: int) {\r\n    {bucketLabel}\r\n};\r\nlet getBucketTooltip = (bucket: int) {\r\n    {bucketTooltip}\r\n};\r\nlet map =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| extend bucket = bucketize(average)\r\n| where bucket >= 0\r\n| summarize Performance = avg(average), totalActualSubsessions = countif(impactedMetricHappened), totalPotentialSubsessions = countif(impactedMetricHappened == false) by bucket\r\n| extend totalActualSubsessions = iff(isnull(totalActualSubsessions), 0.0, bin(totalActualSubsessions / impactedSamplingRatio, 1))\r\n| extend totalPotentialSubsessions = iff(isnull(totalPotentialSubsessions), 0.0, bin(totalPotentialSubsessions / impactingSamplingRatio, 1))\r\n| extend Total = totalActualSubsessions + totalPotentialSubsessions\r\n| extend ConversionRate =  iff(Total == 0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| project ConversionRate, Performance, Total;\r\nlet averagePerformance = toscalar(map\r\n| summarize avg(Performance));\r\nlet sumPerformance = toscalar(map\r\n| summarize sum(Performance));\r\nlet averageConversionRate = toscalar(map\r\n| summarize avg(ConversionRate));\r\nlet num = toscalar( map\r\n| extend perfDiff = Performance  - averagePerformance\r\n| extend convDiff = ConversionRate - averageConversionRate\r\n| extend mult = perfDiff * convDiff * Total\r\n| summarize sum(mult));\r\nlet den = toscalar( map\r\n| extend perfDiff = Performance  - averagePerformance\r\n| extend perfDiffSqr = perfDiff * perfDiff * Total\r\n| extend convDiff = ConversionRate - averageConversionRate\r\n| extend convDiffSqr = convDiff * convDiff * Total\r\n| summarize sumConv = sum(convDiffSqr), sumPerf = sum(perfDiffSqr)\r\n| extend sqr = sqrt(sumConv * sumPerf ) \r\n| project sqr );\r\nlet correlationdata = toscalar(range i from 1 to 1 step 1\r\n| extend correlation = num / den\r\n| project round(correlation,2));\r\nlet bucketResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| extend bucket = bucketize(average)\r\n| where bucket >= 0\r\n| summarize totalActualSubsessions = countif(impactedMetricHappened), totalPotentialSubsessions = countif(impactedMetricHappened == false), average = avg(average), avgList = makelist(average,1000) by bucket\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend medianIndex = arraylength(avgList) /2\r\n| extend median = todouble(avgList[medianIndex]);\r\nlet overallResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| summarize totalActualSubsessions = countif(impactedMetricHappened), totalPotentialSubsessions = countif(impactedMetricHappened == false), average = avg(average)\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend bucket = 10000\r\n| extend median = todouble(average);\r\nlet scatterTable = union overallResults, bucketResults\r\n| order by bucket asc\r\n| extend totalActualSubsessions = iff(isnull(totalActualSubsessions), 0.0, bin(totalActualSubsessions / impactedSamplingRatio, 1))\r\n| extend totalPotentialSubsessions = iff(isnull(totalPotentialSubsessions), 0.0, bin(totalPotentialSubsessions / impactingSamplingRatio, 1))\r\n| extend conversion = iff(isnull(conversion), 0.0, conversion)\r\n| extend label = getBucketLabel(bucket)\r\n| extend tooltip = getBucketTooltip(bucket)\r\n| extend total = totalActualSubsessions + totalPotentialSubsessions\r\n| project total, conversion, median, xy = tolong(median) * conversion * total, xx = tolong(median) * median * total;\r\n\r\nlet baseline = scatterTable\r\n| project total, conversion = (todouble(conversion) * total), median = (tolong(median) * total), xy = tolong(median) * conversion * total, xx = tolong(median) * median * total\r\n| summarize x = sum(median), y = sum(conversion), xy = sum(xy), xx=sum(xx), n = sum(total);\r\nlet slope = toscalar(baseline | project lineSlope = (n * xy - x* y) / (n * xx - x * x));\r\nlet intercept = toscalar(baseline | project (y - slope * x) / n);\r\nlet calcBaseline=(a:long) {\r\n    slope * a + intercept\r\n};\r\nlet maxmedian = toscalar(scatterTable\r\n| summarize m = tolong(max(median)));\r\nlet baselineData = range median from 1 to maxmedian step tolong(maxmedian/100)\r\n| project toreal(median), baseline = calcBaseline(tolong(median));\r\nscatterTable\r\n| project median, conversion\r\n| join kind=fullouter baselineData on median\r\n| project median = iff(isempty(median), median1, median), conversion, baseline, correlation =strcat(\"'\",correlationdata,\"'\")",
        "size": 0,
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "conditionalVisibility": {
        "parameterName": "1",
        "comparison": "isEqualTo",
        "value": "2"
      },
      "name": "query - impactData"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "1c6e7895-604a-4fee-aad9-06a525fad2fb",
            "version": "KqlParameterItem/1.0",
            "name": "correlationData",
            "type": 1,
            "isRequired": true,
            "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"41429b14-9993-45b7-a176-df3aa2222066\",\"mergeType\":\"table\",\"leftTable\":\"query - impactData\"}],\"projectRename\":[{\"originalName\":\"[query - impactData].correlation\",\"mergedName\":\"correlation\",\"fromId\":\"41429b14-9993-45b7-a176-df3aa2222066\"},{\"originalName\":\"[query - impactData].median\"},{\"originalName\":\"[query - impactData].conversion\"},{\"originalName\":\"[query - impactData].baseline\"}]}",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 7
          },
          {
            "id": "33def732-0edc-44dc-b6bd-f0fc7afab975",
            "version": "KqlParameterItem/1.0",
            "name": "validCorrelation",
            "type": 1,
            "isRequired": true,
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "correlationData",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "[]"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlationData",
                  "operator": "startsWith",
                  "rightValType": "static",
                  "rightVal": "[",
                  "resultValType": "param",
                  "resultVal": "correlationData"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "[{correlationData}]"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "2b4392f1-d2c3-4121-b99c-f7a05d5975cc",
            "version": "KqlParameterItem/1.0",
            "name": "correlation",
            "type": 1,
            "query": "datatable(value:string){validCorrelation}\r\n| take 1\r\n| project iff(isempty(value), 0.0, toreal(value))",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          },
          {
            "id": "14f405f5-dda1-4f11-b491-d1aa2f071835",
            "version": "KqlParameterItem/1.0",
            "name": "correlationTextStyle",
            "type": 1,
            "value": "Info",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "SelectEvent",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Info"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactItem",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Info"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Warning"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "0.3",
                  "resultValType": "static",
                  "resultVal": "Info"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">",
                  "rightValType": "static",
                  "rightVal": "-0.3",
                  "resultValType": "static",
                  "resultVal": "Warning"
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "-1",
                  "resultValType": "static",
                  "resultVal": "Info"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Warning"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "14f405f5-dda1-4f11-b491-d1aa2f071835",
            "version": "KqlParameterItem/1.0",
            "name": "correlationText",
            "type": 1,
            "value": "Please pick a \"Selected event\".",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "SelectEvent",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Please pick a \"Selected event\"."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "ImpactItem",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "Please pick an \"Impacting event\"."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": "is Empty",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "The \"{BucketItem}\" of \"{SelectEvent}\" does not impact the usage of \"{ImpactItem}\". (Correlation= 0)."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "0.75",
                  "resultValType": "static",
                  "resultVal": " Usage of \"{ImpactItem}\" increases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "0.5",
                  "resultValType": "static",
                  "resultVal": "Usage of \"{ImpactItem}\" somewhat increases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "0.3",
                  "resultValType": "static",
                  "resultVal": "Usage of \"{ImpactItem}\" weakly increases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">",
                  "rightValType": "static",
                  "rightVal": "-0.3",
                  "resultValType": "static",
                  "resultVal": "The \"{BucketItem}\" of \"{SelectEvent}\" does not impact the usage of \"{ImpactItem}\". (Correlation= {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">",
                  "rightValType": "static",
                  "rightVal": "-0.5",
                  "resultValType": "static",
                  "resultVal": "Usage of \"{ImpactItem}\" weakly decreases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">",
                  "rightValType": "static",
                  "rightVal": "-0.75",
                  "resultValType": "static",
                  "resultVal": "Usage of \"{ImpactItem}\" somewhat decreases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "leftOperand": "correlation",
                  "operator": ">=",
                  "rightValType": "static",
                  "rightVal": "-1",
                  "resultValType": "static",
                  "resultVal": "Usage of \"{ImpactItem}\" decreases as  \"{BucketItem}\" of \"{SelectEvent}\" increases (Correlation = {correlation})."
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "The \"{BucketItem}\" of \"{SelectEvent}\" does not impact the usage of \"{ImpactItem}\". (Correlation= {correlation})."
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters - 8"
    },
    {
      "type": 1,
      "content": {
        "json": "{correlationText}",
        "style": "{correlationTextStyle}"
      },
      "conditionalVisibility": {
        "parameterName": "BucketItem",
        "comparison": "isEqualTo",
        "value": "duration"
      },
      "name": "text - 5"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"41429b14-9993-45b7-a176-df3aa2222180\",\"mergeType\":\"table\",\"leftTable\":\"query - impactData\"}],\"projectRename\":[{\"originalName\":\"[query - impactData].median\",\"mergedName\":\"median\",\"fromId\":\"41429b14-9993-45b7-a176-df3aa2222180\"},{\"originalName\":\"[query - impactData].conversion\",\"mergedName\":\"conversion\",\"fromId\":\"41429b14-9993-45b7-a176-df3aa2222180\"},{\"originalName\":\"[query - impactData].baseline\",\"mergedName\":\"baseline\",\"fromId\":\"41429b14-9993-45b7-a176-df3aa2222180\"},{\"originalName\":\"[query - impactData].correlation\"}]}",
        "size": 0,
        "aggregation": 3,
        "title": "Rate of conversion of \"{ImpactItem}\" by \"{BucketItem}\" of \"{SelectEvent}\"",
        "queryType": 7,
        "visualization": "scatterchart",
        "sortBy": [],
        "chartSettings": {
          "seriesLabelSettings": [
            {
              "seriesName": "baseline",
              "label": "baseline",
              "color": "lightBlue",
              "comment": ""
            },
            {
              "seriesName": "conversion",
              "label": "conversion"
            }
          ]
        }
      },
      "conditionalVisibilities": [
        {
          "parameterName": "BucketItem",
          "comparison": "isEqualTo",
          "value": "duration"
        },
        {
          "parameterName": "SelectEvent",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "ImpactItem",
          "comparison": "isNotEqualTo"
        }
      ],
      "name": "query - 2"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "explicit",
        "loadButtonText": "Show data",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let sampleSize = 10000000;\r\nlet unSampledImpactingEvents = union customEvents, pageViews, requests\r\n| where itemType == iff('{SelectEvent:label}' contains 'ðŸŸ¦', 'customEvent',  iff('{SelectEvent:label}' contains 'ðŸŸ¨', 'pageView', 'request'))\r\n| where timestamp {TimeRange}\r\n| where replace(\"\\n\", \"\",name) == '{SelectEvent}'\r\n{selectedEventFilters}\r\n| extend metric = todouble(duration)\r\n| extend metric = iff(isnull(metric), 0.0, metric)\r\n| project metric, timestamp, session_Id;\r\nlet totalImpactingEvents = toscalar(unSampledImpactingEvents | count);\r\nlet impactingSamplingRatio = iff(totalImpactingEvents == 0 or totalImpactingEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactingEvents);\r\nlet impactingEvents = unSampledImpactingEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id);\r\nlet unSampledImpactedEvents = union customEvents, pageViews\r\n| where itemType == iff('{ImpactItem:label}' contains 'ðŸŸ¦', 'customEvent', 'pageView')\r\n| where timestamp {TimeRange}\r\n| where replace(\"\\n\", \"\",name) =='{ImpactItem}'\r\n{impactingEventFilters};\r\nlet totalImpactedEvents = toscalar(unSampledImpactedEvents | count);\r\nlet impactedSamplingRatio = iff(totalImpactedEvents == 0 or totalImpactedEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactedEvents);\r\nlet impactedEvents = unSampledImpactedEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id)\r\n| summarize itemIds = makelist(itemId), timestamps = makelist(timestamp) by session_Id;\r\nlet mappedSessions = materialize( impactingEvents\r\n| join  kind= leftouter ( impactedEvents ) on session_Id);\r\nlet mappedImpactedMetrics = mappedSessions\r\n| mvexpand impactedEventTimeStamp = timestamps, impactedEventId = itemIds\r\n| extend impactedEventTimeStamp = todatetime(impactedEventTimeStamp)  \r\n| where timestamp < impactedEventTimeStamp\r\n| extend impactedEventId = tostring(impactedEventId)\r\n| summarize average= avg(metric) by impactedEventId\r\n| extend impactedMetricHappened = true;\r\nlet umappedPerformanceMetrics = mappedSessions\r\n| extend impactedEventsLen = arraylength(timestamps) - 1\r\n| where isnull(timestamps) or timestamp >= timestamps[impactedEventsLen]\r\n| summarize average = avg(metric) by session_Id\r\n| extend impactedMetricHappened = false;\r\n\r\nlet buckets = toscalar( union mappedImpactedMetrics, umappedPerformanceMetrics\r\n{bucketQuery}\r\n| project list );\r\nlet bucketize = (metric: double) {\r\n    {bucketizeFunc}\r\n};\r\nlet getBucketLabel = (bucket: int) {\r\n    {bucketLabel}\r\n};\r\nlet getBucketTooltip = (bucket: int) {\r\n    {bucketTooltip}\r\n};\r\nlet bucketResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| extend bucket = bucketize(average)\r\n| where bucket >= 0\r\n| summarize totalActualSubsessions = countif(impactedMetricHappened), totalPotentialSubsessions = countif(impactedMetricHappened == false), average = avg(average), avgList = makelist(average,1000) by bucket\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend medianIndex = arraylength(avgList) /2\r\n| extend median = todouble(avgList[medianIndex]);\r\nlet overallResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| summarize totalActualSubsessions = countif(impactedMetricHappened), totalPotentialSubsessions = countif(impactedMetricHappened == false), average = avg(average)\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend bucket = 10000\r\n| extend median = todouble(average);\r\nlet formatter = (num: long) { \r\n    case( num < 1e3, tostring(num), \r\n          num < 1e6, strcat(tostring(round(num / 1e3, 2)), \"K\"),\r\n          num < 1e9, strcat(tostring(round(num / 1e6, 2)), \"M\"),\r\n          num < 1e12, strcat(tostring(round(num / 1e9, 2)), \"G\"),\r\n          num < 1e15, strcat(tostring(round(num / 1e12, 2)), \"T\"),\r\n          strcat(tostring(round(num / 1e15, 2)), \"P\"))};\r\nunion overallResults, bucketResults\r\n| order by bucket asc\r\n| extend totalActualSubsessions = iff(isnull(totalActualSubsessions), 0.0, bin(totalActualSubsessions / impactedSamplingRatio, 1))\r\n| extend totalPotentialSubsessions = iff(isnull(totalPotentialSubsessions), 0.0, bin(totalPotentialSubsessions / impactingSamplingRatio, 1))\r\n| extend conversion = iff(isnull(conversion), 0.0, conversion)\r\n| extend label = getBucketLabel(bucket)\r\n| extend tooltip = getBucketTooltip(bucket)\r\n| extend total = totalActualSubsessions + totalPotentialSubsessions\r\n| project Bucket = iff(isempty(label), \"Overall\" , label), ['\"{ImpactItem}\" Usage'] = strcat( formatter(total), \" events with \", formatter(totalActualSubsessions), \" converted and \", formatter(totalPotentialSubsessions), \" lost\"), ['Conversion Rate']= 100* conversion",
              "size": 0,
              "title": "\"{ImpactItem}\" usage bucketized by \"{BucketItem}\" of \"{SelectEvent}\"",
              "timeContext": {
                "durationMs": 86400000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Usage converted",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Usage lost",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Total Events",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Conversion Rate",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 1
                      }
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "conditionalVisibility": {
              "parameterName": "BucketItem",
              "comparison": "isEqualTo",
              "value": "duration"
            },
            "name": "query - 4"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let sampleSize = 10000000;\r\nlet successColum = strcat(\"\\\"\", strcat('\\'{ImpactItem}\\'',' Usage converted'),\"\\\"\");\r\nlet unSampledImpactingEvents = union customEvents, pageViews, requests\r\n| where itemType == iff('{SelectEvent:label}' contains 'ðŸŸ¦', 'customEvent',  iff('{SelectEvent:label}' contains 'ðŸŸ¨', 'pageView', 'request'))\r\n| where timestamp {TimeRange}\r\n| where name == '{SelectEvent}'\r\n{selectedEventFilters}\r\n| project bucket = {BucketItem}, timestamp, session_Id;\r\nlet totalImpactingEvents = toscalar(unSampledImpactingEvents | count);\r\nlet impactingSamplingRatio = iff(totalImpactingEvents == 0 or totalImpactingEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactingEvents);\r\nlet impactingEvents = unSampledImpactingEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id);\r\nlet unSampledImpactedEvents = union customEvents, pageViews\r\n| where itemType == iff('{ImpactItem:label}' contains 'ðŸŸ¦', 'customEvent', 'pageView')\r\n| where timestamp {TimeRange}\r\n| where name =='{ImpactItem}'\r\n{impactingEventFilters};\r\nlet totalImpactedEvents = toscalar(unSampledImpactedEvents | count);\r\nlet impactedSamplingRatio = iff(totalImpactedEvents == 0 or totalImpactedEvents <= sampleSize, 1.0, 1.0 * sampleSize / totalImpactedEvents);\r\nlet impactedEvents = unSampledImpactedEvents\r\n| sample sampleSize\r\n| extend session_Id = hash(session_Id)\r\n| summarize itemIds = makelist(itemId), timestamps = makelist(timestamp)  by session_Id;\r\nlet mappedSessions = materialize( impactingEvents\r\n| join  kind= leftouter ( impactedEvents ) on session_Id);\r\nlet mappedImpactedMetrics = mappedSessions\r\n| mvexpand impactedEventTimeStamp = timestamps, impactedEventId = itemIds\r\n| extend impactedEventTimeStamp = todatetime(impactedEventTimeStamp)  \r\n| where timestamp < impactedEventTimeStamp\r\n| extend impactedEventId = tostring(impactedEventId)\r\n| summarize buckets = makelist(bucket), total = count() by impactedEventId\r\n| mvexpand buckets\r\n| extend bucket = tostring(buckets)\r\n| summarize bucketCount = count(), total=any(total) by impactedEventId, bucket\r\n| extend value = bucketCount * 1.0 / total\r\n| extend impactedMetricHappened = true;\r\nlet umappedPerformanceMetrics = mappedSessions\r\n| extend impactedEventsLen = arraylength(timestamps) - 1\r\n| where isnull(timestamps) or timestamp >= timestamps[impactedEventsLen]\r\n| summarize buckets = makelist(bucket), total = count() by session_Id\r\n| mvexpand buckets\r\n| extend bucket = tostring(buckets)\r\n| summarize bucketCount = count(), total=any(total) by session_Id, bucket\r\n| extend value = bucketCount * 1.0 / total\r\n| extend impactedMetricHappened = false;\r\nlet bucketResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| summarize totalActualSubsessions = sumif(value, impactedMetricHappened), totalPotentialSubsessions = sumif(value, impactedMetricHappened == false) by bucket\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0.0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend bucket = iif(isempty(bucket), \"<undefined>\", bucket), position = 0;\r\nlet overallResults =  union mappedImpactedMetrics, umappedPerformanceMetrics\r\n| summarize totalActualSubsessions = sumif(value, impactedMetricHappened), totalPotentialSubsessions = sumif(value, impactedMetricHappened == false)\r\n| extend conversion =  iff(totalActualSubsessions + totalPotentialSubsessions == 0.0, 0.0, totalActualSubsessions / (totalActualSubsessions + totalPotentialSubsessions * 1.0))\r\n| extend bucket = \"Overall\", position = 1;\r\nlet formatter = (num: long) { \r\n    case( num < 1e3, tostring(num), \r\n          num < 1e6, strcat(tostring(round(num / 1e3, 2)), \"K\"),\r\n          num < 1e9, strcat(tostring(round(num / 1e6, 2)), \"M\"),\r\n          num < 1e12, strcat(tostring(round(num / 1e9, 2)), \"G\"),\r\n          num < 1e15, strcat(tostring(round(num / 1e12, 2)), \"T\"),\r\n          strcat(tostring(round(num / 1e15, 2)), \"P\"))};\r\nunion overallResults, bucketResults\r\n| extend totalActualSubsessions = iff(isnull(totalActualSubsessions), 0.0, bin(totalActualSubsessions / impactedSamplingRatio, 1))\r\n| extend totalPotentialSubsessions = iff(isnull(totalPotentialSubsessions), 0.0, bin(totalPotentialSubsessions / impactingSamplingRatio, 1))\r\n| extend conversion = iff(isnull(conversion), 0.0, conversion)\r\n| extend total = totalActualSubsessions + totalPotentialSubsessions\r\n| order by position asc, bucket asc\r\n| project Bucket = iff(isempty(bucket), \"Overall\" , bucket), ['\"{ImpactItem}\" Usage'] = strcat( formatter(total), \" events with \", formatter(totalActualSubsessions), \" converted and \", formatter(totalPotentialSubsessions), \" lost\"), ['Conversion Rate']= 100* conversion\r\n",
              "size": 0,
              "title": "\"{ImpactItem}\" usage bucketized by \"{BucketItem}\" of \"{SelectEvent}\"",
              "timeContext": {
                "durationMs": 86400000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.insights/components",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Usage converted",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 1
                      }
                    }
                  },
                  {
                    "columnMatch": "Usage lost",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 1
                      }
                    }
                  },
                  {
                    "columnMatch": "Total Events",
                    "formatter": 0,
                    "formatOptions": {},
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 1
                      }
                    }
                  },
                  {
                    "columnMatch": "Conversion Rate",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 1,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumFractionDigits": 1
                      }
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "conditionalVisibility": {
              "parameterName": "BucketItem",
              "comparison": "isNotEqualTo",
              "value": "duration"
            },
            "name": "query - 6"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "SelectEvent",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "ImpactItem",
          "comparison": "isNotEqualTo"
        }
      ],
      "name": "group - 8"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
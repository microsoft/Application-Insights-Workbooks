{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Ransomware Dashboard Based on MITRE ATT&CK® Framework"
            },
            "customWidth": "50",
            "name": "Title"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "a6e13e68-d578-4ced-80f6-efd768fb0ac1",
                  "version": "KqlParameterItem/1.0",
                  "name": "Subscription",
                  "type": 6,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "value": [
                    "value::all"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "includeAll": false,
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "c30541ed-6ac1-49c4-9372-fec452bef9bb",
                  "version": "KqlParameterItem/1.0",
                  "name": "ShowHelp",
                  "label": "Show Help",
                  "type": 10,
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": []
                  },
                  "jsonData": "[{ \"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true }, { \"value\": \"No\", \"label\": \"No\"}]"
                }
              ],
              "style": "above",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "customWidth": "30",
            "name": "parameters - 4"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\r\n| where type =~ 'microsoft.security/securescores'\r\n| where properties.score.current > 0 and properties.environment == 'Azure' and name != 'scoreGraceExcluded'\r\n| extend scoreXweight = todouble(properties.score.percentage) * todouble(properties.weight)\r\n| summarize topi = sum(scoreXweight), bottomi = sum(todouble(properties.weight))\r\n| extend securescore = 100*(topi/bottomi)",
              "size": 3,
              "title": "Secure Score",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "securescore",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 1,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 0
                    }
                  },
                  "tooltipFormat": {
                    "tooltip": "Secure Score"
                  }
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "securescore"
          }
        ],
        "exportParameters": true
      },
      "name": "Header Group"
    },
    {
      "type": 1,
      "content": {
        "json": "For more information on how to use this workbook to improve your security posture against ransomware watch [this video](https://www.youtube.com/watch?v=EOEd61Y0Vis).\r\nTo understand what Healthy, Unhealthy, Not Applicable in the recommendations mean, please refer to [our documentation](https://docs.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations#monitor-recommendations-)\r\n\r\n> **Healthy resources** – Relevant resources which either aren't impacted or on which you've already remediated the issue.\r\n\r\n> **Unhealthy resources** – Resources which are still impacted by the identified issue.\r\n\r\n> **Not applicable resources** – Resources for which the recommendation can't give a definitive answer.\r\n>> i.e. \"Findings have not been received yet for the VM\", \"The extension might be corrupted, please try to remove it and deploy again\".",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "ShowHelp",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "title"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "dd32f236-e096-40be-864e-6ce09d9973b2",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Health Overview by Tactic",
            "subTarget": "overviewhealth",
            "style": "link"
          },
          {
            "id": "906e1582-7c6a-41af-9ee2-5d3243d3dba0",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Health Overview by Technique",
            "subTarget": "tecniquerecommendations",
            "style": "link"
          },
          {
            "id": "05031fc3-c5c8-4410-b08f-6868f5174421",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Recommendations",
            "subTarget": "rectec",
            "style": "link"
          }
        ]
      },
      "name": "links - 14"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "> This graph shows all resources that appear under recommendations that fall into a Tactic. A single resource may or not have three different states (healthy, unhealthy, not applicable) at the same time depending on the recommendations that audited it.",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "ShowHelp",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "text - 8"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend tactic = properties.metadata.tactics\r\n    | extend healthState = properties.status.code\r\n    | where isnotnull(tactic)\r\n    | mvexpand tactic\r\n    | project id, tactic, healthState\r\n    | summarize Total=count(healthState), Healthy=countif(healthState=='Healthy'), Unhealthy=countif(healthState=='Unhealthy'), NotApplicable=countif(healthState=='NotApplicable') by tostring(tactic)\r\n    | sort by Total desc",
                    "size": 2,
                    "showExportToExcel": true,
                    "queryType": 1,
                    "resourceType": "microsoft.resourcegraph/resources",
                    "crossComponentResources": [
                      "{Subscription}"
                    ],
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "tactic",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "Total",
                          "formatter": 22,
                          "formatOptions": {
                            "compositeBarSettings": {
                              "labelText": "",
                              "columnSettings": [
                                {
                                  "columnName": "Healthy",
                                  "color": "green"
                                },
                                {
                                  "columnName": "Unhealthy",
                                  "color": "redBright"
                                },
                                {
                                  "columnName": "NotApplicable",
                                  "color": "gray"
                                }
                              ]
                            },
                            "customColumnWidthSetting": "30ch"
                          }
                        },
                        {
                          "columnMatch": "Healthy",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Unhealthy",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "NotApplicable",
                          "formatter": 5
                        }
                      ],
                      "rowLimit": 1000,
                      "labelSettings": [
                        {
                          "columnId": "tactic",
                          "label": "Tactic"
                        },
                        {
                          "columnId": "Total",
                          "label": "Total"
                        }
                      ]
                    }
                  },
                  "name": "techniques"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "SelectedTab",
              "comparison": "isEqualTo",
              "value": "overviewhealth"
            },
            "name": "TacticsList"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "overviewhealth"
      },
      "name": "HealthOverviewByTactic"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "The number of unhealthy resources may differ from the Health Overview by Tactics/Techniques Tabs according to the Techniques that you select in this page and this is an expected behavior. ",
              "style": "info"
            },
            "conditionalVisibility": {
              "parameterName": "ShowHelp",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "text - 5"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "99a3e735-2ce4-4721-b8a9-79b12f6f3f2a",
                  "version": "KqlParameterItem/1.0",
                  "name": "Techniques",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":\"Active Scanning\", \"label\":\"Active Scanning\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Gather Victim Network Information\", \"label\":\"Gather Victim Network Information\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Search Victim-Owned Websites\", \"label\":\"Search Victim-Owned Websites\", \"group\":\"Reconnaissance\" },\r\n    { \"value\":\"Obtain Capabilities\", \"label\":\"Obtain Capabilities\", \"group\":\"Resource Development\" },\r\n    { \"value\":\"Compromise Infrastructure\", \"label\":\"Compromise Infrastructure\", \"group\":\"Resource Development\" },\r\n    { \"value\":\"Brute Force\", \"label\":\"Brute Force\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Drive-by Compromise\", \"label\":\"Drive-by Compromise\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Exploit Public-Facing Application\", \"label\":\"Exploit Public-Facing Application\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Exploitation of Remote Services\", \"label\":\"Exploitation of Remote Services\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"External Remote Services\", \"label\":\"External Remote Services\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Phishing\", \"label\":\"Phishing\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Supply Chain Compromise\", \"label\":\"Supply Chain Compromise\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Trusted Relationship\", \"label\":\"Trusted Relationship\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Valid Accounts\", \"label\":\"Valid Accounts\", \"group\":\"Initial Access\" },\r\n    { \"value\":\"Command and Scripting Interpreter\", \"label\":\"Command and Scripting Interpreter\", \"group\":\"Execution\" },\r\n    { \"value\":\"Exploitation for Client Execution\", \"label\":\"Exploitation for Client Execution\", \"group\":\"Execution\" },\r\n    { \"value\":\"Inter-Process Communication\", \"label\":\"Inter-Process Communication\", \"group\":\"Execution\" },\r\n    { \"value\":\"Scheduled Task/Job\", \"label\":\"Scheduled Task/Job\", \"group\":\"Execution\" },\r\n    { \"value\":\"Software Deployment Tools\", \"label\":\"Software Deployment Tools\", \"group\":\"Execution\" },\r\n    { \"value\":\"User Execution\", \"label\":\"User Execution\", \"group\":\"Execution\" },\r\n    { \"value\":\"Windows Management Instrumentation\", \"label\":\"Windows Management Instrumentation\", \"group\":\"Execution\" },\r\n    { \"value\":\"Account Manipulation\", \"label\":\"Account Manipulation\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Boot or Logon Autostart Execution\", \"label\":\"Boot or Logon Autostart Execution\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Compromise Client Software Binary\", \"label\":\"Compromise Client Software Binary\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Create Account\", \"label\":\"Create Account\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Create or Modify System Process\", \"label\":\"Create or Modify System Process\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Event Triggered Execution\", \"label\":\"Event Triggered Execution\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Hijack Execution Flow\", \"label\":\"Hijack Execution Flow\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Implant Container Image\", \"label\":\"Implant Container Image\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Modify Authentication Process\", \"label\":\"Modify Authentication Process\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Office Application Startup\", \"label\":\"Office Application Startup\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Pre-OS Boot\", \"label\":\"Pre-OS Boot\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Server Software Component\", \"label\":\"Server Software Component\", \"group\":\"Persistence\" },\r\n    { \"value\":\"SQL Stored Procedures\", \"label\":\"SQL Stored Procedures\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Valid Accounts\", \"label\":\"Valid Accounts\", \"group\":\"Persistence\" },\r\n    { \"value\":\"Abuse Elevation Control Mechanism\", \"label\":\"Abuse Elevation Control Mechanism\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Boot or Logon Initialization Scripts\", \"label\":\"Boot or Logon Initialization Scripts\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Event Triggered Execution\", \"label\":\"Event Triggered Execution\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Exploitation for Privilege Escalation\", \"label\":\"Exploitation for Privilege Escalation\", \"group\":\"Privilege Escalation\" },\r\n    { \"value\":\"Access Token Manipulation\", \"label\":\"Access Token Manipulation\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Deobfuscate/Decode Files or Information\", \"label\":\"Deobfuscate/Decode Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Exploit Public-Facing Application\", \"label\":\"Exploit Public-Facing Application\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Exploitation for Defense Evasion\", \"label\":\"Exploitation for Defense Evasion\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"File and Directory Permissions Modification\", \"label\":\"File and Directory Permissions Modification\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Hide Artifacts\", \"label\":\"Hide Artifacts\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Hijack Execution Flow\", \"label\":\"Hijack Execution Flow\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Impair Defenses\", \"label\":\"Impair Defenses\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Indicator Removal on Host\", \"label\":\"Indicator Removal on Host\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Indirect Command Execution\", \"label\":\"Indirect Command Execution\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Masquerading\", \"label\":\"Masquerading\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Modify Registry\", \"label\":\"Modify Registry\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Obuscated Files or Information\", \"label\":\"Obuscated Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Obfuscated Files or Information\", \"label\":\"Obfuscated Files or Information\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Pre-OS Boot\", \"label\":\"Pre-OS Boot\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Process Injection\", \"label\":\"Process Injection\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Server Software Component\", \"label\":\"Server Software Component\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Signed Binary Proxy Execution\", \"label\":\"Signed Binary Proxy Execution\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Subvert Trust Controls\", \"label\":\"Subvert Trust Controls\", \"group\":\"Defense Evasion\" },\r\n    { \"value\":\"Brute Force\", \"label\":\"Brute Force\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Credentials from Password Stores\", \"label\":\"Credentials from Password Stores\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Exploitation for Credential Access\", \"label\":\"Exploitation for Credential Access\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Input Capture\", \"label\":\"Input Capture\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Man-in-the-Middle\", \"label\":\"Man-in-the-Middle\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Modify Authentication Process\", \"label\":\"Modify Authentication Process\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"OS Credential Dumping\", \"label\":\"OS Credential Dumping\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Steal or Forge Kerberos Tickets\", \"label\":\"Steal or Forge Kerberos Tickets\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Unsecured Credentials\", \"label\":\"Unsecured Credentials\", \"group\":\"Credential Access\" },\r\n    { \"value\":\"Account Discovery\", \"label\":\"Account Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Infrastructure Discovery\", \"label\":\"Cloud Infrastructure Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Service Dashboard\", \"label\":\"Cloud Service Dashboard\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Cloud Service Discovery\", \"label\":\"Cloud Service Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Container and Resource Discovery\", \"label\":\"Container and Resource Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Domain Trust Discovery\", \"label\":\"Domain Trust Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"File and Directory Discovery\", \"label\":\"File and Directory Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Network Service Scanning\", \"label\":\"Network Service Scanning\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Network Sniffing\", \"label\":\"Network Sniffing\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Permission Groups Discovery\", \"label\":\"Permission Groups Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Process Discovery\", \"label\":\"Process Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Query Registry\", \"label\":\"Query Registry\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Remote System Discovery\", \"label\":\"Remote System Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"System Information Discovery\", \"label\":\"System Information Discovery\", \"group\":\"Discovery\" },\r\n    { \"value\":\"Exploitation of Remote Services\", \"label\":\"Exploitation of Remote Services\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Lateral Tool Transfer\", \"label\":\"Lateral Tool Transfer\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Remote Service Session Hijacking\", \"label\":\"Remote Service Session Hijacking\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Remote Services\", \"label\":\"Remote Services\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Taint Shared Content\", \"label\":\"Taint Shared Content\", \"group\":\"Lateral Movement\" },\r\n    { \"value\":\"Audio Capture\", \"label\":\"Audio Capture\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Cloud Storage Object\", \"label\":\"Data from Cloud Storage Object\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Configuration Repository\", \"label\":\"Data from Configuration Repository\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Information Repositories\", \"label\":\"Data from Information Repositories\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data from Local System\", \"label\":\"Data from Local System\", \"group\":\"Collection\" },\r\n    { \"value\":\"Data Staged\", \"label\":\"Data Staged\", \"group\":\"Collection\" },\r\n    { \"value\":\"Man-in-the-Middle\", \"label\":\"Man-in-the-Middle\", \"group\":\"Collection\" },\r\n    { \"value\":\"Screen Capture\", \"label\":\"Screen Capture\", \"group\":\"Collection\" },\r\n    { \"value\":\"Application Layer Protocol\", \"label\":\"Application Layer Protocol\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Dynamic Resolution\", \"label\":\"Dynamic Resolution\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Fallback Channels\", \"label\":\"Fallback Channels\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Ingress Tool Transfer\", \"label\":\"Ingress Tool Transfer\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Non-Application Layer Protocol\", \"label\":\"Non-Application Layer Protocol\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Non-Standard Port\", \"label\":\"Non-Standard Port\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Protocol Tunneling\", \"label\":\"Protocol Tunneling\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Proxy\", \"label\":\"Proxy\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Remote Access Software\", \"label\":\"Remote Access Software\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Traffic Signaling\", \"label\":\"Traffic Signaling\", \"group\":\"Command and Control\" },\r\n    { \"value\":\"Exfiltration Over Alternative Protocol\", \"label\":\"Exfiltration Over Alternative Protocol\", \"group\":\"Exfiltration\" },\r\n    { \"value\":\"Transfer Data to Cloud Account\", \"label\":\"Transfer Data to Cloud Account\", \"group\":\"Exfiltration\" },\r\n    { \"value\":\"Data Destruction\", \"label\":\"Data Destruction\", \"group\":\"Impact\" },\r\n    { \"value\":\"Data Encrypted for Impact\", \"label\":\"Data Encrypted for Impact\", \"group\":\"Impact\" },\r\n    { \"value\":\"Data Manipulation\", \"label\":\"Data Manipulation\", \"group\":\"Impact\" },\r\n    { \"value\":\"Defacement\", \"label\":\"Defacement\", \"group\":\"Impact\" },\r\n    { \"value\":\"Disk Wipe\", \"label\":\"Disk Wipe\", \"group\":\"Impact\" },\r\n    { \"value\":\"Endpoint Denial of Service\", \"label\":\"Endpoint Denial of Service\", \"group\":\"Impact\" },\r\n    { \"value\":\"Network Denial of Service\", \"label\":\"Network Denial of Service\", \"group\":\"Impact\" },\r\n    { \"value\":\"Resource Hijacking\", \"label\":\"Resource Hijacking\", \"group\":\"Impact\" },\r\n    { \"value\":\"Service Stop\", \"label\":\"Service Stop\", \"group\":\"Impact\" }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all"
                },
                {
                  "id": "6913fc40-d43b-42f4-a995-358523326a2e",
                  "version": "KqlParameterItem/1.0",
                  "name": "Status",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n{\"value\": \"Healthy\", \"label\":\"Healthy\"},\r\n{\"value\": \"Unhealthy\", \"label\":\"Unhealthy\", \"selected\":true},\r\n{\"value\": \"NotApplicable\", \"label\":\"Not Applicable\"}\r\n]\r\n    \r\n ",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 23"
          },
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "4c6e30dc-8fb1-41e8-8607-6c1efd95ca1b",
                  "version": "KqlParameterItem/1.0",
                  "name": "TechniquesDrilldownFilter",
                  "type": 1,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Techniques",
                        "operator": "isNotNull",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "value in ({Techniques})"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                },
                {
                  "id": "dc29ac1c-40b5-4921-9b39-de824deeaf16",
                  "version": "KqlParameterItem/1.0",
                  "name": "HealthDrillDownFilter",
                  "type": 1,
                  "criteriaData": [
                    {
                      "criteriaContext": {
                        "leftOperand": "Status",
                        "operator": "isNotNull",
                        "rightValType": "param",
                        "resultValType": "static",
                        "resultVal": "healthState in ({Status})"
                      }
                    },
                    {
                      "criteriaContext": {
                        "operator": "Default",
                        "resultValType": "static",
                        "resultVal": "true"
                      }
                    }
                  ],
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibility": {
              "parameterName": "DebugVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "parameters - 2"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n    { \\\"value\\\":\\\"Active Scanning\\\", \\\"label\\\":\\\"Active Scanning\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Gather Victim Network Information\\\", \\\"label\\\":\\\"Gather Victim Network Information\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Search Victim-Owned Websites\\\", \\\"label\\\":\\\"Search Victim-Owned Websites\\\", \\\"group\\\":\\\"Reconnaissance\\\" },\\r\\n    { \\\"value\\\":\\\"Obtain Capabilities\\\", \\\"label\\\":\\\"Obtain Capabilities\\\", \\\"group\\\":\\\"Resource Development\\\" },\\r\\n    { \\\"value\\\":\\\"Compromise Infrastructure\\\", \\\"label\\\":\\\"Compromise Infrastructure\\\", \\\"group\\\":\\\"Resource Development\\\" },\\r\\n    { \\\"value\\\":\\\"Brute Force\\\", \\\"label\\\":\\\"Brute Force\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Drive-by Compromise\\\", \\\"label\\\":\\\"Drive-by Compromise\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploit Public-Facing Application\\\", \\\"label\\\":\\\"Exploit Public-Facing Application\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation of Remote Services\\\", \\\"label\\\":\\\"Exploitation of Remote Services\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"External Remote Services\\\", \\\"label\\\":\\\"External Remote Services\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Phishing\\\", \\\"label\\\":\\\"Phishing\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Supply Chain Compromise\\\", \\\"label\\\":\\\"Supply Chain Compromise\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Trusted Relationship\\\", \\\"label\\\":\\\"Trusted Relationship\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Valid Accounts\\\", \\\"label\\\":\\\"Valid Accounts\\\", \\\"group\\\":\\\"Initial Access\\\" },\\r\\n    { \\\"value\\\":\\\"Command and Scripting Interpreter\\\", \\\"label\\\":\\\"Command and Scripting Interpreter\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Client Execution\\\", \\\"label\\\":\\\"Exploitation for Client Execution\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Inter-Process Communication\\\", \\\"label\\\":\\\"Inter-Process Communication\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Scheduled Task/Job\\\", \\\"label\\\":\\\"Scheduled Task/Job\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Software Deployment Tools\\\", \\\"label\\\":\\\"Software Deployment Tools\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"User Execution\\\", \\\"label\\\":\\\"User Execution\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Windows Management Instrumentation\\\", \\\"label\\\":\\\"Windows Management Instrumentation\\\", \\\"group\\\":\\\"Execution\\\" },\\r\\n    { \\\"value\\\":\\\"Account Manipulation\\\", \\\"label\\\":\\\"Account Manipulation\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Boot or Logon Autostart Execution\\\", \\\"label\\\":\\\"Boot or Logon Autostart Execution\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Compromise Client Software Binary\\\", \\\"label\\\":\\\"Compromise Client Software Binary\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Create Account\\\", \\\"label\\\":\\\"Create Account\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Create or Modify System Process\\\", \\\"label\\\":\\\"Create or Modify System Process\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Event Triggered Execution\\\", \\\"label\\\":\\\"Event Triggered Execution\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Hijack Execution Flow\\\", \\\"label\\\":\\\"Hijack Execution Flow\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Implant Container Image\\\", \\\"label\\\":\\\"Implant Container Image\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Authentication Process\\\", \\\"label\\\":\\\"Modify Authentication Process\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Office Application Startup\\\", \\\"label\\\":\\\"Office Application Startup\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Pre-OS Boot\\\", \\\"label\\\":\\\"Pre-OS Boot\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Server Software Component\\\", \\\"label\\\":\\\"Server Software Component\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"SQL Stored Procedures\\\", \\\"label\\\":\\\"SQL Stored Procedures\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Valid Accounts\\\", \\\"label\\\":\\\"Valid Accounts\\\", \\\"group\\\":\\\"Persistence\\\" },\\r\\n    { \\\"value\\\":\\\"Abuse Elevation Control Mechanism\\\", \\\"label\\\":\\\"Abuse Elevation Control Mechanism\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Boot or Logon Initialization Scripts\\\", \\\"label\\\":\\\"Boot or Logon Initialization Scripts\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Event Triggered Execution\\\", \\\"label\\\":\\\"Event Triggered Execution\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Privilege Escalation\\\", \\\"label\\\":\\\"Exploitation for Privilege Escalation\\\", \\\"group\\\":\\\"Privilege Escalation\\\" },\\r\\n    { \\\"value\\\":\\\"Access Token Manipulation\\\", \\\"label\\\":\\\"Access Token Manipulation\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Deobfuscate/Decode Files or Information\\\", \\\"label\\\":\\\"Deobfuscate/Decode Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Exploit Public-Facing Application\\\", \\\"label\\\":\\\"Exploit Public-Facing Application\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Defense Evasion\\\", \\\"label\\\":\\\"Exploitation for Defense Evasion\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"File and Directory Permissions Modification\\\", \\\"label\\\":\\\"File and Directory Permissions Modification\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Hide Artifacts\\\", \\\"label\\\":\\\"Hide Artifacts\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Hijack Execution Flow\\\", \\\"label\\\":\\\"Hijack Execution Flow\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Impair Defenses\\\", \\\"label\\\":\\\"Impair Defenses\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Indicator Removal on Host\\\", \\\"label\\\":\\\"Indicator Removal on Host\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Indirect Command Execution\\\", \\\"label\\\":\\\"Indirect Command Execution\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Masquerading\\\", \\\"label\\\":\\\"Masquerading\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Registry\\\", \\\"label\\\":\\\"Modify Registry\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Obuscated Files or Information\\\", \\\"label\\\":\\\"Obuscated Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Obfuscated Files or Information\\\", \\\"label\\\":\\\"Obfuscated Files or Information\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Pre-OS Boot\\\", \\\"label\\\":\\\"Pre-OS Boot\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Process Injection\\\", \\\"label\\\":\\\"Process Injection\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Server Software Component\\\", \\\"label\\\":\\\"Server Software Component\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Signed Binary Proxy Execution\\\", \\\"label\\\":\\\"Signed Binary Proxy Execution\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Subvert Trust Controls\\\", \\\"label\\\":\\\"Subvert Trust Controls\\\", \\\"group\\\":\\\"Defense Evasion\\\" },\\r\\n    { \\\"value\\\":\\\"Brute Force\\\", \\\"label\\\":\\\"Brute Force\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Credentials from Password Stores\\\", \\\"label\\\":\\\"Credentials from Password Stores\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation for Credential Access\\\", \\\"label\\\":\\\"Exploitation for Credential Access\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Input Capture\\\", \\\"label\\\":\\\"Input Capture\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Man-in-the-Middle\\\", \\\"label\\\":\\\"Man-in-the-Middle\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Modify Authentication Process\\\", \\\"label\\\":\\\"Modify Authentication Process\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"OS Credential Dumping\\\", \\\"label\\\":\\\"OS Credential Dumping\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Steal or Forge Kerberos Tickets\\\", \\\"label\\\":\\\"Steal or Forge Kerberos Tickets\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Unsecured Credentials\\\", \\\"label\\\":\\\"Unsecured Credentials\\\", \\\"group\\\":\\\"Credential Access\\\" },\\r\\n    { \\\"value\\\":\\\"Account Discovery\\\", \\\"label\\\":\\\"Account Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Infrastructure Discovery\\\", \\\"label\\\":\\\"Cloud Infrastructure Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Service Dashboard\\\", \\\"label\\\":\\\"Cloud Service Dashboard\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Cloud Service Discovery\\\", \\\"label\\\":\\\"Cloud Service Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Container and Resource Discovery\\\", \\\"label\\\":\\\"Container and Resource Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Domain Trust Discovery\\\", \\\"label\\\":\\\"Domain Trust Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"File and Directory Discovery\\\", \\\"label\\\":\\\"File and Directory Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Network Service Scanning\\\", \\\"label\\\":\\\"Network Service Scanning\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Network Sniffing\\\", \\\"label\\\":\\\"Network Sniffing\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Permission Groups Discovery\\\", \\\"label\\\":\\\"Permission Groups Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Process Discovery\\\", \\\"label\\\":\\\"Process Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Query Registry\\\", \\\"label\\\":\\\"Query Registry\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Remote System Discovery\\\", \\\"label\\\":\\\"Remote System Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"System Information Discovery\\\", \\\"label\\\":\\\"System Information Discovery\\\", \\\"group\\\":\\\"Discovery\\\" },\\r\\n    { \\\"value\\\":\\\"Exploitation of Remote Services\\\", \\\"label\\\":\\\"Exploitation of Remote Services\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Lateral Tool Transfer\\\", \\\"label\\\":\\\"Lateral Tool Transfer\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Service Session Hijacking\\\", \\\"label\\\":\\\"Remote Service Session Hijacking\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Services\\\", \\\"label\\\":\\\"Remote Services\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Taint Shared Content\\\", \\\"label\\\":\\\"Taint Shared Content\\\", \\\"group\\\":\\\"Lateral Movement\\\" },\\r\\n    { \\\"value\\\":\\\"Audio Capture\\\", \\\"label\\\":\\\"Audio Capture\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Cloud Storage Object\\\", \\\"label\\\":\\\"Data from Cloud Storage Object\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Configuration Repository\\\", \\\"label\\\":\\\"Data from Configuration Repository\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Information Repositories\\\", \\\"label\\\":\\\"Data from Information Repositories\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data from Local System\\\", \\\"label\\\":\\\"Data from Local System\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Data Staged\\\", \\\"label\\\":\\\"Data Staged\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Man-in-the-Middle\\\", \\\"label\\\":\\\"Man-in-the-Middle\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Screen Capture\\\", \\\"label\\\":\\\"Screen Capture\\\", \\\"group\\\":\\\"Collection\\\" },\\r\\n    { \\\"value\\\":\\\"Application Layer Protocol\\\", \\\"label\\\":\\\"Application Layer Protocol\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Dynamic Resolution\\\", \\\"label\\\":\\\"Dynamic Resolution\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Fallback Channels\\\", \\\"label\\\":\\\"Fallback Channels\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Ingress Tool Transfer\\\", \\\"label\\\":\\\"Ingress Tool Transfer\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Non-Application Layer Protocol\\\", \\\"label\\\":\\\"Non-Application Layer Protocol\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Non-Standard Port\\\", \\\"label\\\":\\\"Non-Standard Port\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Protocol Tunneling\\\", \\\"label\\\":\\\"Protocol Tunneling\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Proxy\\\", \\\"label\\\":\\\"Proxy\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Remote Access Software\\\", \\\"label\\\":\\\"Remote Access Software\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Traffic Signaling\\\", \\\"label\\\":\\\"Traffic Signaling\\\", \\\"group\\\":\\\"Command and Control\\\" },\\r\\n    { \\\"value\\\":\\\"Exfiltration Over Alternative Protocol\\\", \\\"label\\\":\\\"Exfiltration Over Alternative Protocol\\\", \\\"group\\\":\\\"Exfiltration\\\" },\\r\\n    { \\\"value\\\":\\\"Transfer Data to Cloud Account\\\", \\\"label\\\":\\\"Transfer Data to Cloud Account\\\", \\\"group\\\":\\\"Exfiltration\\\" },\\r\\n    { \\\"value\\\":\\\"Data Destruction\\\", \\\"label\\\":\\\"Data Destruction\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Data Encrypted for Impact\\\", \\\"label\\\":\\\"Data Encrypted for Impact\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Data Manipulation\\\", \\\"label\\\":\\\"Data Manipulation\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Defacement\\\", \\\"label\\\":\\\"Defacement\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Disk Wipe\\\", \\\"label\\\":\\\"Disk Wipe\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Endpoint Denial of Service\\\", \\\"label\\\":\\\"Endpoint Denial of Service\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Network Denial of Service\\\", \\\"label\\\":\\\"Network Denial of Service\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Resource Hijacking\\\", \\\"label\\\":\\\"Resource Hijacking\\\", \\\"group\\\":\\\"Impact\\\" },\\r\\n    { \\\"value\\\":\\\"Service Stop\\\", \\\"label\\\":\\\"Service Stop\\\", \\\"group\\\":\\\"Impact\\\" }\\r\\n]\",\"transformers\":null}",
              "size": 4,
              "queryType": 8
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "debugVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "JSON Tactics and Techniques List"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend value = properties.metadata.techniques \r\n    | extend healthState = properties.status.code \r\n    | mvexpand value\r\n    | where {TechniquesDrilldownFilter} and {HealthDrillDownFilter}\r\n    | extend url = strcat(\"https://\", properties.links.azurePortal)\r\n    | project value, properties.resourceDetails.Id, healthState, properties.metadata.displayName, url\r\n\r\n",
              "size": 4,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "value",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "properties_resourceDetails_Id",
                    "formatter": 13,
                    "formatOptions": {
                      "linkColumn": "properties_resourceDetails_Id",
                      "linkTarget": "Resource",
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "healthState",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "NotApplicable",
                          "representation": "more",
                          "text": "Not Applicable"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "2",
                          "text": "Unhealthy"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "Healthy"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Blank",
                          "text": ""
                        }
                      ],
                      "aggregation": "Average"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "properties_metadata_displayName",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "url",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to recommendation",
                      "linkIsContextBlade": false
                    }
                  },
                  {
                    "columnMatch": "techniques",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "tactic",
                    "formatter": 5,
                    "formatOptions": {
                      "customColumnWidthSetting": "30ch"
                    }
                  },
                  {
                    "columnMatch": "resourceGroup",
                    "formatter": 14,
                    "formatOptions": {
                      "linkTarget": null,
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "",
                        "columnSettings": [
                          {
                            "columnName": "Healthy",
                            "color": "green"
                          },
                          {
                            "columnName": "Unhealthy",
                            "color": "redBright"
                          },
                          {
                            "columnName": "NotApplicable",
                            "color": "gray"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "30ch"
                    }
                  },
                  {
                    "columnMatch": "Healthy",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Unhealthy",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "NotApplicable",
                    "formatter": 5
                  }
                ],
                "rowLimit": 10000,
                "labelSettings": [
                  {
                    "columnId": "value",
                    "label": "Tactic"
                  },
                  {
                    "columnId": "properties_resourceDetails_Id",
                    "label": "Resource"
                  },
                  {
                    "columnId": "healthState",
                    "label": "Health State"
                  },
                  {
                    "columnId": "properties_metadata_displayName",
                    "label": "Recommendation"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "debugVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "ARG Techniques Query Recommendations"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\",\"mergeType\":\"inner\",\"leftTable\":\"ARG Techniques Query Recommendations\",\"rightTable\":\"JSON Tactics and Techniques List\",\"leftColumn\":\"value\",\"rightColumn\":\"value\"}],\"projectRename\":[{\"originalName\":\"[ARG Techniques Query Recommendations].value\",\"mergedName\":\"Tactic\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].properties_resourceDetails_Id\",\"mergedName\":\"Resource\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].healthState\",\"mergedName\":\"Health State\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].properties_metadata_displayName\",\"mergedName\":\"Recommendation\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[ARG Techniques Query Recommendations].url\",\"mergedName\":\"url\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].value\",\"mergedName\":\"value\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].label\",\"mergedName\":\"label\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].group\",\"mergedName\":\"group\",\"fromId\":\"1f7cfea7-b6b6-46bc-897b-d794b9e96041\"},{\"originalName\":\"[JSON Tactics and Techniques List].label\"},{\"originalName\":\"[JSON Tactics and Techniques List].value\"}]}",
              "size": 2,
              "showExportToExcel": true,
              "queryType": 7,
              "visualization": "table",
              "showExpandCollapseGrid": true,
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Tactic",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Resource",
                    "formatter": 13,
                    "formatOptions": {
                      "linkTarget": null,
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "Health State",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Healthy",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Unhealthy",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "NotApplicable",
                          "representation": "more",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "unknown",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Recommendation",
                    "formatter": 1
                  },
                  {
                    "columnMatch": "url",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to recommendation"
                    }
                  },
                  {
                    "columnMatch": "value",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "label",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "group",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Technique",
                    "formatter": 5
                  }
                ],
                "rowLimit": 10000,
                "hierarchySettings": {
                  "treeType": 1,
                  "groupBy": [
                    "group",
                    "value"
                  ]
                },
                "labelSettings": [
                  {
                    "columnId": "url",
                    "label": "URL"
                  },
                  {
                    "columnId": "group",
                    "label": "Tactics and Techniques"
                  }
                ]
              }
            },
            "showPin": false,
            "name": "Recommendations Mapped"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "rectec"
      },
      "name": "RecommendationsByTechniqueGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "> This graph shows all resources that appear under recommendations that fall into a Technique. A single resource may or not have three different states (healthy, unhealthy, not applicable) at the same time depending on the recommendations that audited it.",
              "style": "info"
            },
            "conditionalVisibility": {
              "parameterName": "ShowHelp",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "text - 8"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources \r\n    | where type == \"microsoft.security/assessments\" \r\n    | extend techniques = properties.metadata.techniques\r\n    | extend healthState = properties.status.code\r\n    | where isnotnull(techniques)\r\n    | mvexpand techniques\r\n    | project id, techniques, healthState\r\n    | summarize Total=count(healthState), Healthy=countif(healthState=='Healthy'), Unhealthy=countif(healthState=='Unhealthy'), NotApplicable=countif(healthState=='NotApplicable') by tostring(techniques)\r\n    | sort by Total desc",
              "size": 2,
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscription}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Total",
                    "formatter": 22,
                    "formatOptions": {
                      "compositeBarSettings": {
                        "labelText": "",
                        "columnSettings": [
                          {
                            "columnName": "Healthy",
                            "color": "green"
                          },
                          {
                            "columnName": "Unhealthy",
                            "color": "redBright"
                          },
                          {
                            "columnName": "NotApplicable",
                            "color": "gray"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "30ch"
                    }
                  },
                  {
                    "columnMatch": "Healthy",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "Unhealthy",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "NotApplicable",
                    "formatter": 5
                  },
                  {
                    "columnMatch": "tactic",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "30ch"
                    }
                  }
                ],
                "rowLimit": 1000,
                "labelSettings": [
                  {
                    "columnId": "techniques",
                    "label": "Techniques"
                  },
                  {
                    "columnId": "Total",
                    "label": "Total"
                  }
                ]
              }
            },
            "conditionalVisibility": {
              "parameterName": "SelectedTab",
              "comparison": "isEqualTo",
              "value": "tecniquerecommendations"
            },
            "name": "techniques"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "tecniquerecommendations"
      },
      "name": "TechniquesList"
    }
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}

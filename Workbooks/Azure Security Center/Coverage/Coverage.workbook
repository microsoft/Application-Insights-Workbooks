{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## Defender for Cloud Coverage\nThis workbook has been created to provide a consolidated view of Defender for Cloud Coverage across all selected subscriptions.\n\n<svg viewBox=\"0 0 19 19\" width=\"20\" class=\"fxt-escapeShadow\" role=\"presentation\" focusable=\"false\" xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" aria-hidden=\"true\"><g><path fill=\"#1b93eb\" d=\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\"></path><path fill=\"url(#0024423711759027356)\" d=\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\"></path><path d=\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\" class=\"msportalfx-svg-c01\"></path></g></svg>&nbsp;<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> Please take the time to answer a quick survey. To submit your feedback,\n</span>[<span style=\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\"> click here. </span>](https://aka.ms/mdfcsurveycoverageworkbook)"
      },
      "name": "Defender for Cloud Coverage"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "d4e04df2-4d8b-4127-b769-de821c7895db",
            "version": "KqlParameterItem/1.0",
            "name": "info",
            "label": "Additional information",
            "type": 10,
            "isRequired": true,
            "value": "On",
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\n { \"value\": \"On\", \"label\": \"On\"},\n { \"value\": \"Off\", \"label\": \"Off\"}\n]",
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 4"
    },
    {
      "type": 1,
      "content": {
        "json": "## Release notes\n\n|Version|Description|Date|\n|---|---|---|\n|v1.0|initial release, public availability of Defender for Cloud Coverage Workbook|1/20/2022|\n|v1.1|adding navigation menu and coverage for AWS connectors|2/21/2022|\n|v1.2|Updating AWS query and adding coverage for GCP connectors after API update|3/23/2022|"
      },
      "conditionalVisibility": {
        "parameterName": "info",
        "comparison": "isEqualTo",
        "value": "On"
      },
      "name": "text - 7"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "f01ff401-7135-4a30-be83-bdb218f4c0c4",
            "cellValue": "environment",
            "linkTarget": "parameter",
            "linkLabel": "Microsoft Azure",
            "subTarget": "Azure",
            "preText": "Azure",
            "style": "link"
          },
          {
            "id": "a88fa96b-9ced-4f3e-bb64-e9d629668c27",
            "cellValue": "environment",
            "linkTarget": "parameter",
            "linkLabel": "Amazon Web Services (AWS)",
            "subTarget": "AWS",
            "style": "link"
          },
          {
            "id": "3db97502-377e-4da3-a64b-4fd2fbaebbee",
            "cellValue": "environment",
            "linkTarget": "parameter",
            "linkLabel": "Google Cloud Platform (GCP)",
            "subTarget": "GCP",
            "style": "link"
          }
        ]
      },
      "name": "links - 5"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "2896eab7-cf93-43e5-bc43-92eba7c6bd80",
            "version": "KqlParameterItem/1.0",
            "name": "Subscriptions",
            "type": 6,
            "description": "Please select one or several subscriptions to allow the workbook to show Defender for Cloud coverage details.",
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "includeAll": true,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "value": [
              "value::all"
            ]
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 1"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Microsoft Defender for Cloud coverage by Azure subscriptions"
            },
            "name": "text - 1"
          },
          {
            "type": 1,
            "content": {
              "json": "This table provides an overview of all selected subscriptions and their corresponding Defender status per plan. You can click the on/off status per plan and subscription. Doing so, you will be redirected to the subscription's Defender for Cloud plan configuration page. With that, you can easily see your Defender for Cloud coverage per subscription and immediately react in case you want to enable additional plans on it."
            },
            "conditionalVisibility": {
              "parameterName": "info",
              "comparison": "isEqualTo",
              "value": "On"
            },
            "name": "text - 2"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "securityresources\n| where type =~ \"microsoft.security/pricings\"\n| extend planSet = pack(name, pricingTier = properties.pricingTier)\n| summarize defenderPlans = make_bag(planSet) by subscriptionId\n| project subscriptionId,\n    VirtualMachines = defenderPlans.VirtualMachines,\n    AppServices = defenderPlans.AppServices,\n    SqlServers = defenderPlans.SqlServers,\n    SqlServerVirtualMachines = defenderPlans.SqlServerVirtualMachines,\n    OpenSourceRelationalDatabases = defenderPlans.OpenSourceRelationalDatabases,\n    CosmosDB = defenderPlans.CosmosDbs,\n    StorageAccounts = defenderPlans.StorageAccounts,\n    Containers = defenderPlans.Containers,\n    KeyVaults = defenderPlans.KeyVaults,\n    Arm = defenderPlans.Arm,\n    DNS = defenderPlans.Dns,\n    KubernetesService = defenderPlans.KubernetesService,\n    ContainerRegistry = defenderPlans.ContainerRegistry",
              "size": 3,
              "showAnalytics": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "subscriptionId",
                    "formatter": 15,
                    "formatOptions": {
                      "linkTarget": "Resource",
                      "showIcon": true,
                      "customColumnWidthSetting": "50ch"
                    }
                  },
                  {
                    "columnMatch": "VirtualMachines",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "12.5ch"
                    }
                  },
                  {
                    "columnMatch": "AppServices",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "16ch"
                    }
                  },
                  {
                    "columnMatch": "SqlServers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "10ch"
                    }
                  },
                  {
                    "columnMatch": "SqlServerVirtualMachines",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "26ch"
                    }
                  },
                  {
                    "columnMatch": "OpenSourceRelationalDatabases",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "29ch"
                    }
                  },
                  {
                    "columnMatch": "CosmosDB",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "15.5ch"
                    }
                  },
                  {
                    "columnMatch": "StorageAccounts",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "12ch"
                    }
                  },
                  {
                    "columnMatch": "Containers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "15ch"
                    }
                  },
                  {
                    "columnMatch": "KubernetesService",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "19.7ch"
                    }
                  },
                  {
                    "columnMatch": "ContainerRegistry",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "32ch"
                    }
                  },
                  {
                    "columnMatch": "KeyVaults",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "14.7ch"
                    }
                  },
                  {
                    "columnMatch": "Arm",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "21ch"
                    }
                  },
                  {
                    "columnMatch": "DNS",
                    "formatter": 18,
                    "formatOptions": {
                      "linkColumn": "subscriptionId",
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Standard",
                          "representation": "lightBlue",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blueDark",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "PolicyPricingWithBundlesBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "subscriptionId",
                            "source": "column",
                            "value": "subscriptionId"
                          }
                        ]
                      },
                      "customColumnWidthSetting": "10.7ch"
                    }
                  },
                  {
                    "columnMatch": "subscriptionName",
                    "formatter": 5,
                    "formatOptions": {
                      "linkTarget": "Resource"
                    }
                  }
                ],
                "rowLimit": 10000,
                "filter": true,
                "labelSettings": [
                  {
                    "columnId": "subscriptionId",
                    "label": "Subscription Name"
                  },
                  {
                    "columnId": "VirtualMachines",
                    "label": "Servers"
                  },
                  {
                    "columnId": "AppServices",
                    "label": "App Services"
                  },
                  {
                    "columnId": "SqlServers",
                    "label": "SQL"
                  },
                  {
                    "columnId": "SqlServerVirtualMachines",
                    "label": "SQL Server on machines"
                  },
                  {
                    "columnId": "OpenSourceRelationalDatabases",
                    "label": "Open-source relational DBs"
                  },
                  {
                    "columnId": "CosmosDB",
                    "label": "Cosmos DB"
                  },
                  {
                    "columnId": "StorageAccounts",
                    "label": "Storage"
                  },
                  {
                    "columnId": "Containers",
                    "label": "Containers"
                  },
                  {
                    "columnId": "KeyVaults",
                    "label": "Key Vaults"
                  },
                  {
                    "columnId": "Arm",
                    "label": "Resource Manager"
                  },
                  {
                    "columnId": "DNS",
                    "label": "DNS"
                  },
                  {
                    "columnId": "KubernetesService",
                    "label": "K8s (deprecated)"
                  },
                  {
                    "columnId": "ContainerRegistry",
                    "label": "Container Registry (deprecated)"
                  }
                ]
              },
              "sortBy": []
            },
            "name": "query - 4"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "environment",
        "comparison": "isEqualTo",
        "value": "Azure"
      },
      "name": "Azure"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Microsoft Defender for Cloud coverage by AWS connectors"
            },
            "name": "text - 6"
          },
          {
            "type": 1,
            "content": {
              "json": "This table provides an overview of all native AWS connectors in your subscriptions, including coverage for Defender for Cloud capabilities. You can click any status value from the table to be automatically redirected to the connector's configuration blade on which you can enable additional plans."
            },
            "conditionalVisibility": {
              "parameterName": "info",
              "comparison": "isEqualTo",
              "value": "On"
            },
            "name": "text - 2"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources\n| where type == \"microsoft.security/securityconnectors\" and properties.environmentName == \"AWS\"\n| extend offering0 = properties.offerings[0].offeringType, offering1 = properties.offerings[1].offeringType, offering2 = properties.offerings[2].offeringType, offering3 = properties.offerings[3].offeringType, offering4 = properties.offerings[4].offeringType\n| extend set = pack_array(id, name, offering0, offering1, offering2, offering3, offering4)\n| project id, CSPM = case(\n        offering0 =~ \"CspmMonitorAWS\",1,\n        offering1 =~ \"CspmMonitorAWS\",1,\n        offering2 =~ \"CspmMonitorAWS\",1,\n        offering3 =~ \"CspmMonitorAWS\",1,\n        offering4 =~ \"CspmMonitorAWS\",1,\n        0),\n    Servers = case(\n        offering0 =~ \"DefenderForServersAws\",1,\n        offering1 =~ \"DefenderForServersAws\",1,\n        offering2 =~ \"DefenderForServersAws\",1,\n        offering3 =~ \"DefenderForServersAws\",1,\n        offering4 =~ \"DefenderForServersAws\",1,\n        0),\n    Containers = case(\n        offering0 =~ \"DefenderForContainersAws\",1,\n        offering1 =~ \"DefenderForContainersAws\",1,\n        offering2 =~ \"DefenderForContainersAws\",1,\n        offering3 =~ \"DefenderForContainersAws\",1,\n        offering4 =~ \"DefenderForContainersAws\",1,\n        0)",
              "size": 3,
              "showAnalytics": true,
              "noDataMessage": "No AWS connectors found in your selected subscriptions.",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "CSPM",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "yellow",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "AwsAccountSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "awsConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "Servers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "yellow",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "AwsAccountSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "awsConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "Containers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "yellow",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "AwsAccountSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "awsConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "InformationProtection",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "yellow",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "orange",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "AwsAccountSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "awsConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "id",
                    "label": "Connector ID"
                  },
                  {
                    "columnId": "CSPM",
                    "label": "Cloud Security Posture Management"
                  },
                  {
                    "columnId": "Servers",
                    "label": "Defender for Servers"
                  },
                  {
                    "columnId": "Containers",
                    "label": "Defender for Containers"
                  }
                ]
              }
            },
            "conditionalVisibility": {
              "parameterName": "environment",
              "comparison": "isEqualTo",
              "value": "AWS"
            },
            "name": "query - 3"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "environment",
        "comparison": "isEqualTo",
        "value": "AWS"
      },
      "name": "AWS"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Microsoft Defender for Cloud coverage by GCP connectors"
            },
            "name": "text - 0"
          },
          {
            "type": 1,
            "content": {
              "json": "This table provides an overview of all native GCP connectors in your subscriptions, including coverage for Defender for Cloud capabilities. You can click any status value from the table to be automatically redirected to the connector's configuration blade on which you can enable additional plans."
            },
            "conditionalVisibility": {
              "parameterName": "info",
              "comparison": "isEqualTo",
              "value": "On"
            },
            "name": "text - 1"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources\n| where type == \"microsoft.security/securityconnectors\" and properties.environmentName == \"GCP\"\n| extend offering0 = properties.offerings[0].offeringType, offering1 = properties.offerings[1].offeringType, offering2 = properties.offerings[2].offeringType, offering3 = properties.offerings[3].offeringType, offering4 = properties.offerings[4].offeringType\n| extend set = pack_array(id, name, offering0, offering1, offering2, offering3, offering4)\n| project id, CSPM = case(\n        offering0 =~ \"CspmMonitorGCP\",1,\n        offering1 =~ \"CspmMonitorGCP\",1,\n        offering2 =~ \"CspmMonitorGCP\",1,\n        offering3 =~ \"CspmMonitorGCP\",1,\n        offering4 =~ \"CspmMonitorGCP\",1,\n        0),\n    Servers = case(\n        offering0 =~ \"DefenderForServersGcp\",1,\n        offering1 =~ \"DefenderForServersGcp\",1,\n        offering2 =~ \"DefenderForServersGcp\",1,\n        offering3 =~ \"DefenderForServersGcp\",1,\n        offering4 =~ \"DefenderForServersGcp\",1,\n        0),\n    Containers = case(\n        offering0 =~ \"DefenderForContainersGcp\",1,\n        offering1 =~ \"DefenderForContainersGcp\",1,\n        offering2 =~ \"DefenderForContainersGcp\",1,\n        offering3 =~ \"DefenderForContainersGcp\",1,\n        offering4 =~ \"DefenderForContainersGcp\",1,\n        0)",
              "size": 3,
              "showAnalytics": true,
              "noDataMessage": "No GCP connectors found in your selected subscriptions.",
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Subscriptions}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "CSPM",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "pink",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "purple",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "GcpProjectSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "gcpConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "Servers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "pink",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "purple",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "GcpProjectSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "gcpConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  },
                  {
                    "columnMatch": "Containers",
                    "formatter": 18,
                    "formatOptions": {
                      "linkTarget": "OpenBlade",
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "1",
                          "representation": "pink",
                          "text": "on"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "purple",
                          "text": "off"
                        }
                      ],
                      "bladeOpenContext": {
                        "bladeName": "GcpProjectSettingsBlade",
                        "extensionName": "Microsoft_Azure_Security",
                        "bladeParameters": [
                          {
                            "name": "gcpConnectorId",
                            "source": "column",
                            "value": "id"
                          }
                        ]
                      }
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "id",
                    "label": "Connector ID"
                  },
                  {
                    "columnId": "CSPM",
                    "label": "Cloud Security Posture Management"
                  },
                  {
                    "columnId": "Servers",
                    "label": "Defender for Servers"
                  },
                  {
                    "columnId": "Containers",
                    "label": "Defender for Containers"
                  }
                ]
              }
            },
            "name": "query - 2"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "environment",
        "comparison": "isEqualTo",
        "value": "GCP"
      },
      "name": "GCP"
    }
  ],
  "fallbackResourceIds": [
    "Azure Security Center"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}